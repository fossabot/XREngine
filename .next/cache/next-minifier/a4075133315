{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{\"+nhR\":function(e,t,n){\"use strict\";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=0,o=0,a=[],s=function(){var e=a.pop();return e||(e={position:new THREE.Vector3,velocity:new THREE.Vector3,scale:new THREE.Vector3,quaternion:new THREE.Quaternion,time:0}),e},c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.state=i,this.buffer=[],this.bufferTime=1e3*n,this.time=0,this.mode=t,this.originFrame=s(),this.position=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1)}return r(e,[{key:\"hermite\",value:function(e,t,n,r,i,o){var a=t*t,s=t*t*t,c=2*s-3*a+1,d=-2*s+3*a,u=s-2*a+t,p=s-a;e.copy(n.multiplyScalar(c)),e.add(r.multiplyScalar(d)),e.add(i.multiplyScalar(u)),e.add(o.multiplyScalar(p))}},{key:\"lerp\",value:function(e,t,n,r){e.lerpVectors(t,n,r)}},{key:\"slerp\",value:function(e,t,n,r){THREE.Quaternion.slerp(t,n,e,r)}},{key:\"updateOriginFrameToBufferTail\",value:function(){var e;e=this.originFrame,a.push(e),this.originFrame=this.buffer.shift()}},{key:\"appendBuffer\",value:function(e,t,n,r){var i=this.buffer.length>0?this.buffer[this.buffer.length-1]:null;if(i&&i.time===this.time)e&&i.position.copy(e),t&&i.velocity.copy(t),n&&i.quaternion.copy(n),r&&i.scale.copy(r);else{var o=i||this.originFrame,a=s();a.position.copy(e||o.position),a.velocity.copy(t||o.velocity),a.quaternion.copy(n||o.quaternion),a.scale.copy(r||o.scale),a.time=this.time,this.buffer.push(a)}}},{key:\"setTarget\",value:function(e,t,n,r){this.appendBuffer(e,t,n,r)}},{key:\"setPosition\",value:function(e,t){this.appendBuffer(e,t,null,null)}},{key:\"setQuaternion\",value:function(e){this.appendBuffer(null,null,e,null)}},{key:\"setScale\",value:function(e){this.appendBuffer(null,null,null,e)}},{key:\"update\",value:function(e){if(this.state===i&&this.buffer.length>0&&(this.updateOriginFrameToBufferTail(),this.position.copy(this.originFrame.position),this.quaternion.copy(this.originFrame.quaternion),this.scale.copy(this.originFrame.scale),this.state=1),1===this.state&&this.buffer.length>0&&this.time>this.bufferTime&&(this.state=2),2===this.state){for(var t=this.time-this.bufferTime;this.buffer.length>0&&t>this.buffer[0].time;)this.buffer.length>1?this.updateOriginFrameToBufferTail():(this.originFrame.position.copy(this.buffer[0].position),this.originFrame.velocity.copy(this.buffer[0].velocity),this.originFrame.quaternion.copy(this.buffer[0].quaternion),this.originFrame.scale.copy(this.buffer[0].scale),this.originFrame.time=this.buffer[0].time,this.buffer[0].time=this.time+e);if(this.buffer.length>0&&this.buffer[0].time>0){var n=this.buffer[0],r=n.time-this.originFrame.time,a=(t-this.originFrame.time)/r;this.mode===o?this.lerp(this.position,this.originFrame.position,n.position,a):1===this.mode&&this.hermite(this.position,a,this.originFrame.position,n.position,this.originFrame.velocity.multiplyScalar(r),n.velocity.multiplyScalar(r)),this.slerp(this.quaternion,this.originFrame.quaternion,n.quaternion,a),this.lerp(this.scale,this.originFrame.scale,n.scale,a)}}this.state!==i&&(this.time+=e)}},{key:\"getPosition\",value:function(){return this.position}},{key:\"getQuaternion\",value:function(){return this.quaternion}},{key:\"getScale\",value:function(){return this.scale}}]),e}();e.exports=c},\"+phH\":function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;function o(e,t,n){var r=n?\"outbound-rtp\":\"inbound-rtp\",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){\"track\"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach((function(i){i.endsWith(\"Id\")?e(t,t.get(n[i]),r):i.endsWith(\"Ids\")&&n[i].forEach((function(n){e(t,t.get(n),r)}))})))}(e,n,i)}))})),i}e.exports={shimGetUserMedia:n(\"vwHn\"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if(\"object\"!==typeof e||!e.RTCPeerConnection||\"ontrack\"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.transceiver||Object.defineProperty(e,\"transceiver\",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,\"ontrack\",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener(\"track\",this._ontrack),this.addEventListener(\"track\",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener(\"addtrack\",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event(\"track\");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event(\"track\");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},n.addEventListener(\"addstream\",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&!(\"getSenders\"in e.RTCPeerConnection.prototype)&&\"createDTMFSender\"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(\"audio\"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=this,o=n.apply(i,arguments);return o||(o=t(i,e),i._senders.push(o)),o};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;r.apply(t,arguments);var n=t._senders.indexOf(e);-1!==n&&t._senders.splice(n,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],i.apply(n,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if(\"object\"===typeof e&&e.RTCPeerConnection&&\"getSenders\"in e.RTCPeerConnection.prototype&&\"createDTMFSender\"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!(\"dtmf\"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach((function(t){t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,\"dtmf\",{get:function(){return void 0===this._dtmf&&(\"audio\"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!(\"getStats\"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return o(t,e.track,!0)}))}}if(!(\"getStats\"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(e,[]);return t.forEach((function(t){t._pc=e})),t}),r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return o(t,e.track,!1)}))}}if(\"getStats\"in e.RTCRtpSender.prototype&&\"getStats\"in e.RTCRtpReceiver.prototype){var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var t=this;if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var n,r,i,o=arguments[0];return t.getSenders().forEach((function(e){e.track===o&&(n?i=!0:n=e)})),t.getReceivers().forEach((function(e){return e.track===o&&(r?i=!0:r=e),e.track===o})),i||n&&r?Promise.reject(new DOMException(\"There are more than one sender or receiver for the track.\",\"InvalidAccessError\")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException(\"There is no sender or receiver for the track.\",\"InvalidAccessError\"))}return a.apply(t,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;\"object\"===typeof e&&(!e.HTMLMediaElement||\"srcObject\"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,\"srcObject\",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener(\"addtrack\",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})),e.addEventListener(\"removetrack\",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}))):this.src=\"\"}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException(\"Track already exists.\",\"InvalidAccessError\")}));var r=t.getSenders();n.apply(this,arguments);var i=t.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException(\"Track already exists.\",\"InvalidAccessError\")})),!n._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());n._streams[t.id]=r,n._reverseStreams[r.id]=t,t=r}i.apply(n,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},o.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if(\"closed\"===r.signalingState)throw new DOMException(\"The RTCPeerConnection's signalingState is 'closed'.\",\"InvalidStateError\");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException(\"The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.\",\"NotSupportedError\");var o=r.getSenders().find((function(e){return e.track===t}));if(o)throw new DOMException(\"Track already exists.\",\"InvalidAccessError\");r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{};var a=r._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event(\"negotiationneeded\"))}));else{var s=new e.MediaStream([t]);r._streams[n.id]=s,r._reverseStreams[s.id]=n,r.addStream(s)}return r.getSenders().find((function(e){return e.track===t}))},[\"createOffer\",\"createAnswer\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments,r=arguments.length&&\"function\"===typeof arguments[0];return r?n.apply(e,[function(n){var r=c(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(e,arguments).then((function(t){return c(e,t)}))}}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;return arguments.length&&arguments[0].type?(arguments[0]=d(e,arguments[0]),a.apply(e,arguments)):a.apply(e,arguments)};var s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,\"localDescription\");Object.defineProperty(e.RTCPeerConnection.prototype,\"localDescription\",{get:function(){var e=s.get.apply(this);return\"\"===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if(\"closed\"===n.signalingState)throw new DOMException(\"The RTCPeerConnection's signalingState is 'closed'.\",\"InvalidStateError\");if(!e._pc)throw new DOMException(\"Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.\",\"TypeError\");if(!(e._pc===n))throw new DOMException(\"Sender was not created by this connection.\",\"InvalidAccessError\");n._streams=n._streams||{},Object.keys(n._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?n.removeStream(n._reverseStreams[t.id]):t.removeTrack(e.track),n.dispatchEvent(new Event(\"negotiationneeded\")))}}function c(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,\"g\"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function d(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,\"g\"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=function(t,n){return i(\"PeerConnection\"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}})),e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var i=this,o=arguments;if(arguments.length>0&&\"function\"===typeof e)return n.apply(this,arguments);if(0===n.length&&(0===arguments.length||\"function\"!==typeof arguments[0]))return n.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){o[1](s(a(e)))};return n.apply(this,[c,arguments[0]])}return new Promise((function(e,t){n.apply(i,[function(t){e(s(a(t)))},t])})).then(t,r)},t.version<51&&[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,r=new Promise((function(r,i){n.apply(t,[e[0],r,i])}));return e.length<2?r:r.then((function(){e[1].apply(null,[])}),(function(t){e.length>=3&&e[2].apply(null,[t])}))}})),t.version<52&&[\"createOffer\",\"createAnswer\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&\"object\"===typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise((function(r,i){n.apply(e,[r,i,t])}))}return n.apply(this,arguments)}})),[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new(\"addIceCandidate\"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var o=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},fixNegotiationNeeded:function(e){r.wrapPeerConnectionEvent(e,\"negotiationneeded\",(function(e){if(\"stable\"===e.target.signalingState)return e}))},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||\"getDisplayMedia\"in e.navigator.mediaDevices||(\"function\"===typeof t?(e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:\"desktop\",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),e.navigator.mediaDevices.getDisplayMedia(t)}):console.error(\"shimGetDisplayMedia: getSourceId argument is not a function\"))}}},\"/GRZ\":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}},\"0JNz\":function(e,t,n){\"use strict\";(function(t){var r=n(\"GAh6\");e.exports=r({window:t.window})}).call(this,n(\"yLpj\"))},\"1OyB\":function(e,t,n){\"use strict\";function r(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}n.d(t,\"a\",(function(){return r}))},\"2qu3\":function(e,t,n){\"use strict\";var r=n(\"/GRZ\"),i=n(\"i2R6\");function o(e){if(\"undefined\"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if(\"string\"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);\"Object\"===n&&e.constructor&&(n=e.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(n);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var r,i,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var c=s(n(\"q1tI\")),d=n(\"8L3h\"),u=n(\"jwwS\"),p=[],l=[],h=!1;function f(e){var t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then((function(e){return n.loading=!1,n.loaded=e,e})).catch((function(e){throw n.loading=!1,n.error=e,e})),n}function m(e){var t={loading:!1,loaded:{},error:null},n=[];try{Object.keys(e).forEach((function(r){var i=f(e[r]);i.loading?t.loading=!0:(t.loaded[r]=i.loaded,t.error=i.error),n.push(i.promise),i.promise.then((function(e){t.loaded[r]=e})).catch((function(e){t.error=e}))}))}catch(r){t.error=r}return t.promise=Promise.all(n).then((function(e){return t.loading=!1,e})).catch((function(e){throw t.loading=!1,e})),t}function v(e,t){return c.default.createElement((n=e)&&n.__esModule?n.default:n,t);var n}function g(e,t){var n=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:v,webpack:null,modules:null},t),r=null;function i(){if(!r){var t=new y(e,n);r={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return r.promise()}if(!h&&\"function\"===typeof n.webpack){var a=n.webpack();l.push((function(e){var t,n=o(a);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(-1!==e.indexOf(r))return i()}}catch(s){n.e(s)}finally{n.f()}}))}var s=function(e,t){i();var o=c.default.useContext(u.LoadableContext),a=d.useSubscription(r);return c.default.useImperativeHandle(t,(function(){return{retry:r.retry}})),o&&Array.isArray(n.modules)&&n.modules.forEach((function(e){o(e)})),a.loading||a.error?c.default.createElement(n.loading,{isLoading:a.loading,pastDelay:a.pastDelay,timedOut:a.timedOut,error:a.error,retry:r.retry}):a.loaded?n.render(a.loaded,e):null};return s.preload=function(){return i()},s.displayName=\"LoadableComponent\",c.default.forwardRef(s)}var y=function(){function e(t,n){r(this,e),this._loadFn=t,this._opts=n,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}return i(e,[{key:\"promise\",value:function(){return this._res.promise}},{key:\"retry\",value:function(){var e=this;this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};var t=this._res,n=this._opts;t.loading&&(\"number\"===typeof n.delay&&(0===n.delay?this._state.pastDelay=!0:this._delay=setTimeout((function(){e._update({pastDelay:!0})}),n.delay)),\"number\"===typeof n.timeout&&(this._timeout=setTimeout((function(){e._update({timedOut:!0})}),n.timeout))),this._res.promise.then((function(){e._update(),e._clearTimeouts()})).catch((function(t){e._update(),e._clearTimeouts()})),this._update({})}},{key:\"_update\",value:function(e){this._state=Object.assign(Object.assign({},this._state),e),this._callbacks.forEach((function(e){return e()}))}},{key:\"_clearTimeouts\",value:function(){clearTimeout(this._delay),clearTimeout(this._timeout)}},{key:\"getCurrentValue\",value:function(){return Object.assign(Object.assign({},this._state),{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading})}},{key:\"subscribe\",value:function(e){var t=this;return this._callbacks.add(e),function(){t._callbacks.delete(e)}}}]),e}();function C(e){return g(f,e)}function T(e,t){for(var n=[];e.length;){var r=e.pop();n.push(r(t))}return Promise.all(n).then((function(){if(e.length)return T(e,t)}))}C.Map=function(e){if(\"function\"!==typeof e.render)throw new Error(\"LoadableMap requires a `render(loaded, props)` function\");return g(m,e)},C.preloadAll=function(){return new Promise((function(e,t){T(p).then(e,t)}))},C.preloadReady=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise((function(t){var n=function(){return h=!0,t()};T(l,e).then(n,n)}))},window.__NEXT_PRELOADREADY=C.preloadReady,t.default=C},\"5YFB\":function(e,t,n){\"use strict\";n.r(t);var r=n(\"1OyB\"),i=n(\"vuIU\"),o=n(\"md7G\"),a=n(\"foSv\"),s=n(\"Ji7U\"),c=n(\"q1tI\"),d=n.n(c),u=n(\"i8i4\"),p=n.n(u),l=n(\"a6RD\"),h=n.n(l),f=(n(\"sEhn\"),n(\"WeY7\"),n(\"STrH\"),n(\"0JNz\"),d.a.createElement);function m(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}h()((function(){return Promise.resolve().then(n.t.bind(null,\"sEhn\",7))}),{ssr:!1,loadableGenerated:{webpack:function(){return[\"sEhn\"]},modules:[\"aframe\"]}});var v=function(e){Object(s.a)(c,e);var t,n=(t=c,function(){var e,n=Object(a.a)(t);if(m()){var r=Object(a.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(o.a)(this,e)});function c(e){var t;return Object(r.a)(this,c),(t=n.call(this,e)).state={},t}return Object(i.a)(c,[{key:\"render\",value:function(){return f(\"div\",null,f(\"a-scene\",{networked:!0,renderer:\"antialias: true\",background:\"color: #FAFAFA\"},f(\"a-box\",{position:\"-1 0.5 -3\",rotation:\"0 45 0\",color:\"#4CC3D9\",shadow:!0}),f(\"a-sphere\",{position:\"0 1.25 -5\",radius:\"1.25\",color:\"#EF2D5E\",shadow:!0}),f(\"a-cylinder\",{position:\"1 0.75 -3\",radius:\"0.5\",height:\"1.5\",color:\"#FFC65D\",shadow:!0}),f(\"a-plane\",{position:\"0 0 -4\",rotation:\"-90 0 0\",width:\"4\",height:\"4\",color:\"#7BC8A4\",shadow:!0})))}}]),c}(d.a.Component);p.a.render(f(v,null),document.querySelector(\"#sceneContainer\"))},\"7dnI\":function(e,t,n){\"use strict\";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var n;function a(){if(a.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var o=a,s=Number(new Date),c=s-(n||s);o.diff=c,o.prev=n,o.curr=s,n=s,t[0]=r.coerce(t[0]),\"string\"!==typeof t[0]&&t.unshift(\"%O\");var d=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if(\"%%\"===e)return e;d++;var i=r.formatters[n];if(\"function\"===typeof i){var a=t[d];e=i.call(o,a),t.splice(d,1),d--}return e})),r.formatArgs.call(o,t),(o.log||r.log).apply(o,t)}}return a.namespace=e,a.enabled=r.enabled(e),a.useColors=r.useColors(),a.color=t(e),a.destroy=i,a.extend=o,\"function\"===typeof r.init&&r.init(a),r.instances.push(a),a}function i(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function o(e,t){return r(this.namespace+(\"undefined\"===typeof t?\":\":t)+e)}return r.debug=r,r.default=r,r.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){r.enable(\"\")},r.enable=function(e){var t;r.save(e),r.names=[],r.skips=[];var n=(\"string\"===typeof e?e:\"\").split(/[\\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&(\"-\"===(e=n[t].replace(/\\*/g,\".*?\"))[0]?r.skips.push(new RegExp(\"^\"+e.substr(1)+\"$\")):r.names.push(new RegExp(\"^\"+e+\"$\")));for(t=0;t<r.instances.length;t++){var o=r.instances[t];o.enabled=r.enabled(o.namespace)}},r.enabled=function(e){if(\"*\"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(\"FGiv\"),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},\"8D0k\":function(e,t,n){\"use strict\";var r=n(\"KCt4\");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),\"offer\"===n?\"actpass\":o||\"active\"),a+=\"a=mid:\"+e.mid+\"\\r\\n\",e.rtpSender&&e.rtpReceiver?a+=\"a=sendrecv\\r\\n\":e.rtpSender?a+=\"a=sendonly\\r\\n\":e.rtpReceiver?a+=\"a=recvonly\\r\\n\":a+=\"a=inactive\\r\\n\",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c=\"msid:\"+(i?i.id:\"-\")+\" \"+s+\"\\r\\n\";a+=\"a=\"+c,a+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" \"+c,e.sendEncodingParameters[0].rtx&&(a+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" \"+c,a+=\"a=ssrc-group:FID \"+e.sendEncodingParameters[0].ssrc+\" \"+e.sendEncodingParameters[0].rtx.ssrc+\"\\r\\n\")}return a+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" cname:\"+r.localCName+\"\\r\\n\",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" cname:\"+r.localCName+\"\\r\\n\"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if(\"rtx\"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:[\"stable\",\"have-local-offer\"],setRemoteDescription:[\"stable\",\"have-remote-offer\"]},answer:{setLocalDescription:[\"have-remote-offer\",\"have-local-pranswer\"],setRemoteDescription:[\"have-local-offer\",\"have-remote-pranswer\"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent(\"addtrack\",{track:t}))}function d(t,n,r,i){var o=new Event(\"track\");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent(\"track\",o)}))}var u=function(n){var i=this,o=document.createDocumentFragment();if([\"addEventListener\",\"removeEventListener\",\"dispatchEvent\"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState=\"stable\",this.iceConnectionState=\"new\",this.connectionState=\"new\",this.iceGatheringState=\"new\",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle=\"max-bundle\"===n.bundlePolicy,\"negotiate\"===n.rtcpMuxPolicy)throw c(\"NotSupportedError\",\"rtcpMuxPolicy 'negotiate' is not supported\");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy=\"require\"),n.iceTransportPolicy){case\"all\":case\"relay\":break;default:n.iceTransportPolicy=\"all\"}switch(n.bundlePolicy){case\"balanced\":case\"max-compat\":case\"max-bundle\":break;default:n.bundlePolicy=\"balanced\"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn(\"RTCIceServer.url is deprecated! Use urls instead.\");var i=\"string\"===typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0===e.indexOf(\"turn:\")&&-1!==e.indexOf(\"transport=udp\")&&-1===e.indexOf(\"turn:[\")&&!n?(n=!0,!0):0===e.indexOf(\"stun:\")&&t>=14393&&-1===e.indexOf(\"?transport=udp\")})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,\"localDescription\",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,\"remoteDescription\",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),\"function\"===typeof this[\"on\"+e]&&this[\"on\"+e](t))},u.prototype._emitGatheringStateChange=function(){var e=new Event(\"icegatheringstatechange\");this._dispatchEvent(\"icegatheringstatechange\",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},u.prototype.addTrack=function(t,n){if(this._isClosed)throw c(\"InvalidStateError\",\"Attempted to call addTrack on a closed peerconnection.\");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c(\"InvalidAccessError\",\"Track already exists.\");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},u.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener(\"enabled\",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},u.prototype.removeTrack=function(t){if(this._isClosed)throw c(\"InvalidStateError\",\"Attempted to call removeTrack on a closed peerconnection.\");if(!(t instanceof e.RTCRtpSender))throw new TypeError(\"Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.\");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c(\"InvalidAccessError\",\"Sender was not created by this connection.\");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},u.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,\"state\",{value:\"new\",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?\"completed\":\"gathering\",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener(\"localcandidate\",this.transceivers[t].bufferCandidates),i},u.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener(\"localcandidate\",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event(\"icecandidate\");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)\"new\"!==o.state&&\"gathering\"!==o.state||(o.state=\"completed\");else{\"new\"===o.state&&(o.state=\"gathering\"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var d=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(d)),a.candidate.candidate=d,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var u=r.getMediaSections(i._localDescription.sdp);u[a.candidate.sdpMLineIndex]+=c?\"a=end-of-candidates\\r\\n\":\"a=\"+a.candidate.candidate+\"\\r\\n\",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+u.join(\"\");var p=i.transceivers.every((function(e){return e.iceGatherer&&\"completed\"===e.iceGatherer.state}));\"gathering\"!==i.iceGatheringState&&(i.iceGatheringState=\"gathering\",i._emitGatheringStateChange()),c||i._dispatchEvent(\"icecandidate\",a),p&&(i._dispatchEvent(\"icecandidate\",new Event(\"icecandidate\")),i.iceGatheringState=\"complete\",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,\"state\",{value:\"failed\",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&(\"video\"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},u.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===[\"offer\",\"answer\"].indexOf(e.type))return Promise.reject(c(\"TypeError\",'Unsupported type \"'+e.type+'\"'));if(!a(\"setLocalDescription\",e.type,i.signalingState)||i._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not set local \"+e.type+\" in state \"+i.signalingState));if(\"offer\"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if(\"answer\"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,\"a=ice-lite\").length>0;t.forEach((function(e,t){var a=i.transceivers[t],c=a.iceGatherer,d=a.iceTransport,u=a.dtlsTransport,p=a.localCapabilities,l=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,\"a=bundle-only\").length)&&!a.rejected){var h=r.getIceParameters(e,n),f=r.getDtlsParameters(e,n);s&&(f.role=\"server\"),i.usingBundle&&0!==t||(i._gather(a.mid,t),\"new\"===d.state&&d.start(c,h,s?\"controlling\":\"controlled\"),\"new\"===u.state&&u.start(f));var m=o(p,l);i._transceive(a,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},\"offer\"===e.type?i._updateSignalingState(\"have-local-offer\"):i._updateSignalingState(\"stable\"),Promise.resolve()},u.prototype.setRemoteDescription=function(i){var u=this;if(-1===[\"offer\",\"answer\"].indexOf(i.type))return Promise.reject(c(\"TypeError\",'Unsupported type \"'+i.type+'\"'));if(!a(\"setRemoteDescription\",i.type,u.signalingState)||u._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not set remote \"+i.type+\" in state \"+u.signalingState));var p={};u.remoteStreams.forEach((function(e){p[e.id]=e}));var l=[],h=r.splitSections(i.sdp),f=h.shift(),m=r.matchPrefix(f,\"a=ice-lite\").length>0,v=r.matchPrefix(f,\"a=group:BUNDLE \").length>0;u.usingBundle=v;var g=r.matchPrefix(f,\"a=ice-options:\")[0];return u.canTrickleIceCandidates=!!g&&g.substr(14).split(\" \").indexOf(\"trickle\")>=0,h.forEach((function(a,c){var d=r.splitLines(a),h=r.getKind(a),g=r.isRejected(a)&&0===r.matchPrefix(a,\"a=bundle-only\").length,y=d[0].substr(2).split(\" \")[2],C=r.getDirection(a,f),T=r.parseMsid(a),b=r.getMid(a)||r.generateIdentifier();if(g||\"application\"===h&&(\"DTLS/SCTP\"===y||\"UDP/DTLS/SCTP\"===y))u.transceivers[c]={mid:b,kind:h,protocol:y,rejected:!0};else{var w,S,E,R,k,P,O,D,_;!g&&u.transceivers[c]&&u.transceivers[c].rejected&&(u.transceivers[c]=u._createTransceiver(h,!0));var N,I,M=r.parseRtpParameters(a);g||(N=r.getIceParameters(a,f),(I=r.getDtlsParameters(a,f)).role=\"client\"),O=r.parseRtpEncodingParameters(a);var A=r.parseRtcpParameters(a),x=r.matchPrefix(a,\"a=end-of-candidates\",f).length>0,F=r.matchPrefix(a,\"a=candidate:\").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if((\"offer\"===i.type||\"answer\"===i.type)&&!g&&v&&c>0&&u.transceivers[c]&&(u._disposeIceAndDtlsTransports(c),u.transceivers[c].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[c].iceTransport=u.transceivers[0].iceTransport,u.transceivers[c].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[c].rtpSender&&u.transceivers[c].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[c].rtpReceiver&&u.transceivers[c].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),\"offer\"!==i.type||g){if(\"answer\"===i.type&&!g){S=(w=u.transceivers[c]).iceGatherer,E=w.iceTransport,R=w.dtlsTransport,k=w.rtpReceiver,P=w.sendEncodingParameters,D=w.localCapabilities,u.transceivers[c].recvEncodingParameters=O,u.transceivers[c].remoteCapabilities=M,u.transceivers[c].rtcpParameters=A,F.length&&\"new\"===E.state&&(!m&&!x||v&&0!==c?F.forEach((function(e){s(w.iceTransport,e)})):E.setRemoteCandidates(F)),v&&0!==c||(\"new\"===E.state&&E.start(S,N,\"controlling\"),\"new\"===R.state&&R.start(I)),!o(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return\"rtx\"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,u._transceive(w,\"sendrecv\"===C||\"recvonly\"===C,\"sendrecv\"===C||\"sendonly\"===C),!k||\"sendrecv\"!==C&&\"sendonly\"!==C?delete w.rtpReceiver:(_=k.track,T?(p[T.stream]||(p[T.stream]=new e.MediaStream),n(_,p[T.stream]),l.push([_,k,p[T.stream]])):(p.default||(p.default=new e.MediaStream),n(_,p.default),l.push([_,k,p.default])))}}else{(w=u.transceivers[c]||u._createTransceiver(h)).mid=b,w.iceGatherer||(w.iceGatherer=u._createIceGatherer(c,v)),F.length&&\"new\"===w.iceTransport.state&&(!x||v&&0!==c?F.forEach((function(e){s(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(F)),D=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(D.codecs=D.codecs.filter((function(e){return\"rtx\"!==e.name}))),P=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,j=!1;if(\"sendrecv\"===C||\"sendonly\"===C){if(j=!w.rtpReceiver,k=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,h),j)_=k.track,T&&\"-\"===T.stream||(T?(p[T.stream]||(p[T.stream]=new e.MediaStream,Object.defineProperty(p[T.stream],\"id\",{get:function(){return T.stream}})),Object.defineProperty(_,\"id\",{get:function(){return T.track}}),L=p[T.stream]):(p.default||(p.default=new e.MediaStream),L=p.default)),L&&(n(_,L),w.associatedRemoteMediaStreams.push(L)),l.push([_,k,L])}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent(\"removetrack\",{track:t}))}(n,t)})),w.associatedRemoteMediaStreams=[]);w.localCapabilities=D,w.remoteCapabilities=M,w.rtpReceiver=k,w.rtcpParameters=A,w.sendEncodingParameters=P,w.recvEncodingParameters=O,u._transceive(u.transceivers[c],!1,j)}}})),void 0===u._dtlsRole&&(u._dtlsRole=\"offer\"===i.type?\"active\":\"passive\"),u._remoteDescription={type:i.type,sdp:i.sdp},\"offer\"===i.type?u._updateSignalingState(\"have-remote-offer\"):u._updateSignalingState(\"stable\"),Object.keys(p).forEach((function(t){var n=p[t];if(n.getTracks().length){if(-1===u.remoteStreams.indexOf(n)){u.remoteStreams.push(n);var r=new Event(\"addstream\");r.stream=n,e.setTimeout((function(){u._dispatchEvent(\"addstream\",r)}))}l.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&d(u,t,r,[n])}))}})),l.forEach((function(e){e[2]||d(u,e[0],e[1],[])})),e.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(e){e.iceTransport&&\"new\"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn(\"Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification\"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState(\"closed\")},u.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event(\"signalingstatechange\");this._dispatchEvent(\"signalingstatechange\",t)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;\"stable\"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event(\"negotiationneeded\");t._dispatchEvent(\"negotiationneeded\",e)}}),0))},u.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e=\"new\",t.failed>0?e=\"failed\":t.checking>0?e=\"checking\":t.disconnected>0?e=\"disconnected\":t.new>0?e=\"new\":t.connected>0?e=\"connected\":t.completed>0&&(e=\"completed\"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event(\"iceconnectionstatechange\");this._dispatchEvent(\"iceconnectionstatechange\",n)}},u.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e=\"new\",t.failed>0?e=\"failed\":t.connecting>0?e=\"connecting\":t.disconnected>0?e=\"disconnected\":t.new>0?e=\"new\":t.connected>0&&(e=\"connected\"),e!==this.connectionState){this.connectionState=e;var n=new Event(\"connectionstatechange\");this._dispatchEvent(\"connectionstatechange\",n)}},u.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not call createOffer after close\"));var o=n.transceivers.filter((function(e){return\"audio\"===e.kind})).length,a=n.transceivers.filter((function(e){return\"video\"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError(\"Legacy mandatory/optional constraints not supported.\");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){\"audio\"===e.kind?--o<0&&(e.wantReceive=!1):\"video\"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver(\"audio\"),o--),a>0&&(n._createTransceiver(\"video\"),a--);var d=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(s);t<15019&&(d.codecs=d.codecs.filter((function(e){return\"rtx\"!==e.name}))),d.codecs.forEach((function(e){\"H264\"===e.name&&void 0===e.parameters[\"level-asymmetry-allowed\"]&&(e.parameters[\"level-asymmetry-allowed\"]=\"1\"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&\"video\"===s&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=d,i.sendEncodingParameters=u})),\"max-compat\"!==n._config.bundlePolicy&&(d+=\"a=group:BUNDLE \"+n.transceivers.map((function(e){return e.mid})).join(\" \")+\"\\r\\n\"),d+=\"a=ice-options:trickle\\r\\n\",n.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,\"offer\",e.stream,n._dtlsRole),d+=\"a=rtcp-rsize\\r\\n\",!e.iceGatherer||\"new\"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+=\"a=\"+r.writeCandidate(e)+\"\\r\\n\"})),\"completed\"===e.iceGatherer.state&&(d+=\"a=end-of-candidates\\r\\n\"))}));var u=new e.RTCSessionDescription({type:\"offer\",sdp:d});return Promise.resolve(u)},u.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not call createAnswer after close\"));if(\"have-remote-offer\"!==n.signalingState&&\"have-local-pranswer\"!==n.signalingState)return Promise.reject(c(\"InvalidStateError\",\"Can not call createAnswer in signalingState \"+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+=\"a=group:BUNDLE \"+n.transceivers.map((function(e){return e.mid})).join(\" \")+\"\\r\\n\"),a+=\"a=ice-options:trickle\\r\\n\";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return\"application\"===e.kind?\"DTLS/SCTP\"===e.protocol?a+=\"m=application 0 DTLS/SCTP 5000\\r\\n\":a+=\"m=application 0 \"+e.protocol+\" webrtc-datachannel\\r\\n\":\"audio\"===e.kind?a+=\"m=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\na=rtpmap:0 PCMU/8000\\r\\n\":\"video\"===e.kind&&(a+=\"m=video 0 UDP/TLS/RTP/SAVPF 120\\r\\na=rtpmap:120 VP8/90000\\r\\n\"),void(a+=\"c=IN IP4 0.0.0.0\\r\\na=inactive\\r\\na=mid:\"+e.mid+\"\\r\\n\");var c;if(e.stream)\"audio\"===e.kind?c=e.stream.getAudioTracks()[0]:\"video\"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&\"video\"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=o(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return\"rtx\"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,d,\"answer\",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+=\"a=rtcp-rsize\\r\\n\")}}));var d=new e.RTCSessionDescription({type:\"answer\",sdp:a});return Promise.resolve(d)},u.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError(\"sdpMLineIndex or sdpMid required\")):new Promise((function(i,o){if(!n._remoteDescription)return o(c(\"InvalidStateError\",\"Can not add ICE candidate without a remote description\"));if(e&&\"\"!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){a=d;break}var u=n.transceivers[a];if(!u)return o(c(\"OperationError\",\"Can not add ICE candidate\"));if(u.rejected)return i();var p=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if(\"tcp\"===p.protocol&&(0===p.port||9===p.port))return i();if(p.component&&1!==p.component)return i();if((0===a||a>0&&u.iceTransport!==n.transceivers[0].iceTransport)&&!s(u.iceTransport,p))return o(c(\"OperationError\",\"Can not add ICE candidate\"));var l=e.candidate.trim();0===l.indexOf(\"a=\")&&(l=l.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+=\"a=\"+(p.type?l:\"end-of-candidates\")+\"\\r\\n\",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(\"\")}else for(var h=0;h<n.transceivers.length&&(n.transceivers[h].rejected||(n.transceivers[h].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[h]+=\"a=end-of-candidates\\r\\n\",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(\"\"),!n.usingBundle));h++);i()}))},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c(\"InvalidAccessError\",\"Invalid selector.\");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){[\"rtpSender\",\"rtpReceiver\",\"iceGatherer\",\"iceTransport\",\"dtlsTransport\"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};[\"RTCRtpSender\",\"RTCRtpReceiver\",\"RTCIceGatherer\",\"RTCIceTransport\",\"RTCDtlsTransport\"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:\"inbound-rtp\",outboundrtp:\"outbound-rtp\",candidatepair:\"candidate-pair\",localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var p=[\"createOffer\",\"createAnswer\"];return p.forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[0]||\"function\"===typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){\"function\"===typeof e[0]&&e[0].apply(null,[t])}),(function(t){\"function\"===typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(p=[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"]).forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[1]||\"function\"===typeof e[2]?t.apply(this,arguments).then((function(){\"function\"===typeof e[1]&&e[1].apply(null)}),(function(t){\"function\"===typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),[\"getStats\"].forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[1]?t.apply(this,arguments).then((function(){\"function\"===typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),u}},\"8oxB\":function(e,t){var n,r,i=e.exports={};function o(){throw new Error(\"setTimeout has not been defined\")}function a(){throw new Error(\"clearTimeout has not been defined\")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n=\"function\"===typeof setTimeout?setTimeout:o}catch(e){n=o}try{r=\"function\"===typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,d=[],u=!1,p=-1;function l(){u&&c&&(u=!1,c.length?d=c.concat(d):p=-1,d.length&&h())}function h(){if(!u){var e=s(l);u=!0;for(var t=d.length;t;){for(c=d,d=[];++p<t;)c&&c[p].run();p=-1,t=d.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},BARu:function(e,t){class n{constructor(e,t,n){this.localId=e,this.remoteId=t,this.sendSignalFunc=n,this.open=!1,this.channelLabel=\"networked-aframe-channel\",this.pc=this.createPeerConnection(),this.channel=null}setDatachannelListeners(e,t,n,r){this.openListener=e,this.closedListener=t,this.messageListener=n,this.trackListener=r}offer(e){var t=this;this.setupChannel(this.pc.createDataChannel(this.channelLabel,{reliable:!1})),e.sendAudio&&e.localAudioStream.getTracks().forEach(n=>t.pc.addTrack(n,e.localAudioStream)),this.pc.createOffer(e=>{t.handleSessionDescription(e)},e=>{NAF.log.error(\"WebRtcPeer.offer: \"+e)},{offerToReceiveAudio:!0,offerToReceiveVideo:!1})}handleSignal(e){if(this.localId===e.to&&this.remoteId===e.from)switch(e.type){case\"offer\":this.handleOffer(e);break;case\"answer\":this.handleAnswer(e);break;case\"candidate\":this.handleCandidate(e);break;default:NAF.log.error(\"WebRtcPeer.handleSignal: Unknown signal type \"+e.type)}}send(e,t){null!==this.channel&&\"open\"===this.channel.readyState&&this.channel.send(JSON.stringify({type:e,data:t}))}getStatus(){if(null===this.channel)return n.NOT_CONNECTED;switch(this.channel.readyState){case\"open\":return n.IS_CONNECTED;case\"connecting\":return n.CONNECTING;case\"closing\":case\"closed\":default:return n.NOT_CONNECTED}}createPeerConnection(){var e=this,t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection;if(void 0===t)throw new Error(\"WebRtcPeer.createPeerConnection: This browser does not seem to support WebRTC.\");var r=new t({iceServers:n.ICE_SERVERS});return r.onicecandidate=function(t){t.candidate&&e.sendSignalFunc({from:e.localId,to:e.remoteId,type:\"candidate\",sdpMLineIndex:t.candidate.sdpMLineIndex,candidate:t.candidate.candidate})},r.oniceconnectionstatechange=function(){e.open&&\"disconnected\"===r.iceConnectionState&&(e.open=!1,e.closedListener(e.remoteId))},r.ontrack=t=>{e.trackListener(e.remoteId,t.streams[0])},r}setupChannel(e){var t=this;this.channel=e,this.channel.onmessage=function(e){var n=JSON.parse(e.data);t.messageListener(t.remoteId,n.type,n.data)},this.channel.onopen=function(e){t.open=!0,t.openListener(t.remoteId)},this.channel.onclose=function(e){t.open&&(t.open=!1,t.closedListener(t.remoteId))},this.channel.onerror=function(e){NAF.log.error(\"WebRtcPeer.channel.onerror: \"+e)}}handleOffer(e){var t=this;this.pc.ondatachannel=function(e){t.setupChannel(e.channel)},this.setRemoteDescription(e),this.pc.createAnswer((function(e){t.handleSessionDescription(e)}),(function(e){NAF.log.error(\"WebRtcPeer.handleOffer: \"+e)}))}handleAnswer(e){this.setRemoteDescription(e)}handleCandidate(e){var t=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate;this.pc.addIceCandidate(new t(e),(function(){}),(function(e){NAF.log.error(\"WebRtcPeer.handleCandidate: \"+e)}))}handleSessionDescription(e){this.pc.setLocalDescription(e,(function(){}),(function(e){NAF.log.error(\"WebRtcPeer.handleSessionDescription: \"+e)})),this.sendSignalFunc({from:this.localId,to:this.remoteId,type:e.type,sdp:e.sdp})}setRemoteDescription(e){var t=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription;this.pc.setRemoteDescription(new t(e),(function(){}),(function(e){NAF.log.error(\"WebRtcPeer.setRemoteDescription: \"+e)}))}close(){this.pc&&this.pc.close()}}n.IS_CONNECTED=\"IS_CONNECTED\",n.CONNECTING=\"CONNECTING\",n.NOT_CONNECTED=\"NOT_CONNECTED\",n.ICE_SERVERS=[{urls:\"stun:stun1.l.google.com:19302\"},{urls:\"stun:stun2.l.google.com:19302\"},{urls:\"stun:stun3.l.google.com:19302\"},{urls:\"stun:stun4.l.google.com:19302\"}];e.exports=class{constructor(){void 0===io&&console.warn(\"It looks like socket.io has not been loaded before WebrtcAdapter. Please do that.\"),this.app=\"default\",this.room=\"default\",this.occupantListener=null,this.myRoomJoinTime=null,this.myId=null,this.peers={},this.occupants={},this.audioStreams={},this.pendingAudioRequest={},this.serverTimeRequests=0,this.timeOffsets=[],this.avgTimeOffset=0}setServerUrl(e){this.wsUrl=e}setApp(e){this.app=e}setRoom(e){this.room=e}setWebRtcOptions(e){!1===e.datachannel&&NAF.log.error(\"WebrtcAdapter.setWebRtcOptions: datachannel must be true.\"),!0===e.audio&&(this.sendAudio=!0),!0===e.video&&NAF.log.warn(\"WebrtcAdapter does not support video yet.\")}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.occupantListener=e}setDataChannelListeners(e,t,n){this.openListener=e,this.closedListener=t,this.messageListener=n}connect(){const e=this;this.updateTimeOffset().then(()=>{e.wsUrl&&\"/\"!==e.wsUrl||(\"https:\"===location.protocol?e.wsUrl=\"wss://\"+location.host:e.wsUrl=\"ws://\"+location.host),NAF.log.write(\"Attempting to connect to socket.io\");const t=e.socket=io(e.wsUrl);function n(t){const n=t.from,r=t.type,i=t.data;\"ice-candidate\"!==r?e.messageListener(n,r,i):e.peers[n].handleSignal(i)}t.on(\"connect\",()=>{NAF.log.write(\"User connected\",t.id),e.myId=t.id,e.joinRoom()}),t.on(\"connectSuccess\",t=>{const{joinedTime:n}=t;if(e.myRoomJoinTime=n,NAF.log.write(\"Successfully joined room\",e.room,\"at server time\",n),e.sendAudio){const t={audio:!0,video:!1};navigator.mediaDevices.getUserMedia(t).then(t=>{e.storeAudioStream(e.myId,t),e.connectSuccess(e.myId)}).catch(e=>NAF.log.error(e))}else e.connectSuccess(e.myId)}),t.on(\"error\",t=>{console.error(\"Socket connection failure\",t),e.connectFailure()}),t.on(\"occupantsChanged\",t=>{const{occupants:n}=t;NAF.log.write(\"occupants changed\",t),e.receivedOccupants(n)}),t.on(\"send\",n),t.on(\"broadcast\",n)})}joinRoom(){NAF.log.write(\"Joining room\",this.room),this.socket.emit(\"joinRoom\",{room:this.room})}receivedOccupants(e){delete e[this.myId],this.occupants=e;const t=this,r=this.myId;for(var i in e){const e=i;if(this.peers[e])continue;const o=new n(r,e,n=>{t.socket.emit(\"send\",{from:r,to:e,type:\"ice-candidate\",data:n,sending:!0})});o.setDatachannelListeners(t.openListener,t.closedListener,t.messageListener,t.trackListener.bind(t)),t.peers[e]=o}this.occupantListener(e)}shouldStartConnectionTo(e){return(this.myRoomJoinTime||0)<=(e||0)}startStreamConnection(e){NAF.log.write(\"starting offer process\"),this.sendAudio?this.getMediaStream(this.myId).then(t=>{const n={sendAudio:!0,localAudioStream:t};this.peers[e].offer(n)}):this.peers[e].offer({})}closeStreamConnection(e){NAF.log.write(\"closeStreamConnection\",e,this.peers),this.peers[e].close(),delete this.peers[e],delete this.occupants[e],this.closedListener(e)}getConnectStatus(e){const t=this.peers[e];if(void 0===t)return NAF.adapters.NOT_CONNECTED;switch(t.getStatus()){case n.IS_CONNECTED:return NAF.adapters.IS_CONNECTED;case n.CONNECTING:return NAF.adapters.CONNECTING;case n.NOT_CONNECTED:default:return NAF.adapters.NOT_CONNECTED}}sendData(e,t,n){this.peers[e].send(t,n)}sendDataGuaranteed(e,t,n){const r={from:this.myId,to:e,type:t,data:n,sending:!0};this.socket.emit(\"send\",r)}broadcastData(e,t){for(var n in this.peers)this.sendData(n,e,t)}broadcastDataGuaranteed(e,t){const n={from:this.myId,type:e,data:t,broadcasting:!0};this.socket.emit(\"broadcast\",n)}storeAudioStream(e,t){this.audioStreams[e]=t,this.pendingAudioRequest[e]&&(NAF.log.write(\"Received pending audio for \"+e),this.pendingAudioRequest[e](t),this.pendingAudioRequest[e](t))}trackListener(e,t){this.storeAudioStream(e,t)}getMediaStream(e){var t=this;return this.audioStreams[e]?(NAF.log.write(\"Already had audio for \"+e),Promise.resolve(this.audioStreams[e])):(NAF.log.write(\"Waiting on audio for \"+e),new Promise(n=>{t.pendingAudioRequest[e]=n}))}updateTimeOffset(){const e=Date.now()+this.avgTimeOffset;return fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}).then(t=>{var n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?setTimeout(()=>this.updateTimeOffset(),3e5):this.updateTimeOffset()})}getServerTime(){return new Date+this.avgTimeOffset}}},EYIQ:function(e,t,n){var r=n(\"tvSW\"),i=n(\"iBZa\"),o=n(\"mqsc\"),a=n(\"umSQ\"),s=n(\"G4PH\"),c=n(\"Pozc\"),d=n(\"V8Jh\"),u={app:\"\",room:\"\",clientId:\"\"};u.options=r,u.utils=i,u.log=new o,u.schemas=new a,u.version=\"0.6.1\",u.adapters=new d;var p=new s,l=new c(p);u.connection=l,u.entities=p,e.exports=window.NAF=u},FGiv:function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,a=7*o,s=365.25*o;function c(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+\" \"+r+(i?\"s\":\"\")}e.exports=function(e,t){t=t||{};var d=typeof e;if(\"string\"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||\"ms\").toLowerCase()){case\"years\":case\"year\":case\"yrs\":case\"yr\":case\"y\":return c*s;case\"weeks\":case\"week\":case\"w\":return c*a;case\"days\":case\"day\":case\"d\":return c*o;case\"hours\":case\"hour\":case\"hrs\":case\"hr\":case\"h\":return c*i;case\"minutes\":case\"minute\":case\"mins\":case\"min\":case\"m\":return c*r;case\"seconds\":case\"second\":case\"secs\":case\"sec\":case\"s\":return c*n;case\"milliseconds\":case\"millisecond\":case\"msecs\":case\"msec\":case\"ms\":return c;default:return}}(e);if(\"number\"===d&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return c(e,t,o,\"day\");if(t>=i)return c(e,t,i,\"hour\");if(t>=r)return c(e,t,r,\"minute\");if(t>=n)return c(e,t,n,\"second\");return e+\" ms\"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+\"d\";if(t>=i)return Math.round(e/i)+\"h\";if(t>=r)return Math.round(e/r)+\"m\";if(t>=n)return Math.round(e/n)+\"s\";return e+\"ms\"}(e);throw new Error(\"val is not a non-empty string or a valid number. val=\"+JSON.stringify(e))}},FJvS:function(e,t){AFRAME.registerComponent(\"networked-scene\",{schema:{serverURL:{default:\"/\"},app:{default:\"default\"},room:{default:\"default\"},connectOnLoad:{default:!0},onConnect:{default:\"onConnect\"},adapter:{default:\"socketio\"},audio:{default:!1},debug:{default:!1}},init:function(){var e=this.el;this.connect=this.connect.bind(this),e.addEventListener(\"connect\",this.connect),this.data.connectOnLoad&&e.emit(\"connect\",null,!1)},connect:function(){return NAF.log.setDebug(this.data.debug),NAF.log.write(\"Networked-Aframe Connecting...\"),this.checkDeprecatedProperties(),this.setupNetworkAdapter(),this.hasOnConnectFunction()&&this.callOnConnect(),NAF.connection.connect(this.data.serverURL,this.data.app,this.data.room,this.data.audio)},checkDeprecatedProperties:function(){},setupNetworkAdapter:function(){var e=this.data.adapter,t=NAF.adapters.make(e);NAF.connection.setNetworkAdapter(t),this.el.emit(\"adapter-ready\",t,!1)},hasOnConnectFunction:function(){return\"\"!=this.data.onConnect&&window[this.data.onConnect]},callOnConnect:function(){NAF.connection.onConnect(window[this.data.onConnect])},remove:function(){NAF.log.write(\"networked-scene disconnected\"),this.el.removeEventListener(\"connect\",this.connect),NAF.connection.disconnect()}})},G4PH:function(e,t,n){var r=n(\"ozXo\");e.exports=class{constructor(){this.entities={},this.childCache=new r,this.onRemoteEntityCreatedEvent=new Event(\"remoteEntityCreated\"),this._persistentFirstSyncs={}}registerEntity(e,t){this.entities[e]=t}createRemoteEntity(e){NAF.log.write(\"Creating remote entity\",e);var t=e.networkId,n=NAF.schemas.getCachedTemplate(e.template);return n.setAttribute(\"id\",\"naf-\"+t),this.initPosition(n,e.components),this.initRotation(n,e.components),this.addNetworkComponent(n,e),this.registerEntity(t,n),n}initPosition(e,t){if(t.position){var n=t.position;e.setAttribute(\"position\",n)}}initRotation(e,t){if(t.rotation){var n=t.rotation;e.setAttribute(\"rotation\",n)}}addNetworkComponent(e,t){var n={template:t.template,creator:t.creator,owner:t.owner,networkId:t.networkId,persistent:t.persistent};e.setAttribute(\"networked\",n),e.firstUpdateData=t}updateEntityMulti(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource)for(let i=0,o=n.d.length;i<o;i++)this.updateEntity(e,\"u\",n.d[i],r)}updateEntity(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource){var i=n.networkId;this.hasEntity(i)?this.entities[i].components.networked.networkUpdate(n):n.isFirstSync&&(NAF.options.firstSyncSource&&r!==NAF.options.firstSyncSource?NAF.log.write(\"Ignoring first sync from disallowed source\",r):n.persistent?this._persistentFirstSyncs[i]=n:this.receiveFirstUpdateFromEntity(n))}}receiveFirstUpdateFromEntity(e){var t=e.parent,n=e.networkId;if(t&&!this.hasEntity(t))this.childCache.addChild(t,e);else{var r=this.createRemoteEntity(e);this.createAndAppendChildren(n,r),this.addEntityToPage(r,t)}}createAndAppendChildren(e,t){for(var n=this.childCache.getChildren(e),r=0;r<n.length;r++){var i=n[r],o=i.networkId;if(this.hasEntity(o))NAF.log.warn(\"Tried to instantiate entity multiple times\",o,i,\"Existing entity:\",this.getEntity(o));else{var a=this.createRemoteEntity(i);this.createAndAppendChildren(o,a),t.appendChild(a)}}}addEntityToPage(e,t){this.hasEntity(t)?this.addEntityToParent(e,t):this.addEntityToSceneRoot(e)}addEntityToParent(e,t){document.getElementById(\"naf-\"+t).appendChild(e)}addEntityToSceneRoot(e){document.querySelector(\"a-scene\").appendChild(e)}completeSync(e,t){for(var n in this.entities)this.entities[n]&&this.entities[n].components.networked.syncAll(e,t)}removeRemoteEntity(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource){var i=n.networkId;return this.removeEntity(i)}}removeEntitiesOfClient(e){var t=[];for(var n in this.entities){if(NAF.utils.getCreator(this.entities[n])===e){let e;const i=this.entities[n].getAttribute(\"networked\");if(i&&i.persistent&&(e=NAF.utils.takeOwnership(this.entities[n])),!e){var r=this.removeEntity(n);t.push(r)}}}return t}removeEntity(e){if(this.forgetPersistentFirstSync(e),this.hasEntity(e)){var t=this.entities[e];return this.forgetEntity(e),t.parentNode.removeChild(t),t}return NAF.log.error(\"Tried to remove entity I don't have.\"),null}forgetEntity(e){delete this.entities[e],this.forgetPersistentFirstSync(e)}getPersistentFirstSync(e){return this._persistentFirstSyncs[e]}forgetPersistentFirstSync(e){delete this._persistentFirstSyncs[e]}getEntity(e){return this.entities[e]?this.entities[e]:null}hasEntity(e){return!!this.entities[e]}removeRemoteEntities(){for(var e in this.childCache=new r,this.entities){this.entities[e].getAttribute(\"networked\").owner!=NAF.clientId&&this.removeEntity(e)}}}},GAh6:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports=function(e,t){var i=e&&e.window,o={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var a in t)hasOwnProperty.call(t,a)&&(o[a]=t[a]);var s=r.log,c=r.detectBrowser(i),d=n(\"+phH\")||null,u=n(\"sJPo\")||null,p=n(\"Mupt\")||null,l=n(\"goMv\")||null,h=n(\"ggQn\")||null,f={browserDetails:c,commonShim:h,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case\"chrome\":if(!d||!d.shimPeerConnection||!o.shimChrome)return s(\"Chrome shim is not included in this adapter release.\"),f;s(\"adapter.js shimming chrome.\"),f.browserShim=d,h.shimCreateObjectURL(i),d.shimGetUserMedia(i),d.shimMediaStream(i),d.shimSourceObject(i),d.shimPeerConnection(i),d.shimOnTrack(i),d.shimAddTrackRemoveTrack(i),d.shimGetSendersWithDtmf(i),d.shimSenderReceiverGetStats(i),d.fixNegotiationNeeded(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"firefox\":if(!p||!p.shimPeerConnection||!o.shimFirefox)return s(\"Firefox shim is not included in this adapter release.\"),f;s(\"adapter.js shimming firefox.\"),f.browserShim=p,h.shimCreateObjectURL(i),p.shimGetUserMedia(i),p.shimSourceObject(i),p.shimPeerConnection(i),p.shimOnTrack(i),p.shimRemoveStream(i),p.shimSenderGetStats(i),p.shimReceiverGetStats(i),p.shimRTCDataChannel(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"edge\":if(!u||!u.shimPeerConnection||!o.shimEdge)return s(\"MS edge shim is not included in this adapter release.\"),f;s(\"adapter.js shimming edge.\"),f.browserShim=u,h.shimCreateObjectURL(i),u.shimGetUserMedia(i),u.shimPeerConnection(i),u.shimReplaceTrack(i),u.shimGetDisplayMedia(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"safari\":if(!l||!o.shimSafari)return s(\"Safari shim is not included in this adapter release.\"),f;s(\"adapter.js shimming safari.\"),f.browserShim=l,h.shimCreateObjectURL(i),l.shimRTCIceServerUrls(i),l.shimCreateOfferLegacy(i),l.shimCallbacksAPI(i),l.shimLocalStreamsAPI(i),l.shimRemoteStreamsAPI(i),l.shimTrackEventTransceiver(i),l.shimGetUserMedia(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;default:s(\"Unsupported browser!\")}return f}},JX7q:function(e,t,n){\"use strict\";function r(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}n.d(t,\"a\",(function(){return r}))},Ji7U:function(e,t,n){\"use strict\";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if(\"function\"!==typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,\"a\",(function(){return i}))},KCt4:function(e,t,n){\"use strict\";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split(\"\\n\").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split(\"\\nm=\").map((function(e,t){return(t>0?\"m=\"+e:e).trim()+\"\\r\\n\"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf(\"a=candidate:\")?e.substring(12).split(\" \"):e.substring(10).split(\" \"))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case\"raddr\":n.relatedAddress=t[r+1];break;case\"rport\":n.relatedPort=parseInt(t[r+1],10);break;case\"tcptype\":n.tcpType=t[r+1];break;case\"ufrag\":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push(\"typ\"),t.push(n),\"host\"!==n&&e.relatedAddress&&e.relatedPort&&(t.push(\"raddr\"),t.push(e.relatedAddress),t.push(\"rport\"),t.push(e.relatedPort)),e.tcpType&&\"tcp\"===e.protocol.toLowerCase()&&(t.push(\"tcptype\"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push(\"ufrag\"),t.push(e.usernameFragment||e.ufrag)),\"candidate:\"+t.join(\" \")},r.parseIceOptions=function(e){return e.substr(14).split(\" \")},r.parseRtpMap=function(e){var t=e.substr(9).split(\" \"),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split(\"/\"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return\"a=rtpmap:\"+t+\" \"+e.name+\"/\"+e.clockRate+(1!==n?\"/\"+n:\"\")+\"\\r\\n\"},r.parseExtmap=function(e){var t=e.substr(9).split(\" \");return{id:parseInt(t[0],10),direction:t[0].indexOf(\"/\")>0?t[0].split(\"/\")[1]:\"sendrecv\",uri:t[1]}},r.writeExtmap=function(e){return\"a=extmap:\"+(e.id||e.preferredId)+(e.direction&&\"sendrecv\"!==e.direction?\"/\"+e.direction:\"\")+\" \"+e.uri+\"\\r\\n\"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(\" \")+1).split(\";\"),i=0;i<r.length;i++)n[(t=r[i].trim().split(\"=\"))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t=\"\",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+\"=\"+e.parameters[t]):r.push(t)})),t+=\"a=fmtp:\"+n+\" \"+r.join(\";\")+\"\\r\\n\"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(\" \")+1).split(\" \");return{type:t.shift(),parameter:t.join(\" \")}},r.writeRtcpFb=function(e){var t=\"\",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+=\"a=rtcp-fb:\"+n+\" \"+e.type+(e.parameter&&e.parameter.length?\" \"+e.parameter:\"\")+\"\\r\\n\"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(\" \"),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(\":\",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(\" \");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,\"a=mid:\")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(\" \");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:\"auto\",fingerprints:r.matchPrefix(e+t,\"a=fingerprint:\").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n=\"a=setup:\"+t+\"\\r\\n\";return e.fingerprints.forEach((function(e){n+=\"a=fingerprint:\"+e.algorithm+\" \"+e.value+\"\\r\\n\"})),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(\" \");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return\"a=crypto:\"+e.tag+\" \"+e.cryptoSuite+\" \"+(\"object\"===typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?\" \"+e.sessionParams.join(\" \"):\"\")+\"\\r\\n\"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf(\"inline:\"))return null;var t=e.substr(7).split(\"|\");return{keyMethod:\"inline\",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(\":\")[0]:void 0,mkiLength:t[2]?t[2].split(\":\")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+\":\"+e.keySalt+(e.lifeTime?\"|\"+e.lifeTime:\"\")+(e.mkiValue&&e.mkiLength?\"|\"+e.mkiValue+\":\"+e.mkiLength:\"\")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,\"a=crypto:\").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,\"a=ice-ufrag:\")[0],i=r.matchPrefix(e+t,\"a=ice-pwd:\")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return\"a=ice-ufrag:\"+e.usernameFragment+\"\\r\\na=ice-pwd:\"+e.password+\"\\r\\n\"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(\" \"),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,\"a=rtpmap:\"+o+\" \")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,\"a=fmtp:\"+o+\" \");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,\"a=rtcp-fb:\"+o+\" \").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case\"RED\":case\"ULPFEC\":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,\"a=extmap:\").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n=\"\";n+=\"m=\"+e+\" \",n+=t.codecs.length>0?\"9\":\"0\",n+=\" UDP/TLS/RTP/SAVPF \",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(\" \")+\"\\r\\n\",n+=\"c=IN IP4 0.0.0.0\\r\\n\",n+=\"a=rtcp:9 IN IP4 0.0.0.0\\r\\n\",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+=\"a=maxptime:\"+i+\"\\r\\n\"),n+=\"a=rtcp-mux\\r\\n\",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf(\"RED\"),a=-1!==i.fecMechanisms.indexOf(\"ULPFEC\"),s=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"cname\"===e.attribute})),c=s.length>0&&s[0].ssrc,d=r.matchPrefix(e,\"a=ssrc-group:FID\").map((function(e){return e.substr(17).split(\" \").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),i.codecs.forEach((function(e){if(\"RTX\"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?\"red+ulpfec\":\"red\"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var u=r.matchPrefix(e,\"b=\");return u.length&&(u=0===u[0].indexOf(\"b=TIAS:\")?parseInt(u[0].substr(7),10):0===u[0].indexOf(\"b=AS:\")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=u}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"cname\"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,\"a=rtcp-rsize\");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,\"a=rtcp-mux\");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,\"a=msid:\");if(1===n.length)return{stream:(t=n[0].substr(7).split(\" \"))[0],track:t[1]};var i=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"msid\"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(\" \"))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,\"a=max-message-size:\");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,\"a=sctp-port:\");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,\"a=sctpmap:\").length>0){var a=r.matchPrefix(e,\"a=sctpmap:\")[0].substr(10).split(\" \");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n=\"DTLS/SCTP\"!==e.protocol?[\"m=\"+e.kind+\" 9 \"+e.protocol+\" \"+t.protocol+\"\\r\\n\",\"c=IN IP4 0.0.0.0\\r\\n\",\"a=sctp-port:\"+t.port+\"\\r\\n\"]:[\"m=\"+e.kind+\" 9 \"+e.protocol+\" \"+t.port+\"\\r\\n\",\"c=IN IP4 0.0.0.0\\r\\n\",\"a=sctpmap:\"+t.port+\" \"+t.protocol+\" 65535\\r\\n\"],void 0!==t.maxMessageSize&&n.push(\"a=max-message-size:\"+t.maxMessageSize+\"\\r\\n\"),n.join(\"\")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return\"v=0\\r\\no=\"+(n||\"thisisadapterortc\")+\" \"+(e||r.generateSessionId())+\" \"+i+\" IN IP4 127.0.0.1\\r\\ns=-\\r\\nt=0 0\\r\\n\"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),\"offer\"===n?\"actpass\":\"active\"),o+=\"a=mid:\"+e.mid+\"\\r\\n\",e.direction?o+=\"a=\"+e.direction+\"\\r\\n\":e.rtpSender&&e.rtpReceiver?o+=\"a=sendrecv\\r\\n\":e.rtpSender?o+=\"a=sendonly\\r\\n\":e.rtpReceiver?o+=\"a=recvonly\\r\\n\":o+=\"a=inactive\\r\\n\",e.rtpSender){var a=\"msid:\"+i.id+\" \"+e.rtpSender.track.id+\"\\r\\n\";o+=\"a=\"+a,o+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" \"+a,e.sendEncodingParameters[0].rtx&&(o+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" \"+a,o+=\"a=ssrc-group:FID \"+e.sendEncodingParameters[0].ssrc+\" \"+e.sendEncodingParameters[0].rtx.ssrc+\"\\r\\n\")}return o+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" cname:\"+r.localCName+\"\\r\\n\",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" cname:\"+r.localCName+\"\\r\\n\"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case\"a=sendrecv\":case\"a=sendonly\":case\"a=recvonly\":case\"a=inactive\":return n[i].substr(2)}return t?r.getDirection(t):\"sendrecv\"},r.getKind=function(e){return r.splitLines(e)[0].split(\" \")[0].substr(2)},r.isRejected=function(e){return\"0\"===e.split(\" \",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(\" \");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(\" \")}},r.parseOLine=function(e){var t=r.matchPrefix(e,\"o=\")[0].substr(2).split(\" \");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if(\"string\"!==typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||\"=\"!==t[n].charAt(1))return!1;return!0},e.exports=r},Mupt:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports={shimGetUserMedia:n(\"pXin\"),shimOnTrack:function(e){\"object\"!==typeof e||!e.RTCPeerConnection||\"ontrack\"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,\"ontrack\",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener(\"track\",this._ontrack),this.removeEventListener(\"addstream\",this._ontrackpoly)),this.addEventListener(\"track\",this._ontrack=e),this.addEventListener(\"addstream\",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event(\"track\");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),\"object\"===typeof e&&e.RTCTrackEvent&&\"receiver\"in e.RTCTrackEvent.prototype&&!(\"transceiver\"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,\"transceiver\",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){\"object\"===typeof e&&(!e.HTMLMediaElement||\"srcObject\"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,\"srcObject\",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(\"object\"===typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,r){if(t.version<38&&n&&n.iceServers){for(var i=[],o=0;o<n.iceServers.length;o++){var a=n.iceServers[o];if(a.hasOwnProperty(\"urls\"))for(var s=0;s<a.urls.length;s++){var c={url:a.urls[s]};0===a.urls[s].indexOf(\"turn\")&&(c.username=a.username,c.credential=a.credential),i.push(c)}else i.push(n.iceServers[o])}n.iceServers=i}return new e.mozRTCPeerConnection(n,r)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new(\"addIceCandidate\"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:\"inbound-rtp\",outboundrtp:\"outbound-rtp\",candidatepair:\"candidate-pair\",localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){return o.apply(this,[e||null]).then((function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n]),t[n]=e[n]})),t}(e)),t.version<53&&!n)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(r){if(\"TypeError\"!==r.name)throw r;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(n,r)}}},shimSenderGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&\"getStats\"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&\"getStats\"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n}),r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||\"removeStream\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated(\"removeStream\",\"removeTrack\"),this.getSenders().forEach((function(n){n.track&&-1!==e.getTracks().indexOf(n.track)&&t.removeTrack(n)}))})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||\"getDisplayMedia\"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException(\"getDisplayMedia without video constraints is undefined\");return r.name=\"NotFoundError\",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),e.navigator.mediaDevices.getDisplayMedia(t)})}}},Pozc:function(e,t){var n={Update:\"u\",UpdateMulti:\"um\",Remove:\"r\"};e.exports=class{constructor(e){this.entities=e,this.setupDefaultDataSubscriptions(),this.connectedClients={},this.activeDataChannels={}}setNetworkAdapter(e){this.adapter=e}setupDefaultDataSubscriptions(){this.dataChannelSubs={},this.dataChannelSubs[n.Update]=this.entities.updateEntity.bind(this.entities),this.dataChannelSubs[n.UpdateMulti]=this.entities.updateEntityMulti.bind(this.entities),this.dataChannelSubs[n.Remove]=this.entities.removeRemoteEntity.bind(this.entities)}connect(e,t,n,r=!1){NAF.app=t,NAF.room=n,this.adapter.setServerUrl(e),this.adapter.setApp(t),this.adapter.setRoom(n);var i={audio:r,video:!1,datachannel:!0};return this.adapter.setWebRtcOptions(i),this.adapter.setServerConnectListeners(this.connectSuccess.bind(this),this.connectFailure.bind(this)),this.adapter.setDataChannelListeners(this.dataChannelOpen.bind(this),this.dataChannelClosed.bind(this),this.receivedData.bind(this)),this.adapter.setRoomOccupantListener(this.occupantsReceived.bind(this)),this.adapter.connect()}onConnect(e){this.onConnectCallback=e,this.isConnected()?e():document.body.addEventListener(\"connected\",e,!1)}connectSuccess(e){NAF.log.write(\"Networked-Aframe Client ID:\",e),NAF.clientId=e;var t=new CustomEvent(\"connected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}connectFailure(e,t){NAF.log.error(e,\"failure to connect\")}occupantsReceived(e){var t=Object.assign({},this.connectedClients);this.connectedClients=e,this.checkForDisconnectingClients(t,e),this.checkForConnectingClients(e)}checkForDisconnectingClients(e,t){for(var n in e){t[n]||(NAF.log.write(\"Closing stream to \",n),this.adapter.closeStreamConnection(n))}}checkForConnectingClients(e){for(var t in e){this.isNewClient(t)&&this.adapter.shouldStartConnectionTo(e[t])&&(NAF.log.write(\"Opening datachannel to \",t),this.adapter.startStreamConnection(t))}}getConnectedClients(){return this.connectedClients}isConnected(){return!!NAF.clientId}isMineAndConnected(e){return this.isConnected()&&NAF.clientId===e}isNewClient(e){return!this.isConnectedTo(e)}isConnectedTo(e){return this.adapter.getConnectStatus(e)===NAF.adapters.IS_CONNECTED}dataChannelOpen(e){NAF.log.write(\"Opened data channel from \"+e),this.activeDataChannels[e]=!0,this.entities.completeSync(e,!0);var t=new CustomEvent(\"clientConnected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}dataChannelClosed(e){NAF.log.write(\"Closed data channel from \"+e),this.activeDataChannels[e]=!1,this.entities.removeEntitiesOfClient(e);var t=new CustomEvent(\"clientDisconnected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}hasActiveDataChannel(e){return!(!this.activeDataChannels[e]||!this.activeDataChannels[e])}broadcastData(e,t){this.adapter.broadcastData(e,t)}broadcastDataGuaranteed(e,t){this.adapter.broadcastDataGuaranteed(e,t)}sendData(e,t,n,r){this.hasActiveDataChannel(e)&&(r?this.adapter.sendDataGuaranteed(e,t,n):this.adapter.sendData(e,t,n))}sendDataGuaranteed(e,t,n){this.sendData(e,t,n,!0)}subscribeToDataChannel(e,t){this.isReservedDataType(e)?NAF.log.error(\"NetworkConnection@subscribeToDataChannel: \"+e+\" is a reserved dataType. Choose another\"):this.dataChannelSubs[e]=t}unsubscribeToDataChannel(e){this.isReservedDataType(e)?NAF.log.error(\"NetworkConnection@unsubscribeToDataChannel: \"+e+\" is a reserved dataType. Choose another\"):delete this.dataChannelSubs[e]}isReservedDataType(e){return e==n.Update||e==n.Remove}receivedData(e,t,n,r){this.dataChannelSubs[t]?this.dataChannelSubs[t](e,t,n,r):NAF.log.write(\"NetworkConnection@receivedData: \"+t+\" has not been subscribed to yet. Call subscribeToDataChannel()\")}getServerTime(){return this.adapter.getServerTime()}disconnect(){this.entities.removeRemoteEntities(),this.adapter.disconnect(),NAF.app=\"\",NAF.room=\"\",NAF.clientId=\"\",this.connectedClients={},this.activeDataChannels={},this.adapter=null,this.setupDefaultDataSubscriptions(),document.body.removeEventListener(\"connected\",this.onConnectCallback)}}},Qetd:function(e,t,n){\"use strict\";var r=Object.assign.bind(Object);e.exports=r,e.exports.default=e.exports},STrH:function(e,t,n){var r=n(\"VKE9\"),i=n(\"KCt4\"),o=n(\"vPXE\")(\"naf-janus-adapter:debug\"),a=(n(\"vPXE\")(\"naf-janus-adapter:warn\"),n(\"vPXE\")(\"naf-janus-adapter:error\")),s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);const c=15e3;function d(e){var t=Promise.resolve();return function(){var n=Array.prototype.slice.call(arguments);t=t.then(t=>e.apply(this,n))}}function u(e){return new Promise((t,n)=>{if(\"open\"===e.readyState)t();else{let r,i;const o=()=>{e.removeEventListener(\"open\",r),e.removeEventListener(\"error\",i)};r=()=>{o(),t()},i=()=>{o(),n()},e.addEventListener(\"open\",r),e.addEventListener(\"error\",i)}})}const p=\"\"!==document.createElement(\"video\").canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"'),l={usedtx:1,stereo:0,\"sprop-stereo\":0},h={iceServers:[{urls:\"stun:stun1.l.google.com:19302\"},{urls:\"stun:stun2.l.google.com:19302\"}]},f=1e3;class m{constructor(){this.room=null,this.clientId=null,this.joinToken=null,this.serverUrl=null,this.webRtcOptions={},this.peerConnectionConfig=null,this.ws=null,this.session=null,this.reliableTransport=\"datachannel\",this.unreliableTransport=\"datachannel\",this.initialReconnectionDelay=1e3*Math.random(),this.reconnectionDelay=this.initialReconnectionDelay,this.reconnectionTimeout=null,this.maxReconnectionAttempts=10,this.reconnectionAttempts=0,this.publisher=null,this.occupants={},this.leftOccupants=new Set,this.mediaStreams={},this.localMediaStream=null,this.pendingMediaRequests=new Map,this.blockedClients=new Map,this.frozenUpdates=new Map,this.timeOffsets=[],this.serverTimeRequests=0,this.avgTimeOffset=0,this.onWebsocketOpen=this.onWebsocketOpen.bind(this),this.onWebsocketClose=this.onWebsocketClose.bind(this),this.onWebsocketMessage=this.onWebsocketMessage.bind(this),this.onDataChannelMessage=this.onDataChannelMessage.bind(this),this.onData=this.onData.bind(this)}setServerUrl(e){this.serverUrl=e}setApp(e){}setRoom(e){this.room=e}setJoinToken(e){this.joinToken=e}setClientId(e){this.clientId=e}setWebRtcOptions(e){this.webRtcOptions=e}setPeerConnectionConfig(e){this.peerConnectionConfig=e}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.onOccupantsChanged=e}setDataChannelListeners(e,t,n){this.onOccupantConnected=e,this.onOccupantDisconnected=t,this.onOccupantMessage=n}setReconnectionListeners(e,t,n){this.onReconnecting=e,this.onReconnected=t,this.onReconnectionError=n}connect(){o(`connecting to ${this.serverUrl}`);const e=new Promise((e,t)=>{let n;this.ws=new WebSocket(this.serverUrl,\"janus-protocol\"),this.session=new r.JanusSession(this.ws.send.bind(this.ws),{timeoutMs:3e4});const i=()=>{t(a)};this.ws.addEventListener(\"close\",this.onWebsocketClose),this.ws.addEventListener(\"message\",this.onWebsocketMessage),n=()=>{this.ws.removeEventListener(\"open\",n),this.ws.removeEventListener(\"error\",i),this.onWebsocketOpen().then(e).catch(t)},this.ws.addEventListener(\"open\",n)});return Promise.all([e,this.updateTimeOffset()])}disconnect(){o(\"disconnecting\"),clearTimeout(this.reconnectionTimeout),this.removeAllOccupants(),this.leftOccupants=new Set,this.publisher&&(this.publisher.conn.close(),this.publisher=null),this.session&&(this.session.dispose(),this.session=null),this.ws&&(this.ws.removeEventListener(\"open\",this.onWebsocketOpen),this.ws.removeEventListener(\"close\",this.onWebsocketClose),this.ws.removeEventListener(\"message\",this.onWebsocketMessage),this.ws.close(),this.ws=null)}isDisconnected(){return null===this.ws}async onWebsocketOpen(){await this.session.create(),this.publisher=await this.createPublisher(),this.connectSuccess(this.clientId);const e=[];for(let t=0;t<this.publisher.initialOccupants.length;t++){const n=this.publisher.initialOccupants[t];n!==this.clientId&&e.push(this.addOccupant(n))}await Promise.all(e)}onWebsocketClose(e){e.code!==f&&(this.onReconnecting&&this.onReconnecting(this.reconnectionDelay),this.reconnectionTimeout=setTimeout(()=>this.reconnect(),this.reconnectionDelay))}reconnect(){this.disconnect(),this.connect().then(()=>{this.reconnectionDelay=this.initialReconnectionDelay,this.reconnectionAttempts=0,this.onReconnected&&this.onReconnected()}).catch(e=>{if(this.reconnectionDelay+=1e3,this.reconnectionAttempts++,this.reconnectionAttempts>this.maxReconnectionAttempts&&this.onReconnectionError)return this.onReconnectionError(new Error(\"Connection could not be reestablished, exceeded maximum number of reconnection attempts.\"));console.warn(\"Error during reconnect, retrying.\"),console.warn(e),this.onReconnecting&&this.onReconnecting(this.reconnectionDelay),this.reconnectionTimeout=setTimeout(()=>this.reconnect(),this.reconnectionDelay)})}performDelayedReconnect(){this.delayedReconnectTimeout&&clearTimeout(this.delayedReconnectTimeout),this.delayedReconnectTimeout=setTimeout(()=>{this.delayedReconnectTimeout=null,this.reconnect()},1e4)}onWebsocketMessage(e){this.session.receive(JSON.parse(e.data))}async addOccupant(e){this.occupants[e]&&this.removeOccupant(e),this.leftOccupants.delete(e);var t=await this.createSubscriber(e);if(t)return this.occupants[e]=t,this.setMediaStream(e,t.mediaStream),this.onOccupantConnected(e),this.onOccupantsChanged(this.occupants),t}removeAllOccupants(){for(const e of Object.getOwnPropertyNames(this.occupants))this.removeOccupant(e)}removeOccupant(e){if(this.leftOccupants.add(e),this.occupants[e]){if(this.occupants[e]&&(this.occupants[e].conn.close(),delete this.occupants[e]),this.mediaStreams[e]&&delete this.mediaStreams[e],this.pendingMediaRequests.has(e)){const t=\"The user disconnected before the media stream was resolved.\";this.pendingMediaRequests.get(e).audio.reject(t),this.pendingMediaRequests.get(e).video.reject(t),this.pendingMediaRequests.delete(e)}this.onOccupantDisconnected(e),this.onOccupantsChanged(this.occupants)}}associate(e,t){e.addEventListener(\"icecandidate\",e=>{t.sendTrickle(e.candidate||null).catch(e=>a(\"Error trickling ICE: %o\",e))}),e.addEventListener(\"iceconnectionstatechange\",t=>{\"failed\"===e.iceConnectionState&&(console.warn(\"ICE failure detected. Reconnecting in 10s.\"),this.performDelayedReconnect())}),e.addEventListener(\"negotiationneeded\",d(n=>{o(\"Sending new offer for handle: %o\",t);var r=e.createOffer().then(this.configurePublisherSdp).then(this.fixSafariIceUFrag),i=r.then(t=>e.setLocalDescription(t)),s=r;return s=s.then(this.fixSafariIceUFrag).then(e=>t.sendJsep(e)).then(t=>e.setRemoteDescription(t.jsep)),Promise.all([i,s]).catch(e=>a(\"Error negotiating offer: %o\",e))})),t.on(\"event\",d(n=>{var r=n.jsep;if(r&&\"offer\"==r.type){o(\"Accepting new offer for handle: %o\",t);var i=e.setRemoteDescription(this.configureSubscriberSdp(r)).then(t=>e.createAnswer()).then(this.fixSafariIceUFrag),s=i.then(t=>e.setLocalDescription(t)),c=i.then(e=>t.sendJsep(e));return Promise.all([s,c]).catch(e=>a(\"Error negotiating answer: %o\",e))}return null}))}async createPublisher(){var e=new r.JanusPluginHandle(this.session),t=new RTCPeerConnection(this.peerConnectionConfig||h);o(\"pub waiting for sfu\"),await e.attach(\"janus.plugin.sfu\"),this.associate(t,e),o(\"pub waiting for data channels & webrtcup\");var n=new Promise(t=>e.on(\"webrtcup\",t)),i=t.createDataChannel(\"reliable\",{ordered:!0}),a=t.createDataChannel(\"unreliable\",{ordered:!1,maxRetransmits:0});i.addEventListener(\"message\",e=>this.onDataChannelMessage(e,\"janus-reliable\")),a.addEventListener(\"message\",e=>this.onDataChannelMessage(e,\"janus-unreliable\")),await n,await u(i),await u(a),this.localMediaStream&&this.localMediaStream.getTracks().forEach(e=>{t.addTrack(e,this.localMediaStream)}),e.on(\"event\",e=>{var t=e.plugindata.data;\"join\"==t.event&&t.room_id==this.room?this.addOccupant(t.user_id):\"leave\"==t.event&&t.room_id==this.room?this.removeOccupant(t.user_id):\"blocked\"==t.event?document.body.dispatchEvent(new CustomEvent(\"blocked\",{detail:{clientId:t.by}})):\"unblocked\"==t.event?document.body.dispatchEvent(new CustomEvent(\"unblocked\",{detail:{clientId:t.by}})):\"data\"===t.event&&this.onData(JSON.parse(t.body),\"janus-event\")}),o(\"pub waiting for join\");var s=await this.sendJoin(e,{notifications:!0,data:!0});if(!s.plugindata.data.success){const e=s.plugindata.data.error;throw console.error(e),e}var c=s.plugindata.data.response.users[this.room]||[];return c.includes(this.clientId)&&(console.warn(\"Janus still has previous session for this client. Reconnecting in 10s.\"),this.performDelayedReconnect()),o(\"publisher ready\"),{handle:e,initialOccupants:c,reliableChannel:i,unreliableChannel:a,conn:t}}configurePublisherSdp(e){return e.sdp=e.sdp.replace(/a=fmtp:(109|111).*\\r\\n/g,(e,t)=>{const n=Object.assign(i.parseFmtp(e),l);return i.writeFmtp({payloadType:t,parameters:n})}),e}configureSubscriberSdp(e){return p||-1!==navigator.userAgent.indexOf(\"HeadlessChrome\")&&(e.sdp=e.sdp.replace(/m=video[^]*m=/,\"m=\")),-1===navigator.userAgent.indexOf(\"Android\")?e.sdp=e.sdp.replace(\"a=rtcp-fb:107 goog-remb\\r\\n\",\"a=rtcp-fb:107 goog-remb\\r\\na=rtcp-fb:107 transport-cc\\r\\na=fmtp:107 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\\r\\n\"):e.sdp=e.sdp.replace(\"a=rtcp-fb:107 goog-remb\\r\\n\",\"a=rtcp-fb:107 goog-remb\\r\\na=rtcp-fb:107 transport-cc\\r\\na=fmtp:107 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\\r\\n\"),e}async fixSafariIceUFrag(e){return e.sdp=e.sdp.replace(/[^\\r]\\na=ice-ufrag/g,\"\\r\\na=ice-ufrag\"),e}async createSubscriber(e){if(this.leftOccupants.has(e))return console.warn(e+\": cancelled occupant connection, occupant left before subscription negotation.\"),null;var t=new r.JanusPluginHandle(this.session),n=new RTCPeerConnection(this.peerConnectionConfig||h);if(o(e+\": sub waiting for sfu\"),await t.attach(\"janus.plugin.sfu\"),this.associate(n,t),o(e+\": sub waiting for join\"),this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancelled occupant connection, occupant left after attach\"),null;let i=!1;const a=new Promise(n=>{const r=setInterval(()=>{this.leftOccupants.has(e)&&(clearInterval(r),n())},1e3),o=setTimeout(()=>{clearInterval(r),i=!0,n()},c);t.on(\"webrtcup\",()=>{clearTimeout(o),clearInterval(r),n()})});await this.sendJoin(t,{media:e});if(this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancelled occupant connection, occupant left after join\"),null;if(o(e+\": sub waiting for webrtcup\"),await a,this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancel occupant connection, occupant left during or after webrtcup\"),null;if(i)return n.close(),console.warn(e+\": webrtc up timed out\"),null;s&&!this._iOSHackDelayedInitialPeer&&(await new Promise(e=>setTimeout(e,3e3)),this._iOSHackDelayedInitialPeer=!0);var d=new MediaStream;return n.getReceivers().forEach(e=>{e.track&&d.addTrack(e.track)}),0===d.getTracks().length&&(d=null),o(e+\": subscriber ready\"),{handle:t,mediaStream:d,conn:n}}sendJoin(e,t){return e.sendMessage({kind:\"join\",room_id:this.room,user_id:this.clientId,subscribe:t,token:this.joinToken})}toggleFreeze(){this.frozen?this.unfreeze():this.freeze()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1,this.flushPendingUpdates()}dataForUpdateMultiMessage(e,t){for(let n=0,r=t.data.d.length;n<r;n++){const r=t.data.d[n];if(r.networkId===e)return r}return null}getPendingData(e,t){if(!t)return null;let n=\"um\"===t.dataType?this.dataForUpdateMultiMessage(e,t):t.data;return n.owner&&!this.occupants[n.owner]?null:n.owner&&this.blockedClients.has(n.owner)?null:n}getPendingDataForNetworkId(e){return this.getPendingData(e,this.frozenUpdates.get(e))}flushPendingUpdates(){for(const[e,t]of this.frozenUpdates){let n=this.getPendingData(e,t);if(!n)continue;const r=\"um\"===t.dataType?\"u\":t.dataType;this.onOccupantMessage(null,r,n,t.source)}this.frozenUpdates.clear()}storeMessage(e){if(\"um\"===e.dataType)for(let t=0,n=e.data.d.length;t<n;t++)this.storeSingleMessage(e,t);else this.storeSingleMessage(e)}storeSingleMessage(e,t){const n=void 0!==t?e.data.d[t]:e.data,r=e.dataType,i=(e.source,n.networkId);if(this.frozenUpdates.has(i)){const t=this.frozenUpdates.get(i),o=\"um\"===t.dataType?this.dataForUpdateMultiMessage(i,t):t.data,a=n.lastOwnerTime<o.lastOwnerTime,s=n.lastOwnerTime===o.lastOwnerTime;if(a||s&&o.owner>n.owner)return;if(\"r\"===r){o&&o.isFirstSync?this.frozenUpdates.delete(i):this.frozenUpdates.set(i,e)}else o.components&&n.components&&Object.assign(o.components,n.components)}else this.frozenUpdates.set(i,e)}onDataChannelMessage(e,t){this.onData(JSON.parse(e.data),t)}onData(e,t){o.enabled&&o(`DC in: ${e}`),e.dataType&&(e.source=t,this.frozen?this.storeMessage(e):this.onOccupantMessage(null,e.dataType,e.data,e.source))}shouldStartConnectionTo(e){return!0}startStreamConnection(e){}closeStreamConnection(e){}getConnectStatus(e){return this.occupants[e]?NAF.adapters.IS_CONNECTED:NAF.adapters.NOT_CONNECTED}async updateTimeOffset(){if(this.isDisconnected())return;const e=Date.now(),t=await fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}),n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?(o(`new server time offset: ${this.avgTimeOffset}ms`),setTimeout(()=>this.updateTimeOffset(),3e5)):this.updateTimeOffset()}getServerTime(){return Date.now()+this.avgTimeOffset}getMediaStream(e,t=\"audio\"){if(this.mediaStreams[e])return o(`Already had ${t} for ${e}`),Promise.resolve(this.mediaStreams[e][t]);if(o(`Waiting on ${t} for ${e}`),!this.pendingMediaRequests.has(e)){this.pendingMediaRequests.set(e,{});const t=new Promise((t,n)=>{this.pendingMediaRequests.get(e).audio={resolve:t,reject:n}}),n=new Promise((t,n)=>{this.pendingMediaRequests.get(e).video={resolve:t,reject:n}});this.pendingMediaRequests.get(e).audio.promise=t,this.pendingMediaRequests.get(e).video.promise=n}return this.pendingMediaRequests.get(e)[t].promise}setMediaStream(e,t){const n=new MediaStream;t.getAudioTracks().forEach(e=>n.addTrack(e));const r=new MediaStream;t.getVideoTracks().forEach(e=>r.addTrack(e)),this.mediaStreams[e]={audio:n,video:r},this.pendingMediaRequests.has(e)&&(this.pendingMediaRequests.get(e).audio.resolve(n),this.pendingMediaRequests.get(e).video.resolve(r))}async setLocalMediaStream(e){if(this.publisher&&this.publisher.conn){const t=this.publisher.conn.getSenders(),n=[],r=e.getTracks();for(let i=0;i<r.length;i++){const o=r[i],a=t.find(e=>null!=e.track&&e.track.kind==o.kind);null!=a?(a.replaceTrack?(await a.replaceTrack(o),\"video\"===o.kind&&o.enabled&&navigator.userAgent.toLowerCase().indexOf(\"firefox\")>-1&&(o.enabled=!1,setTimeout(()=>o.enabled=!0,1e3))):(e.removeTrack(a.track),e.addTrack(o)),n.push(a)):n.push(this.publisher.conn.addTrack(o,e))}t.forEach(e=>{n.includes(e)||(e.track.enabled=!1)})}this.localMediaStream=e,this.setMediaStream(this.clientId,e)}enableMicrophone(e){this.publisher&&this.publisher.conn&&this.publisher.conn.getSenders().forEach(t=>{\"audio\"==t.track.kind&&(t.track.enabled=e)})}sendData(e,t,n){if(this.publisher)switch(this.unreliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:t,data:n}),whom:e});break;case\"datachannel\":this.publisher.unreliableChannel.send(JSON.stringify({clientId:e,dataType:t,data:n}));break;default:this.unreliableTransport(e,t,n)}else console.warn(\"sendData called without a publisher\")}sendDataGuaranteed(e,t,n){if(this.publisher)switch(this.reliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:t,data:n}),whom:e});break;case\"datachannel\":this.publisher.reliableChannel.send(JSON.stringify({clientId:e,dataType:t,data:n}));break;default:this.reliableTransport(e,t,n)}else console.warn(\"sendDataGuaranteed called without a publisher\")}broadcastData(e,t){if(this.publisher)switch(this.unreliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:e,data:t})});break;case\"datachannel\":this.publisher.unreliableChannel.send(JSON.stringify({dataType:e,data:t}));break;default:this.unreliableTransport(void 0,e,t)}else console.warn(\"broadcastData called without a publisher\")}broadcastDataGuaranteed(e,t){if(this.publisher)switch(this.reliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:e,data:t})});break;case\"datachannel\":this.publisher.reliableChannel.send(JSON.stringify({dataType:e,data:t}));break;default:this.reliableTransport(void 0,e,t)}else console.warn(\"broadcastDataGuaranteed called without a publisher\")}kick(e,t){return this.publisher.handle.sendMessage({kind:\"kick\",room_id:this.room,user_id:e,token:t}).then(()=>{document.body.dispatchEvent(new CustomEvent(\"kicked\",{detail:{clientId:e}}))})}block(e){return this.publisher.handle.sendMessage({kind:\"block\",whom:e}).then(()=>{this.blockedClients.set(e,!0),document.body.dispatchEvent(new CustomEvent(\"blocked\",{detail:{clientId:e}}))})}unblock(e){return this.publisher.handle.sendMessage({kind:\"unblock\",whom:e}).then(()=>{this.blockedClients.delete(e),document.body.dispatchEvent(new CustomEvent(\"unblocked\",{detail:{clientId:e}}))})}}NAF.adapters.register(\"janus\",m),e.exports=m},V8Jh:function(e,t,n){const r=n(\"BARu\"),i=n(\"jF9T\");class o{constructor(){this.adapters={socketio:i,webrtc:r},this.IS_CONNECTED=o.IS_CONNECTED,this.CONNECTING=o.CONNECTING,this.NOT_CONNECTED=o.NOT_CONNECTED}register(e,t){this.adapters[e]=t}make(e){var t=e.toLowerCase();if(this.adapters[t])return new(0,this.adapters[t]);throw\"easyrtc\"===t||\"wseasyrtc\"==t?new Error(\"Adapter: \"+e+\" not registered. EasyRTC support was removed in Networked-Aframe 0.7.0. To use the deprecated EasyRTC adapter see https://github.com/networked-aframe/naf-easyrtc-adapter\"):new Error(\"Adapter: \"+e+\" not registered. Please use NAF.adapters.register() to register this adapter.\")}}o.IS_CONNECTED=\"IS_CONNECTED\",o.CONNECTING=\"CONNECTING\",o.NOT_CONNECTED=\"NOT_CONNECTED\",e.exports=o},VKE9:function(e,t){function n(e){this.session=e,this.id=void 0}function r(e,t){this.output=e,this.id=void 0,this.nextTxId=0,this.txns={},this.eventHandlers={},this.options=Object.assign({verbose:!1,timeoutMs:1e4,keepaliveMs:3e4},t)}n.prototype.attach=function(e){var t={plugin:e,\"force-bundle\":!0,\"force-rtcp-mux\":!0};return this.session.send(\"attach\",t).then(e=>(this.id=e.data.id,e))},n.prototype.detach=function(){return this.send(\"detach\")},n.prototype.on=function(e,t){return this.session.on(e,e=>{e.sender==this.id&&t(e)})},n.prototype.send=function(e,t){return this.session.send(e,Object.assign({handle_id:this.id},t))},n.prototype.sendMessage=function(e){return this.send(\"message\",{body:e})},n.prototype.sendJsep=function(e){return this.send(\"message\",{body:{},jsep:e})},n.prototype.sendTrickle=function(e){return this.send(\"trickle\",{candidate:e})},r.prototype.create=function(){return this.send(\"create\").then(e=>(this.id=e.data.id,e))},r.prototype.destroy=function(){return this.send(\"destroy\").then(e=>(this.dispose(),e))},r.prototype.dispose=function(){for(var e in this._killKeepalive(),this.eventHandlers={},this.txns)if(this.txns.hasOwnProperty(e)){var t=this.txns[e];clearTimeout(t.timeout),t.reject(new Error(\"Janus session was disposed.\")),delete this.txns[e]}},r.prototype.isError=function(e){return\"error\"===e.janus},r.prototype.on=function(e,t){var n=this.eventHandlers[e];null==n&&(n=this.eventHandlers[e]=[]),n.push(t)},r.prototype.receive=function(e){this.options.verbose&&this._logIncoming(e),e.session_id!=this.id&&console.warn(\"Incorrect session ID received in Janus signalling message: was \"+e.session_id+\", expected \"+this.id+\".\");var t=e.janus,n=this.eventHandlers[t];if(null!=n)for(var r=0;r<n.length;r++)n[r](e);if(null!=e.transaction){var i=this.txns[e.transaction];if(null==i)return;if(\"ack\"===t&&\"message\"==i.type)return;clearTimeout(i.timeout),delete this.txns[e.transaction],(this.isError(e)?i.reject:i.resolve)(e)}},r.prototype.send=function(e,t){return t=Object.assign({transaction:(this.nextTxId++).toString()},t),new Promise((n,r)=>{var i=null;this.options.timeoutMs&&(i=setTimeout(()=>{delete this.txns[t.transaction],r(new Error(\"Signalling transaction with txid \"+t.transaction+\" timed out.\"))},this.options.timeoutMs)),this.txns[t.transaction]={resolve:n,reject:r,timeout:i,type:e},this._transmit(e,t)})},r.prototype._transmit=function(e,t){t=Object.assign({janus:e},t),null!=this.id&&(t=Object.assign({session_id:this.id},t)),this.options.verbose&&this._logOutgoing(t),this.output(JSON.stringify(t)),this._resetKeepalive()},r.prototype._logOutgoing=function(e){var t=e.janus;\"message\"===t&&e.jsep&&(t=e.jsep.type);var n=\"> Outgoing Janus \"+(t||\"signal\")+\" (#\"+e.transaction+\"): \";console.debug(\"%c\"+n,\"color: #040\",e)},r.prototype._logIncoming=function(e){var t=e.janus,n=e.transaction?\"< Incoming Janus \"+(t||\"signal\")+\" (#\"+e.transaction+\"): \":\"< Incoming Janus \"+(t||\"signal\")+\": \";console.debug(\"%c\"+n,\"color: #004\",e)},r.prototype._sendKeepalive=function(){return this.send(\"keepalive\")},r.prototype._killKeepalive=function(){clearTimeout(this.keepaliveTimeout)},r.prototype._resetKeepalive=function(){this._killKeepalive(),this.options.keepaliveMs&&(this.keepaliveTimeout=setTimeout(()=>{this._sendKeepalive().catch(e=>console.error(\"Error received from keepalive: \",e))},this.options.keepaliveMs))},e.exports={JanusPluginHandle:n,JanusSession:r}},WeY7:function(e,t,n){n(\"EYIQ\"),n(\"FJvS\"),n(\"xK6/\"),n(\"mxTd\")},XmTq:function(e,t,n){\"use strict\";e.exports=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:\"NotAllowedError\"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},ZTa3:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&r.deprecated(\"RTCIceServer.url\",\"RTCIceServer.urls\");var o=\"string\"===typeof i;return o&&(i=[i]),i=i.filter((function(e){return 0===e.indexOf(\"turn:\")&&-1!==e.indexOf(\"transport=udp\")&&-1===e.indexOf(\"turn:[\")&&!n?(n=!0,!0):0===e.indexOf(\"stun:\")&&t>=14393&&-1===e.indexOf(\"?transport=udp\")})),delete e.url,e.urls=o?i[0]:i,!!i.length}}))}},a6RD:function(e,t,n){\"use strict\";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=r(n(\"q1tI\")),o=r(n(\"2qu3\")),a=!1;function s(e,t){if(delete t.webpack,delete t.modules,!a)return e(t);var n=t.loading;return function(){return i.default.createElement(n,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}}t.noSSR=s,t.default=function(e,t){var n=o.default,r={loading:function(e){e.error,e.isLoading;return e.pastDelay,null}};if(e instanceof Promise?r.loader=function(){return e}:\"function\"===typeof e?r.loader=e:\"object\"===typeof e&&(r=Object.assign(Object.assign({},r),e)),r=Object.assign(Object.assign({},r),t),\"object\"===typeof e&&!(e instanceof Promise)&&(e.render&&(r.render=function(t,n){return e.render(n,t)}),e.modules)){n=o.default.Map;var i={},a=e.modules();Object.keys(a).forEach((function(e){var t=a[e];\"function\"!==typeof t.then?i[e]=t:i[e]=function(){return t.then((function(e){return e.default||e}))}})),r.loader=i}if(r.loadableGenerated&&delete(r=Object.assign(Object.assign({},r),r.loadableGenerated)).loadableGenerated,\"boolean\"===typeof r.ssr){if(!r.ssr)return delete r.ssr,s(n,r);delete r.ssr}return n(r)}},foSv:function(e,t,n){\"use strict\";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,\"a\",(function(){return r}))},ggQn:function(e,t,n){\"use strict\";var r=n(\"KCt4\"),i=n(\"lVut\");e.exports={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&\"foundation\"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if(\"object\"===typeof e&&e.candidate&&0===e.candidate.indexOf(\"a=\")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,\"icecandidate\",(function(t){return t.candidate&&Object.defineProperty(t,\"candidate\",{value:new e.RTCIceCandidate(t.candidate),writable:\"false\"}),t}))}},shimCreateObjectURL:function(e){var t=e&&e.URL;if(\"object\"===typeof e&&e.HTMLMediaElement&&\"srcObject\"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),r=t.revokeObjectURL.bind(t),o=new Map,a=0;t.createObjectURL=function(e){if(\"getTracks\"in e){var t=\"polyblob:\"+ ++a;return o.set(t,e),i.deprecated(\"URL.createObjectURL(stream)\",\"elem.srcObject = stream\"),t}return n(e)},t.revokeObjectURL=function(e){r(e),o.delete(e)};var s=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,\"src\");Object.defineProperty(e.HTMLMediaElement.prototype,\"src\",{get:function(){return s.get.apply(this)},set:function(e){return this.srcObject=o.get(e)||null,s.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&\"src\"===(\"\"+arguments[0]).toLowerCase()&&(this.srcObject=o.get(arguments[1])||null),c.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=i.detectBrowser(e);\"sctp\"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,\"sctp\",{get:function(){return\"undefined\"===typeof this._sctp?null:this._sctp}});var n=function(e){var t=r.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.parseMLine(e);return t&&\"application\"===t.kind&&-1!==t.protocol.indexOf(\"SCTP\")}))},o=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!==n?-1:n},a=function(e){var n=65536;return\"firefox\"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},s=function(e,n){var i=65536;\"firefox\"===t.browser&&57===t.version&&(i=65535);var o=r.matchPrefix(e.sdp,\"a=max-message-size:\");return o.length>0?i=parseInt(o[0].substr(19),10):\"firefox\"===t.browser&&-1!==n&&(i=2147483637),i},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(e._sctp=null,n(arguments[0])){var t,r=o(arguments[0]),i=a(r),d=s(arguments[0],r);t=0===i&&0===d?Number.POSITIVE_INFINITY:0===i||0===d?Math.max(i,d):Math.min(i,d);var u={};Object.defineProperty(u,\"maxMessageSize\",{get:function(){return t}}),e._sctp=u}return c.apply(e,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&\"createDataChannel\"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this,r=t.apply(e,arguments);return n(r,e),r},i.wrapPeerConnectionEvent(e,\"datachannel\",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if(\"open\"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError(\"Message too large (can send a maximum of \"+t.sctp.maxMessageSize+\" bytes)\");return n.apply(e,arguments)}}}}},goMv:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports={shimLocalStreamsAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection){if(\"getLocalStreams\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),\"getStreamById\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach((function(n){n.id===e&&(t=n)})),this._remoteStreams&&this._remoteStreams.forEach((function(n){n.id===e&&(t=n)})),t}),!(\"addStream\"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach((function(r){t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}\"removeStream\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,r=e.getTracks();this.getSenders().forEach((function(e){-1!==r.indexOf(e.track)&&n.removeTrack(e)}))}})}},shimRemoteStreamsAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&(\"getRemoteStreams\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!(\"onaddstream\"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,\"onaddstream\",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&this.removeEventListener(\"addstream\",this._onaddstream),this.addEventListener(\"addstream\",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener(\"track\",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event(\"addstream\");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},shimCallbacksAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty(\"urls\")&&a.hasOwnProperty(\"url\")?(r.deprecated(\"RTCIceServer.url\",\"RTCIceServer.urls\"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,\"generateCertificate\"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){\"object\"===typeof e&&e.RTCPeerConnection&&\"receiver\"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,\"transceiver\",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){\"undefined\"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=n.getTransceivers().find((function(e){return e.sender.track&&\"audio\"===e.sender.track.kind}));!1===e.offerToReceiveAudio&&r?\"sendrecv\"===r.direction?r.setDirection?r.setDirection(\"sendonly\"):r.direction=\"sendonly\":\"recvonly\"===r.direction&&(r.setDirection?r.setDirection(\"inactive\"):r.direction=\"inactive\"):!0!==e.offerToReceiveAudio||r||n.addTransceiver(\"audio\"),\"undefined\"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=n.getTransceivers().find((function(e){return e.sender.track&&\"video\"===e.sender.track.kind}));!1===e.offerToReceiveVideo&&i?\"sendrecv\"===i.direction?i.setDirection(\"sendonly\"):\"recvonly\"===i.direction&&i.setDirection(\"inactive\"):!0!==e.offerToReceiveVideo||i||n.addTransceiver(\"video\")}return t.apply(n,arguments)}}}},i2R6:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},iBZa:function(e,t){e.exports.whenEntityLoaded=function(e,t){e.hasLoaded&&t(),e.addEventListener(\"loaded\",(function(){t()}))},e.exports.createHtmlNodeFromString=function(e){var t=document.createElement(\"div\");return t.innerHTML=e,t.firstChild},e.exports.getCreator=function(e){var t=e.components;return t.networked?t.networked.data.creator:null},e.exports.getNetworkOwner=function(e){var t=e.components;return t.networked?t.networked.data.owner:null},e.exports.getNetworkId=function(e){var t=e.components;return t.networked?t.networked.data.networkId:null},e.exports.now=function(){return Date.now()},e.exports.createNetworkId=function(){return Math.random().toString(36).substring(2,9)},e.exports.getNetworkedEntity=function(e){return new Promise((t,n)=>{let r=e;for(;r&&r.components&&!r.components.networked;)r=r.parentNode;if(!r||!r.components||!r.components.networked)return n(\"Entity does not have and is not a child of an entity with the [networked] component \");r.hasLoaded?t(r):r.addEventListener(\"instantiated\",()=>{t(r)},{once:!0})})},e.exports.takeOwnership=function(e){let t=e;for(;t&&t.components&&!t.components.networked;)t=t.parentNode;if(!t||!t.components||!t.components.networked)throw new Error(\"Entity does not have and is not a child of an entity with the [networked] component \");return t.components.networked.takeOwnership()},e.exports.isMine=function(e){let t=e;for(;t&&t.components&&!t.components.networked;)t=t.parentNode;if(!t||!t.components||!t.components.networked)throw new Error(\"Entity does not have and is not a child of an entity with the [networked] component \");return t.components.networked.data.owner===NAF.clientId},e.exports.almostEqualVec3=function(e,t,n){return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n&&Math.abs(e.z-t.z)<n}},jF9T:function(e,t){e.exports=class{constructor(){void 0===io&&console.warn(\"It looks like socket.io has not been loaded before SocketioAdapter. Please do that.\"),this.app=\"default\",this.room=\"default\",this.occupantListener=null,this.myRoomJoinTime=null,this.myId=null,this.occupants={},this.connectedClients=[],this.serverTimeRequests=0,this.timeOffsets=[],this.avgTimeOffset=0}setServerUrl(e){this.wsUrl=e}setApp(e){this.app=e}setRoom(e){this.room=e}setWebRtcOptions(e){}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.occupantListener=e}setDataChannelListeners(e,t,n){this.openListener=e,this.closedListener=t,this.messageListener=n}connect(){const e=this;this.updateTimeOffset().then(()=>{e.wsUrl&&\"/\"!==e.wsUrl||(\"https:\"===location.protocol?e.wsUrl=\"wss://\"+location.host:e.wsUrl=\"ws://\"+location.host),NAF.log.write(\"Attempting to connect to socket.io\");const t=e.socket=io(e.wsUrl);function n(t){const n=t.from,r=t.type,i=t.data;e.messageListener(n,r,i)}t.on(\"connect\",()=>{NAF.log.write(\"User connected\",t.id),e.myId=t.id,e.joinRoom()}),t.on(\"connectSuccess\",t=>{const{joinedTime:n}=t;e.myRoomJoinTime=n,NAF.log.write(\"Successfully joined room\",e.room,\"at server time\",n),e.connectSuccess(e.myId)}),t.on(\"error\",t=>{console.error(\"Socket connection failure\",t),e.connectFailure()}),t.on(\"occupantsChanged\",t=>{const{occupants:n}=t;NAF.log.write(\"occupants changed\",t),e.receivedOccupants(n)}),t.on(\"send\",n),t.on(\"broadcast\",n)})}joinRoom(){NAF.log.write(\"Joining room\",this.room),this.socket.emit(\"joinRoom\",{room:this.room})}receivedOccupants(e){delete e[this.myId],this.occupants=e,this.occupantListener(e)}shouldStartConnectionTo(e){return!0}startStreamConnection(e){this.connectedClients.push(e),this.openListener(e)}closeStreamConnection(e){this.connectedClients=this.connectedClients.filter(t=>t!=e),this.closedListener(e)}getConnectStatus(e){return-1!=this.connectedClients.indexOf(e)?NAF.adapters.IS_CONNECTED:NAF.adapters.NOT_CONNECTED}sendData(e,t,n){this.sendDataGuaranteed(e,t,n)}sendDataGuaranteed(e,t,n){const r={from:this.myId,to:e,type:t,data:n,sending:!0};this.socket?this.socket.emit(\"send\",r):NAF.log.warn(\"SocketIO socket not created yet\")}broadcastData(e,t){this.broadcastDataGuaranteed(e,t)}broadcastDataGuaranteed(e,t){const n={from:this.myId,type:e,data:t,broadcasting:!0};this.socket?this.socket.emit(\"broadcast\",n):NAF.log.warn(\"SocketIO socket not created yet\")}getMediaStream(e){}updateTimeOffset(){const e=Date.now()+this.avgTimeOffset;return fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}).then(t=>{var n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?setTimeout(()=>this.updateTimeOffset(),3e5):this.updateTimeOffset()})}getServerTime(){return new Date+this.avgTimeOffset}}},jwwS:function(e,t,n){\"use strict\";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,\"__esModule\",{value:!0});var i=r(n(\"q1tI\"));t.LoadableContext=i.createContext(null)},lVut:function(e,t,n){\"use strict\";var r=!0,i=!0;function o(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}e.exports={extractVersion:o,wrapPeerConnectionEvent:function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,\"on\"+t,{get:function(){return this[\"_on\"+t]},set:function(e){this[\"_on\"+t]&&(this.removeEventListener(t,this[\"_on\"+t]),delete this[\"_on\"+t]),e&&this.addEventListener(t,this[\"_on\"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return\"boolean\"!==typeof e?new Error(\"Argument type: \"+typeof e+\". Please use a boolean.\"):(r=e,e?\"adapter.js logging disabled\":\"adapter.js logging enabled\")},disableWarnings:function(e){return\"boolean\"!==typeof e?new Error(\"Argument type: \"+typeof e+\". Please use a boolean.\"):(i=!e,\"adapter.js deprecation warnings \"+(e?\"disabled\":\"enabled\"))},log:function(){if(\"object\"===typeof window){if(r)return;\"undefined\"!==typeof console&&\"function\"===typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){i&&console.warn(e+\" is deprecated, please use \"+t+\" instead.\")},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(\"undefined\"===typeof e||!e.navigator)return n.browser=\"Not a browser.\",n;if(t.mozGetUserMedia)n.browser=\"firefox\",n.version=o(t.userAgent,/Firefox\\/(\\d+)\\./,1);else if(t.webkitGetUserMedia)n.browser=\"chrome\",n.version=o(t.userAgent,/Chrom(e|ium)\\/(\\d+)\\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\\/(\\d+).(\\d+)$/))n.browser=\"edge\",n.version=o(t.userAgent,/Edge\\/(\\d+).(\\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\\/(\\d+)\\./))return n.browser=\"Not a supported browser.\",n;n.browser=\"safari\",n.version=o(t.userAgent,/AppleWebKit\\/(\\d+)\\./,1)}return n}}},m0Qv:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/scene\",function(){return n(\"5YFB\")}])},md7G:function(e,t,n){\"use strict\";function r(e){return(r=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}n.d(t,\"a\",(function(){return o}));var i=n(\"JX7q\");function o(e,t){return!t||\"object\"!==r(t)&&\"function\"!==typeof t?Object(i.a)(e):t}},mqsc:function(e,t){e.exports=class{constructor(){this.debug=!1}setDebug(e){this.debug=e}write(){this.debug&&console.log.apply(this,arguments)}warn(){console.warn.apply(this,arguments)}error(){console.error.apply(this,arguments)}}},mxTd:function(e,t,n){var r=n(\"EYIQ\");AFRAME.registerComponent(\"networked-audio-source\",{schema:{positional:{default:!0},distanceModel:{default:\"inverse\",oneOf:[\"linear\",\"inverse\",\"exponential\"]},maxDistance:{default:1e4},refDistance:{default:1},rolloffFactor:{default:1}},init:function(){this.listener=null,this.stream=null,this._setMediaStream=this._setMediaStream.bind(this),NAF.utils.getNetworkedEntity(this.el).then(e=>{const t=e.components.networked.data.owner;t&&NAF.connection.adapter.getMediaStream(t).then(this._setMediaStream).catch(e=>r.log.error(`Error getting media stream for ${t}`,e))})},update(){this._setPannerProperties()},_setMediaStream(e){if(this.sound||this.setupSound(),e!=this.stream){if(this.stream&&this.sound.disconnect(),e){/chrome/i.test(navigator.userAgent)&&(this.audioEl=new Audio,this.audioEl.setAttribute(\"autoplay\",\"autoplay\"),this.audioEl.setAttribute(\"playsinline\",\"playsinline\"),this.audioEl.srcObject=e,this.audioEl.volume=0);const t=this.sound.context.createMediaStreamSource(e);this.sound.setNodeSource(t),this.el.emit(\"sound-source-set\",{soundSource:t})}this.stream=e}},_setPannerProperties(){this.sound&&this.data.positional&&(this.sound.setDistanceModel(this.data.distanceModel),this.sound.setMaxDistance(this.data.maxDistance),this.sound.setRefDistance(this.data.refDistance),this.sound.setRolloffFactor(this.data.rolloffFactor))},remove:function(){this.sound&&(this.el.removeObject3D(this.attrName),this.stream&&this.sound.disconnect())},setupSound:function(){var e=this.el,t=e.sceneEl;this.sound&&e.removeObject3D(this.attrName),t.audioListener||(t.audioListener=new THREE.AudioListener,t.camera&&t.camera.add(t.audioListener),t.addEventListener(\"camera-set-active\",(function(e){e.detail.cameraEl.getObject3D(\"camera\").add(t.audioListener)}))),this.listener=t.audioListener,this.sound=this.data.positional?new THREE.PositionalAudio(this.listener):new THREE.Audio(this.listener),e.setObject3D(this.attrName,this.sound),this._setPannerProperties()}})},ozXo:function(e,t){e.exports=class{constructor(){this.dict={}}addChild(e,t){this.hasParent(e)||(this.dict[e]=[]),this.dict[e].push(t)}getChildren(e){if(!this.hasParent(e))return[];var t=this.dict[e];return delete this.dict[e],t}hasParent(e){return!!this.dict[e]}}},pXin:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;e.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack,a=function(e){return{name:{InternalError:\"NotReadableError\",NotSupportedError:\"TypeError\",PermissionDeniedError:\"NotAllowedError\",SecurityError:\"NotAllowedError\"}[e.name]||e.name,message:{\"The operation is insecure.\":\"The request is not allowed by the user agent or the platform in the current context.\"}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&\": \")+this.message}}},s=function(e,r,o){var s=function(e){if(\"object\"!==typeof e||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if(\"require\"!==n&&\"advanced\"!==n&&\"mediaSource\"!==n){var r=e[n]=\"object\"===typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&(\"number\"===typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};\"number\"===typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(i(\"spec: \"+JSON.stringify(e)),e.audio&&(e.audio=s(e.audio)),e.video&&(e.video=s(e.video)),i(\"ff37: \"+JSON.stringify(e))),n.mozGetUserMedia(e,r,(function(e){o(a(e))}))};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(e){return new Promise((function(t,n){s(e,t,n)}))},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise((function(e){e([{kind:\"audioinput\",deviceId:\"default\",label:\"\",groupId:\"\"},{kind:\"videoinput\",deviceId:\"default\",label:\"\",groupId:\"\"}])}))},t.version<41){var c=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return c().then(void 0,(function(e){if(\"NotFoundError\"===e.name)return[];throw e}))}}if(t.version<49){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException(\"The object can not be found here.\",\"NotFoundError\");return t}),(function(e){return Promise.reject(a(e))}))}}if(!(t.version>55&&\"autoGainControl\"in n.mediaDevices.getSupportedConstraints())){var u=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},p=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return\"object\"===typeof e&&\"object\"===typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),u(e.audio,\"autoGainControl\",\"mozAutoGainControl\"),u(e.audio,\"noiseSuppression\",\"mozNoiseSuppression\")),p(e)},o&&o.prototype.getSettings){var l=o.prototype.getSettings;o.prototype.getSettings=function(){var e=l.apply(this,arguments);return u(e,\"mozAutoGainControl\",\"autoGainControl\"),u(e,\"mozNoiseSuppression\",\"noiseSuppression\"),e}}if(o&&o.prototype.applyConstraints){var h=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return\"audio\"===this.kind&&\"object\"===typeof e&&(e=JSON.parse(JSON.stringify(e)),u(e,\"autoGainControl\",\"mozAutoGainControl\"),u(e,\"noiseSuppression\",\"mozNoiseSuppression\")),h.apply(this,[e])}}}n.getUserMedia=function(e,i,o){if(t.version<44)return s(e,i,o);r.deprecated(\"navigator.getUserMedia\",\"navigator.mediaDevices.getUserMedia\"),n.mediaDevices.getUserMedia(e).then(i,o)}}},sJPo:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=n(\"ZTa3\"),o=n(\"8D0k\");e.exports={shimGetUserMedia:n(\"XmTq\"),shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,\"enabled\");Object.defineProperty(e.MediaStreamTrack.prototype,\"enabled\",{set:function(e){n.set.call(this,e);var t=new Event(\"enabled\");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||\"dtmf\"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,\"dtmf\",{get:function(){return void 0===this._dtmf&&(\"audio\"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):\"video\"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=o(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=i(e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||\"replaceTrack\"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(e,t){if(\"getDisplayMedia\"in e.navigator&&e.navigator.mediaDevices&&!(\"getDisplayMedia\"in e.navigator.mediaDevices)){var n=e.navigator.getDisplayMedia;e.navigator.mediaDevices.getDisplayMedia=function(t){return n.call(e.navigator,t)},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),n.call(e.navigator,t)}}}}},tvSW:function(e,t){e.exports={debug:!1,updateRate:15,useLerp:!0,firstSyncSource:null,syncSource:null}},umSQ:function(e,t){e.exports=class{constructor(){this.schemaDict={},this.templateCache={}}createDefaultSchema(e){return{template:e,components:[\"position\",\"rotation\"]}}add(e){if(this.validateSchema(e)){this.schemaDict[e.template]=e;var t=document.querySelector(e.template);if(!t)return void NAF.log.error(`Template el not found for ${e.template}, make sure NAF.schemas.add is called after <a-scene> is defined.`);if(!this.validateTemplate(e,t))return;this.templateCache[e.template]=document.importNode(t.content,!0)}else NAF.log.error(\"Schema not valid: \",e),NAF.log.error(\"See https://github.com/haydenjameslee/networked-aframe#syncing-custom-components\")}getCachedTemplate(e){return this.templateIsCached(e)||(this.templateExistsInScene(e)?this.add(this.createDefaultSchema(e)):NAF.log.error(`Template el for ${e} is not in the scene, add the template to <a-assets> and register with NAF.schemas.add.`)),this.templateCache[e].firstElementChild.cloneNode(!0)}templateIsCached(e){return!!this.templateCache[e]}getComponents(e){var t=[\"position\",\"rotation\"];return this.hasTemplate(e)&&(t=this.schemaDict[e].components),t}hasTemplate(e){return!!this.schemaDict[e]}templateExistsInScene(e){var t=document.querySelector(e);return t&&this.isTemplateTag(t)}validateSchema(e){return!(!e.template||!e.components)}validateTemplate(e,t){return this.isTemplateTag(t)?!!this.templateHasOneOrZeroChildren(t)||(NAF.log.error(`Template for ${e.template} has more than one child. Templates must have one direct child element, no more. Template found:`,t),!1):(NAF.log.error(`Template for ${e.template} is not a <template> tag. Instead found: ${t.tagName}`),!1)}isTemplateTag(e){return\"template\"===e.tagName.toLowerCase()}templateHasOneOrZeroChildren(e){return e.content.childElementCount<2}remove(e){delete this.schemaDict[e]}clear(){this.schemaDict={}}}},vPXE:function(e,t,n){\"use strict\";(function(r){function i(e){return(i=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}t.log=function(){var e;return\"object\"===(\"undefined\"===typeof console?\"undefined\":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?\"%c\":\"\")+this.namespace+(this.useColors?\" %c\":\" \")+t[0]+(this.useColors?\"%c \":\" \")+\"+\"+e.exports.humanize(this.diff),!this.useColors)return;var n=\"color: \"+this.color;t.splice(1,0,n,\"color: inherit\");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){\"%%\"!==e&&(r++,\"%c\"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem(\"debug\",e):t.storage.removeItem(\"debug\")}catch(n){}},t.load=function(){var e;try{e=t.storage.getItem(\"debug\")}catch(n){}!e&&\"undefined\"!==typeof r&&\"env\"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if(\"undefined\"!==typeof window&&window.process&&(\"renderer\"===window.process.type||window.process.__nwjs))return!0;if(\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/))return!1;return\"undefined\"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||\"undefined\"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&parseInt(RegExp.$1,10)>=31||\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=[\"#0000CC\",\"#0000FF\",\"#0033CC\",\"#0033FF\",\"#0066CC\",\"#0066FF\",\"#0099CC\",\"#0099FF\",\"#00CC00\",\"#00CC33\",\"#00CC66\",\"#00CC99\",\"#00CCCC\",\"#00CCFF\",\"#3300CC\",\"#3300FF\",\"#3333CC\",\"#3333FF\",\"#3366CC\",\"#3366FF\",\"#3399CC\",\"#3399FF\",\"#33CC00\",\"#33CC33\",\"#33CC66\",\"#33CC99\",\"#33CCCC\",\"#33CCFF\",\"#6600CC\",\"#6600FF\",\"#6633CC\",\"#6633FF\",\"#66CC00\",\"#66CC33\",\"#9900CC\",\"#9900FF\",\"#9933CC\",\"#9933FF\",\"#99CC00\",\"#99CC33\",\"#CC0000\",\"#CC0033\",\"#CC0066\",\"#CC0099\",\"#CC00CC\",\"#CC00FF\",\"#CC3300\",\"#CC3333\",\"#CC3366\",\"#CC3399\",\"#CC33CC\",\"#CC33FF\",\"#CC6600\",\"#CC6633\",\"#CC9900\",\"#CC9933\",\"#CCCC00\",\"#CCCC33\",\"#FF0000\",\"#FF0033\",\"#FF0066\",\"#FF0099\",\"#FF00CC\",\"#FF00FF\",\"#FF3300\",\"#FF3333\",\"#FF3366\",\"#FF3399\",\"#FF33CC\",\"#FF33FF\",\"#FF6600\",\"#FF6633\",\"#FF9900\",\"#FF9933\",\"#FFCC00\",\"#FFCC33\"],e.exports=n(\"7dnI\")(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return\"[UnexpectedJSONParseError]: \"+t.message}}}).call(this,n(\"8oxB\"))},vuIU:function(e,t,n){\"use strict\";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,\"a\",(function(){return i}))},vwHn:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;e.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=function(e){if(\"object\"!==typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if(\"require\"!==n&&\"advanced\"!==n&&\"mediaSource\"!==n){var r=\"object\"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&\"number\"===typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):\"deviceId\"===t?\"sourceId\":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};\"number\"===typeof r.ideal?(o[i(\"min\",n)]=r.ideal,t.optional.push(o),(o={})[i(\"max\",n)]=r.ideal,t.optional.push(o)):(o[i(\"\",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&\"number\"!==typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i(\"\",n)]=r.exact):[\"min\",\"max\"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&\"object\"===typeof e.audio){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,\"autoGainControl\",\"googAutoGainControl\"),a(e.audio,\"noiseSuppression\",\"googNoiseSuppression\"),e.audio=o(e.audio)}if(e&&\"object\"===typeof e.video){var s=e.video.facingMode;s=s&&(\"object\"===typeof s?s:{ideal:s});var c,d=t.version<66;if(s&&(\"user\"===s.exact||\"environment\"===s.exact||\"user\"===s.ideal||\"environment\"===s.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||d))if(delete e.video.facingMode,\"environment\"===s.exact||\"environment\"===s.ideal?c=[\"back\",\"rear\"]:\"user\"!==s.exact&&\"user\"!==s.ideal||(c=[\"front\"]),c)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return\"videoinput\"===e.kind}))).find((function(e){return c.some((function(t){return-1!==e.label.toLowerCase().indexOf(t)}))}));return!n&&t.length&&-1!==c.indexOf(\"back\")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=o(e.video),i(\"chrome: \"+JSON.stringify(e)),r(e)}));e.video=o(e.video)}return i(\"chrome: \"+JSON.stringify(e)),r(e)},s=function(e){return t.version>=64?e:{name:{PermissionDeniedError:\"NotAllowedError\",PermissionDismissedError:\"NotAllowedError\",InvalidStateError:\"NotAllowedError\",DevicesNotFoundError:\"NotFoundError\",ConstraintNotSatisfiedError:\"OverconstrainedError\",TrackStartError:\"NotReadableError\",MediaDeviceFailedDueToShutdown:\"NotAllowedError\",MediaDeviceKillSwitchOn:\"NotAllowedError\",TabCaptureError:\"AbortError\",ScreenCaptureError:\"AbortError\",DeviceCaptureError:\"AbortError\"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&\": \")+this.message}}};n.getUserMedia=function(e,t,r){a(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(s(e))}))}))};var c=function(e){return new Promise((function(t,r){n.getUserMedia(e,t,r)}))};if(n.mediaDevices||(n.mediaDevices={getUserMedia:c,enumerateDevices:function(){return new Promise((function(t){var n={audio:\"audioinput\",video:\"videoinput\"};return e.MediaStreamTrack.getSources((function(e){t(e.map((function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:\"\"}})))}))}))},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return a(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException(\"\",\"NotFoundError\");return t}),(function(e){return Promise.reject(s(e))}))}))}}else n.mediaDevices.getUserMedia=function(e){return c(e)};\"undefined\"===typeof n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){i(\"Dummy mediaDevices.addEventListener called.\")}),\"undefined\"===typeof n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){i(\"Dummy mediaDevices.removeEventListener called.\")})}},\"xK6/\":function(e,t,n){var r=n(\"zs+I\"),i=n(\"+nhR\"),o=THREE.Math.DEG2RAD,a=[\"position\",\"rotation\",\"scale\"];AFRAME.registerSystem(\"networked\",{init(){this.components=[],this.nextSyncTime=0},register(e){this.components.push(e)},deregister(e){const t=this.components.indexOf(e);t>-1&&this.components.splice(t,1)},tick:function(){if(!NAF.connection.adapter)return;if(this.el.clock.elapsedTime<this.nextSyncTime)return;const e={d:[]};for(let t=0,n=this.components.length;t<n;t++){const n=this.components[t];if(!n.isMine())continue;if(!n.el.parentElement)return void NAF.log.error(\"entity registered with system despite being removed\");const r=this.components[t].syncDirty();r&&e.d.push(r)}e.d.length>0&&NAF.connection.broadcastData(\"um\",e),this.updateNextSyncTime()},updateNextSyncTime(){this.nextSyncTime=this.el.clock.elapsedTime+1/NAF.options.updateRate}}),AFRAME.registerComponent(\"networked\",{schema:{template:{default:\"\"},attachTemplateToLocal:{default:!0},persistent:{default:!1},networkId:{default:\"\"},owner:{default:\"\"},creator:{default:\"\"}},init:function(){this.OWNERSHIP_GAINED=\"ownership-gained\",this.OWNERSHIP_CHANGED=\"ownership-changed\",this.OWNERSHIP_LOST=\"ownership-lost\",this.onOwnershipGainedEvent={el:this.el},this.onOwnershipChangedEvent={el:this.el},this.onOwnershipLostEvent={el:this.el},this.conversionEuler=new THREE.Euler,this.conversionEuler.order=\"YXZ\",this.bufferInfos=[],this.bufferPosition=new THREE.Vector3,this.bufferQuaternion=new THREE.Quaternion,this.bufferScale=new THREE.Vector3;var e=this.wasCreatedByNetwork();this.onConnected=this.onConnected.bind(this),this.syncData={},this.componentSchemas=NAF.schemas.getComponents(this.data.template),this.cachedElements=new Array(this.componentSchemas.length),this.networkUpdatePredicates=this.componentSchemas.map(e=>e.requiresNetworkUpdate&&e.requiresNetworkUpdate()||function(){let e=null;return t=>(null===e||!r(e,t))&&(e=AFRAME.utils.clone(t),!0)}()),this.invalidateCachedElements(),this.initNetworkParent(),\"\"===this.data.networkId&&this.el.setAttribute(this.name,{networkId:NAF.utils.createNetworkId()}),e?this.firstUpdate():(this.data.attachTemplateToLocal&&this.attachTemplateToLocal(),this.registerEntity(this.data.networkId)),this.lastOwnerTime=-1,NAF.clientId?this.onConnected():document.body.addEventListener(\"connected\",this.onConnected,!1),document.body.dispatchEvent(this.entityCreatedEvent()),this.el.dispatchEvent(new CustomEvent(\"instantiated\",{detail:{el:this.el}})),this.el.sceneEl.systems.networked.register(this)},attachTemplateToLocal:function(){const e=NAF.schemas.getCachedTemplate(this.data.template),t=e.attributes;for(let n=0;n<t.length;n++)this.el.setAttribute(t[n].name,t[n].value);for(;e.firstElementChild;)this.el.appendChild(e.firstElementChild)},takeOwnership:function(){const e=this.data.owner,t=this.lastOwnerTime,n=NAF.connection.getServerTime();return!!(e&&!this.isMine()&&t<n)&&(this.lastOwnerTime=n,this.removeLerp(),this.el.setAttribute(\"networked\",{owner:NAF.clientId}),this.syncAll(),this.onOwnershipGainedEvent.oldOwner=e,this.el.emit(this.OWNERSHIP_GAINED,this.onOwnershipGainedEvent),this.onOwnershipChangedEvent.oldOwner=e,this.onOwnershipChangedEvent.newOwner=NAF.clientId,this.el.emit(this.OWNERSHIP_CHANGED,this.onOwnershipChangedEvent),!0)},wasCreatedByNetwork:function(){return!!this.el.firstUpdateData},initNetworkParent:function(){var e=this.el.parentElement;e.components&&e.components.networked?this.parent=e:this.parent=null},registerEntity:function(e){NAF.entities.registerEntity(e,this.el)},applyPersistentFirstSync:function(){const{networkId:e}=this.data,t=NAF.entities.getPersistentFirstSync(e);t&&(this.networkUpdate(t),NAF.entities.forgetPersistentFirstSync(e))},firstUpdate:function(){var e=this.el.firstUpdateData;this.networkUpdate(e)},onConnected:function(){\"\"===this.data.owner&&(this.lastOwnerTime=NAF.connection.getServerTime(),this.el.setAttribute(this.name,{owner:NAF.clientId,creator:NAF.clientId}),setTimeout(()=>{this.el.parentNode?this.syncAll(void 0,!0):NAF.log.warn(\"Networked element was removed before ever getting the chance to syncAll\")},0)),document.body.removeEventListener(\"connected\",this.onConnected,!1)},isMine:function(){return this.data.owner===NAF.clientId},createdByMe:function(){return this.data.creator===NAF.clientId},tick:function(e,t){if(!this.isMine()&&NAF.options.useLerp)for(var n=0;n<this.bufferInfos.length;n++){var r=this.bufferInfos[n],i=r.buffer,o=r.object3D,a=r.componentNames;i.update(t),a.includes(\"position\")&&o.position.copy(i.getPosition()),a.includes(\"rotation\")&&o.quaternion.copy(i.getQuaternion()),a.includes(\"scale\")&&o.scale.copy(i.getScale())}},syncAll:function(e,t){if(this.canSync()){var n=this.gatherComponentsData(!0),r=this.createSyncData(n,t);e?NAF.connection.sendDataGuaranteed(e,\"u\",r):NAF.connection.broadcastDataGuaranteed(\"u\",r)}},syncDirty:function(){if(this.canSync()){var e=this.gatherComponentsData(!1);if(null!==e)return this.createSyncData(e)}},getCachedElement(e){var t=this.cachedElements[e];if(t)return t;var n=this.componentSchemas[e];return n.selector?this.cachedElements[e]=this.el.querySelector(n.selector):this.cachedElements[e]=this.el},invalidateCachedElements(){for(var e=0;e<this.cachedElements.length;e++)this.cachedElements[e]=null},gatherComponentsData:function(e){for(var t=null,n=0;n<this.componentSchemas.length;n++){var r=this.componentSchemas[n],i=this.getCachedElement(n);if(i){var o=r.component?r.component:r,a=i.getAttribute(o);if(null!==a){var s=r.property?a[r.property]:a;(this.networkUpdatePredicates[n](s)||e)&&((t=t||{})[n]=s)}else e&&((t=t||{})[n]=null)}else e&&((t=t||{})[n]=null)}return t},createSyncData:function(e,t){var{syncData:n,data:r}=this;return n.networkId=r.networkId,n.owner=r.owner,n.creator=r.creator,n.lastOwnerTime=this.lastOwnerTime,n.template=r.template,n.persistent=r.persistent,n.parent=this.getParentId(),n.components=e,n.isFirstSync=!!t,n},canSync:function(){if(this.data.owner&&this.isMine())return!0;if(!this.createdByMe())return!1;const e=NAF.connection.getConnectedClients();for(let t in e)if(t===this.data.owner)return!1;return!0},getParentId:function(){return this.initNetworkParent(),this.parent?this.parent.getAttribute(\"networked\").networkId:null},networkUpdate:function(e){if(!(e.lastOwnerTime<this.lastOwnerTime||this.lastOwnerTime===e.lastOwnerTime&&this.data.owner>e.owner)){if(this.data.owner!==e.owner){var t=this.isMine();this.lastOwnerTime=e.lastOwnerTime;const n=this.data.owner,r=e.owner;this.el.setAttribute(\"networked\",{owner:e.owner}),t&&(this.onOwnershipLostEvent.newOwner=r,this.el.emit(this.OWNERSHIP_LOST,this.onOwnershipLostEvent)),this.onOwnershipChangedEvent.oldOwner=n,this.onOwnershipChangedEvent.newOwner=r,this.el.emit(this.OWNERSHIP_CHANGED,this.onOwnershipChangedEvent)}this.data.persistent!==e.persistent&&this.el.setAttribute(\"networked\",{persistent:e.persistent}),this.updateNetworkedComponents(e.components)}},updateNetworkedComponents:function(e){for(var t=0,n=this.componentSchemas.length;t<n;t++){var r=e[t],i=this.componentSchemas[t],o=this.getCachedElement(t);null!==o&&null!==r&&void 0!==r&&(i.component?i.property?this.updateNetworkedComponent(o,i.component,i.property,r):this.updateNetworkedComponent(o,i.component,r):this.updateNetworkedComponent(o,i,r))}},updateNetworkedComponent:function(e,t,n,r){if(!NAF.options.useLerp||!a.includes(t))return void(void 0===r?e.setAttribute(t,n):e.setAttribute(t,n,r));let s;for(let i=0,o=this.bufferInfos.length;i<o;i++){const t=this.bufferInfos[i];if(t.object3D===e.object3D){s=t;break}}if(s){var c=s.componentNames;c.includes(t)||c.push(t)}else s={buffer:new i(i.MODE_LERP,.1),object3D:e.object3D,componentNames:[t]},this.bufferInfos.push(s);var d=s.buffer;switch(t){case\"position\":return void d.setPosition(this.bufferPosition.set(n.x,n.y,n.z));case\"rotation\":return this.conversionEuler.set(o*n.x,o*n.y,o*n.z),void d.setQuaternion(this.bufferQuaternion.setFromEuler(this.conversionEuler));case\"scale\":return void d.setScale(this.bufferScale.set(n.x,n.y,n.z))}NAF.log.error(\"Could not set value in interpolation buffer.\",e,t,n,s)},removeLerp:function(){this.bufferInfos=[]},remove:function(){if(this.isMine()&&NAF.connection.isConnected()){var e={networkId:this.data.networkId};NAF.entities.hasEntity(this.data.networkId)?NAF.connection.broadcastDataGuaranteed(\"r\",e):NAF.log.error(\"Removing networked entity that is not in entities array.\")}NAF.entities.forgetEntity(this.data.networkId),document.body.dispatchEvent(this.entityRemovedEvent(this.data.networkId)),this.el.sceneEl.systems.networked.deregister(this)},entityCreatedEvent(){return new CustomEvent(\"entityCreated\",{detail:{el:this.el}})},entityRemovedEvent:e=>new CustomEvent(\"entityRemoved\",{detail:{networkId:e}})})},yLpj:function(e,t){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(r){\"object\"===typeof window&&(n=window)}e.exports=n},\"zs+I\":function(e,t,n){\"use strict\";var r=Array.isArray,i=Object.keys,o=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&\"object\"==typeof t&&\"object\"==typeof n){var a,s,c,d=r(t),u=r(n);if(d&&u){if((s=t.length)!=n.length)return!1;for(a=s;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(d!=u)return!1;var p=t instanceof Date,l=n instanceof Date;if(p!=l)return!1;if(p&&l)return t.getTime()==n.getTime();var h=t instanceof RegExp,f=n instanceof RegExp;if(h!=f)return!1;if(h&&f)return t.toString()==n.toString();var m=i(t);if((s=m.length)!==i(n).length)return!1;for(a=s;0!==a--;)if(!o.call(n,m[a]))return!1;for(a=s;0!==a--;)if(!e(t[c=m[a]],n[c]))return!1;return!0}return t!==t&&n!==n}}},[[\"m0Qv\",0,1,4]]]);"}