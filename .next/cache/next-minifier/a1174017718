{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{\"+phH\":function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;function a(e,t,n){var r=n?\"outbound-rtp\":\"inbound-rtp\",i=new Map;if(null===t)return i;var a=[];return e.forEach((function(e){\"track\"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach((function(i){i.endsWith(\"Id\")?e(t,t.get(n[i]),r):i.endsWith(\"Ids\")&&n[i].forEach((function(n){e(t,t.get(n),r)}))})))}(e,n,i)}))})),i}e.exports={shimGetUserMedia:n(\"vwHn\"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if(\"object\"!==typeof e||!e.RTCPeerConnection||\"ontrack\"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.transceiver||Object.defineProperty(e,\"transceiver\",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,\"ontrack\",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener(\"track\",this._ontrack),this.addEventListener(\"track\",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener(\"addtrack\",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var a=new Event(\"track\");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var a=new Event(\"track\");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)}))},n.addEventListener(\"addstream\",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&!(\"getSenders\"in e.RTCPeerConnection.prototype)&&\"createDTMFSender\"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(\"audio\"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=this,a=n.apply(i,arguments);return a||(a=t(i,e),i._senders.push(a)),a};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;r.apply(t,arguments);var n=t._senders.indexOf(e);-1!==n&&t._senders.splice(n,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],i.apply(n,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],a.apply(t,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if(\"object\"===typeof e&&e.RTCPeerConnection&&\"getSenders\"in e.RTCPeerConnection.prototype&&\"createDTMFSender\"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!(\"dtmf\"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(e,[]);return t.forEach((function(t){t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,\"dtmf\",{get:function(){return void 0===this._dtmf&&(\"audio\"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!(\"getStats\"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a(t,e.track,!0)}))}}if(!(\"getStats\"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(e,[]);return t.forEach((function(t){t._pc=e})),t}),r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return a(t,e.track,!1)}))}}if(\"getStats\"in e.RTCRtpSender.prototype&&\"getStats\"in e.RTCRtpReceiver.prototype){var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var t=this;if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var n,r,i,a=arguments[0];return t.getSenders().forEach((function(e){e.track===a&&(n?i=!0:n=e)})),t.getReceivers().forEach((function(e){return e.track===a&&(r?i=!0:r=e),e.track===a})),i||n&&r?Promise.reject(new DOMException(\"There are more than one sender or receiver for the track.\",\"InvalidAccessError\")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException(\"There is no sender or receiver for the track.\",\"InvalidAccessError\"))}return s.apply(t,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;\"object\"===typeof e&&(!e.HTMLMediaElement||\"srcObject\"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,\"srcObject\",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener(\"addtrack\",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})),e.addEventListener(\"removetrack\",(function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}))):this.src=\"\"}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException(\"Track already exists.\",\"InvalidAccessError\")}));var r=t.getSenders();n.apply(this,arguments);var i=t.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException(\"Track already exists.\",\"InvalidAccessError\")})),!n._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());n._streams[t.id]=r,n._reverseStreams[r.id]=t,t=r}i.apply(n,[t])};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},a.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if(\"closed\"===r.signalingState)throw new DOMException(\"The RTCPeerConnection's signalingState is 'closed'.\",\"InvalidStateError\");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException(\"The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.\",\"NotSupportedError\");var a=r.getSenders().find((function(e){return e.track===t}));if(a)throw new DOMException(\"Track already exists.\",\"InvalidAccessError\");r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{};var s=r._streams[n.id];if(s)s.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event(\"negotiationneeded\"))}));else{var o=new e.MediaStream([t]);r._streams[n.id]=o,r._reverseStreams[o.id]=n,r.addStream(o)}return r.getSenders().find((function(e){return e.track===t}))},[\"createOffer\",\"createAnswer\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments,r=arguments.length&&\"function\"===typeof arguments[0];return r?n.apply(e,[function(n){var r=c(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(e,arguments).then((function(t){return c(e,t)}))}}));var s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;return arguments.length&&arguments[0].type?(arguments[0]=d(e,arguments[0]),s.apply(e,arguments)):s.apply(e,arguments)};var o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,\"localDescription\");Object.defineProperty(e.RTCPeerConnection.prototype,\"localDescription\",{get:function(){var e=o.get.apply(this);return\"\"===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if(\"closed\"===n.signalingState)throw new DOMException(\"The RTCPeerConnection's signalingState is 'closed'.\",\"InvalidStateError\");if(!e._pc)throw new DOMException(\"Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.\",\"TypeError\");if(!(e._pc===n))throw new DOMException(\"Sender was not created by this connection.\",\"InvalidAccessError\");n._streams=n._streams||{},Object.keys(n._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?n.removeStream(n._reverseStreams[t.id]):t.removeTrack(e.track),n.dispatchEvent(new Event(\"negotiationneeded\")))}}function c(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,\"g\"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function d(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,\"g\"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=function(t,n){return i(\"PeerConnection\"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}})),e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var i=this,a=arguments;if(arguments.length>0&&\"function\"===typeof e)return n.apply(this,arguments);if(0===n.length&&(0===arguments.length||\"function\"!==typeof arguments[0]))return n.apply(this,[]);var s=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){a[1](o(s(e)))};return n.apply(this,[c,arguments[0]])}return new Promise((function(e,t){n.apply(i,[function(t){e(o(s(t)))},t])})).then(t,r)},t.version<51&&[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,r=new Promise((function(r,i){n.apply(t,[e[0],r,i])}));return e.length<2?r:r.then((function(){e[1].apply(null,[])}),(function(t){e.length>=3&&e[2].apply(null,[t])}))}})),t.version<52&&[\"createOffer\",\"createAnswer\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&\"object\"===typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise((function(r,i){n.apply(e,[r,i,t])}))}return n.apply(this,arguments)}})),[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new(\"addIceCandidate\"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var a=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},fixNegotiationNeeded:function(e){r.wrapPeerConnectionEvent(e,\"negotiationneeded\",(function(e){if(\"stable\"===e.target.signalingState)return e}))},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||\"getDisplayMedia\"in e.navigator.mediaDevices||(\"function\"===typeof t?(e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:\"desktop\",chromeMediaSourceId:t,maxFrameRate:a||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),e.navigator.mediaDevices.getDisplayMedia(t)}):console.error(\"shimGetDisplayMedia: getSourceId argument is not a function\"))}}},\"/xkB\":function(e,t){THREE.GLTFLoader=function(){function e(e){THREE.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:e,load:function(e,t,n,r){var i,a=this;i=\"\"!==this.resourcePath?this.resourcePath:\"\"!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),a.manager.itemStart(e);var s=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},o=new THREE.FileLoader(a.manager);o.setPath(this.path),o.setResponseType(\"arraybuffer\"),\"use-credentials\"===a.crossOrigin&&o.setWithCredentials(!0),o.load(e,(function(n){try{a.parse(n,i,(function(n){t(n),a.manager.itemEnd(e)}),s)}catch(r){s(r)}}),n,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,c,d){var h,v={};if(\"string\"===typeof e)h=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o){try{v[n.KHR_BINARY_GLTF]=new p(e)}catch(E){return void(d&&d(E))}h=v[n.KHR_BINARY_GLTF].content}else h=THREE.LoaderUtils.decodeText(new Uint8Array(e));var g=JSON.parse(h);if(void 0===g.asset||g.asset.version[0]<2)d&&d(new Error(\"THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.\"));else{if(g.extensionsUsed)for(var y=0;y<g.extensionsUsed.length;++y){var T=g.extensionsUsed[y],C=g.extensionsRequired||[];switch(T){case n.KHR_LIGHTS_PUNCTUAL:v[T]=new i(g);break;case n.KHR_MATERIALS_CLEARCOAT:v[T]=new s;break;case n.KHR_MATERIALS_UNLIT:v[T]=new a;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:v[T]=new f;break;case n.KHR_DRACO_MESH_COMPRESSION:v[T]=new u(g,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:v[T]=new r(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:v[T]=new l;break;case n.KHR_MESH_QUANTIZATION:v[T]=new m;break;default:C.indexOf(T)>=0&&console.warn('THREE.GLTFLoader: Unknown extension \"'+T+'\".')}}new G(g,v,{path:t||this.resourcePath||\"\",crossOrigin:this.crossOrigin,manager:this.manager}).parse(c,d)}}});var n={KHR_BINARY_GLTF:\"KHR_binary_glTF\",KHR_DRACO_MESH_COMPRESSION:\"KHR_draco_mesh_compression\",KHR_LIGHTS_PUNCTUAL:\"KHR_lights_punctual\",KHR_MATERIALS_CLEARCOAT:\"KHR_materials_clearcoat\",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\"KHR_materials_pbrSpecularGlossiness\",KHR_MATERIALS_UNLIT:\"KHR_materials_unlit\",KHR_TEXTURE_TRANSFORM:\"KHR_texture_transform\",KHR_MESH_QUANTIZATION:\"KHR_mesh_quantization\",MSFT_TEXTURE_DDS:\"MSFT_texture_dds\"};function r(e){if(!e)throw new Error(\"THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader\");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=e}function i(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function a(){this.name=n.KHR_MATERIALS_UNLIT}function s(){this.name=n.KHR_MATERIALS_CLEARCOAT}i.prototype.loadLight=function(e){var t,n=this.lightDefs[e],r=new THREE.Color(16777215);void 0!==n.color&&r.fromArray(n.color);var i=void 0!==n.range?n.range:0;switch(n.type){case\"directional\":(t=new THREE.DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case\"point\":(t=new THREE.PointLight(r)).distance=i;break;case\"spot\":(t=new THREE.SpotLight(r)).distance=i,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, \"'+n.type+'\".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||\"light_\"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},a.prototype.extendParams=function(e,t,n){var r=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var a=i.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,\"map\",i.baseColorTexture))}return Promise.all(r)},s.prototype.getMaterialType=function(){return THREE.MeshPhysicalMaterial},s.prototype.extendParams=function(e,t,n){var r=[],i=t.extensions[this.name];if(void 0!==i.clearcoatFactor&&(e.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&r.push(n.assignTexture(e,\"clearcoatMap\",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(e.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&r.push(n.assignTexture(e,\"clearcoatRoughnessMap\",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(r.push(n.assignTexture(e,\"clearcoatNormalMap\",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){var a=i.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new THREE.Vector2(a,a)}return Promise.all(r)};var o=\"glTF\",c=12,d={JSON:1313821514,BIN:5130562};function p(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,c);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error(\"THREE.GLTFLoader: Unsupported glTF-Binary header.\");if(this.header.version<2)throw new Error(\"THREE.GLTFLoader: Legacy binary file detected.\");for(var r=new DataView(e,c),i=0;i<r.byteLength;){var a=r.getUint32(i,!0);i+=4;var s=r.getUint32(i,!0);if(i+=4,s===d.JSON){var p=new Uint8Array(e,c+i,a);this.content=THREE.LoaderUtils.decodeText(p)}else if(s===d.BIN){var u=c+i;this.body=e.slice(u,u+a)}i+=a}if(null===this.content)throw new Error(\"THREE.GLTFLoader: JSON content not found.\")}function u(e,t){if(!t)throw new Error(\"THREE.GLTFLoader: No DRACOLoader instance provided.\");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function l(){this.name=n.KHR_TEXTURE_TRANSFORM}function h(e){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=[\"#ifdef USE_SPECULARMAP\",\"\\tuniform sampler2D specularMap;\",\"#endif\"].join(\"\\n\"),n=[\"#ifdef USE_GLOSSINESSMAP\",\"\\tuniform sampler2D glossinessMap;\",\"#endif\"].join(\"\\n\"),r=[\"vec3 specularFactor = specular;\",\"#ifdef USE_SPECULARMAP\",\"\\tvec4 texelSpecular = texture2D( specularMap, vUv );\",\"\\ttexelSpecular = sRGBToLinear( texelSpecular );\",\"\\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\",\"\\tspecularFactor *= texelSpecular.rgb;\",\"#endif\"].join(\"\\n\"),i=[\"float glossinessFactor = glossiness;\",\"#ifdef USE_GLOSSINESSMAP\",\"\\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );\",\"\\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\",\"\\tglossinessFactor *= texelGlossiness.a;\",\"#endif\"].join(\"\\n\"),a=[\"PhysicalMaterial material;\",\"material.diffuseColor = diffuseColor.rgb;\",\"vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\",\"float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\",\"material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\",\"material.specularRoughness += geometryRoughness;\",\"material.specularRoughness = min( material.specularRoughness, 1.0 );\",\"material.specularColor = specularFactor.rgb;\"].join(\"\\n\"),s={specular:{value:(new THREE.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var o in s)e.uniforms[o]=s[o];e.fragmentShader=e.fragmentShader.replace(\"uniform float roughness;\",\"uniform vec3 specular;\"),e.fragmentShader=e.fragmentShader.replace(\"uniform float metalness;\",\"uniform float glossiness;\"),e.fragmentShader=e.fragmentShader.replace(\"#include <roughnessmap_pars_fragment>\",t),e.fragmentShader=e.fragmentShader.replace(\"#include <metalnessmap_pars_fragment>\",n),e.fragmentShader=e.fragmentShader.replace(\"#include <roughnessmap_fragment>\",r),e.fragmentShader=e.fragmentShader.replace(\"#include <metalnessmap_fragment>\",i),e.fragmentShader=e.fragmentShader.replace(\"#include <lights_physical_fragment>\",a)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){s.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP=\"\",this.defines.USE_ROUGHNESSMAP=\"\"):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function f(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:[\"color\",\"map\",\"lightMap\",\"lightMapIntensity\",\"aoMap\",\"aoMapIntensity\",\"emissive\",\"emissiveIntensity\",\"emissiveMap\",\"bumpMap\",\"bumpScale\",\"normalMap\",\"normalMapType\",\"displacementMap\",\"displacementScale\",\"displacementBias\",\"specularMap\",\"specular\",\"glossinessMap\",\"glossiness\",\"alphaMap\",\"envMap\",\"envMapIntensity\",\"refractionRatio\"],getMaterialType:function(){return h},extendParams:function(e,t,n){var r=t.extensions[this.name];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var a=r.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(e,\"map\",r.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var s=r.specularGlossinessTexture;i.push(n.assignTexture(e,\"glossinessMap\",s)),i.push(n.assignTexture(e,\"specularMap\",s))}return Promise.all(i)},createMaterial:function(e){var t=new h(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=THREE.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function m(){this.name=n.KHR_MESH_QUANTIZATION}function v(e,t,n,r){THREE.Interpolant.call(this,e,t,n,r)}u.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,s={},o={},c={};for(var d in a){var p=O[d]||d.toLowerCase();s[p]=a[d]}for(d in e.attributes){p=O[d]||d.toLowerCase();if(void 0!==a[d]){var u=n.accessors[e.attributes[d]],l=b[u.componentType];c[p]=l,o[p]=!0===u.normalized}}return t.getDependency(\"bufferView\",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],i=o[n];void 0!==i&&(r.normalized=i)}t(e)}),s,c)}))}))},l.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in \"'+this.name+'\" extension not yet supported.'),e.needsUpdate=!0,e},h.prototype=Object.create(THREE.MeshStandardMaterial.prototype),h.prototype.constructor=h,h.prototype.copy=function(e){return THREE.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},v.prototype=Object.create(THREE.Interpolant.prototype),v.prototype.constructor=v,v.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t},v.prototype.beforeStart_=v.prototype.copySampleValue_,v.prototype.afterEnd_=v.prototype.copySampleValue_,v.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=2*s,c=3*s,d=r-t,p=(n-t)/d,u=p*p,l=u*p,h=e*c,f=h-c,m=-2*l+3*u,v=l-u,g=1-m,y=v-u+p,T=0;T!==s;T++){var C=a[f+T+s],E=a[f+T+o]*d,S=a[h+T+s],w=a[h+T]*d;i[T]=g*C+y*E+m*S+v*w}return i};var g=0,y=1,T=2,C=3,E=4,S=5,w=6,b={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},R={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},P={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},k={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={POSITION:\"position\",NORMAL:\"normal\",TANGENT:\"tangent\",TEXCOORD_0:\"uv\",TEXCOORD_1:\"uv2\",COLOR_0:\"color\",WEIGHTS_0:\"skinWeight\",JOINTS_0:\"skinIndex\"},M={scale:\"scale\",translation:\"position\",rotation:\"quaternion\",weights:\"morphTargetInfluences\"},D={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},x=\"OPAQUE\",_=\"MASK\",A=\"BLEND\",L={\"image/png\":THREE.RGBAFormat,\"image/jpeg\":THREE.RGBFormat};function I(e,t){return\"string\"!==typeof e||\"\"===e?\"\":(/^https?:\\/\\//i.test(t)&&/^\\//.test(e)&&(t=t.replace(/(^https?:\\/\\/[^\\/]+).*/i,\"$1\")),/^(https?:)?\\/\\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function N(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function F(e,t){void 0!==t.extras&&(\"object\"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn(\"THREE.GLTFLoader: Ignoring primitive type .extras, \"+t.extras))}function j(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n}else console.warn(\"THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.\")}}function H(e){var t=e.extensions&&e.extensions[n.KHR_DRACO_MESH_COMPRESSION];return t?\"draco:\"+t.bufferView+\":\"+t.indices+\":\"+U(t.attributes):e.indices+\":\"+U(e.attributes)+\":\"+e.mode}function U(e){for(var t=\"\",n=Object.keys(e).sort(),r=0,i=n.length;r<i;r++)t+=n[r]+\":\"+e[n[r]]+\";\";return t}function G(e,n,r){this.json=e||{},this.extensions=n||{},this.options=r||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType(\"arraybuffer\"),\"use-credentials\"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function B(e,t,n){var r=t.attributes,i=[];function a(t,r){return n.getDependency(\"accessor\",t).then((function(t){e.setAttribute(r,t)}))}for(var s in r){var o=O[s]||s.toLowerCase();o in e.attributes||i.push(a(r[s],o))}if(void 0!==t.indices&&!e.index){var c=n.getDependency(\"accessor\",t.indices).then((function(t){e.setIndex(t)}));i.push(c)}return F(e,t),function(e,t,n){var r=t.attributes,i=new THREE.Box3;if(void 0!==r.POSITION){var a=(h=n.json.accessors[r.POSITION]).min,s=h.max;if(void 0!==a&&void 0!==s){i.set(new THREE.Vector3(a[0],a[1],a[2]),new THREE.Vector3(s[0],s[1],s[2]));var o=t.targets;if(void 0!==o){for(var c=new THREE.Vector3,d=new THREE.Vector3,p=0,u=o.length;p<u;p++){var l=o[p];if(void 0!==l.POSITION){var h;a=(h=n.json.accessors[l.POSITION]).min,s=h.max;void 0!==a&&void 0!==s?(d.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),d.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),d.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),c.max(d)):console.warn(\"THREE.GLTFLoader: Missing min/max properties for accessor POSITION.\")}}i.expandByVector(c)}e.boundingBox=i;var f=new THREE.Sphere;i.getCenter(f.center),f.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=f}else console.warn(\"THREE.GLTFLoader: Missing min/max properties for accessor POSITION.\")}}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,i=!1,a=0,s=t.length;a<s;a++){if(void 0!==(d=t[a]).POSITION&&(r=!0),void 0!==d.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);var o=[],c=[];for(a=0,s=t.length;a<s;a++){var d=t[a];if(r){var p=void 0!==d.POSITION?n.getDependency(\"accessor\",d.POSITION):e.attributes.position;o.push(p)}if(i){p=void 0!==d.NORMAL?n.getDependency(\"accessor\",d.NORMAL):e.attributes.normal;c.push(p)}}return Promise.all([Promise.all(o),Promise.all(c)]).then((function(t){var n=t[0],a=t[1];return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function z(e,t){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute(\"position\");if(void 0===i)return console.error(\"THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.\"),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var s=n.count-2,o=[];if(t===THREE.TriangleFanDrawMode)for(a=1;a<=s;a++)o.push(n.getX(0)),o.push(n.getX(a)),o.push(n.getX(a+1));else for(a=0;a<s;a++)a%2===0?(o.push(n.getX(a)),o.push(n.getX(a+1)),o.push(n.getX(a+2))):(o.push(n.getX(a+2)),o.push(n.getX(a+1)),o.push(n.getX(a)));o.length/3!==s&&console.error(\"THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.\");var c=e.clone();return c.setIndex(o),c}return G.prototype.parse=function(e,t){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies(\"scene\"),this.getDependencies(\"animation\"),this.getDependencies(\"camera\")]).then((function(t){var a={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};N(i,a,r),F(a,r),e(a)})).catch(t)},G.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},i={},a=0,s=t.length;a<s;a++)for(var o=t[a].joints,c=0,d=o.length;c<d;c++)e[o[c]].isBone=!0;for(var p=0,u=e.length;p<u;p++){var l=e[p];void 0!==l.mesh&&(void 0===r[l.mesh]&&(r[l.mesh]=i[l.mesh]=0),r[l.mesh]++,void 0!==l.skin&&(n[l.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},G.prototype.getDependency=function(e,t){var r=e+\":\"+t,i=this.cache.get(r);if(!i){switch(e){case\"scene\":i=this.loadScene(t);break;case\"node\":i=this.loadNode(t);break;case\"mesh\":i=this.loadMesh(t);break;case\"accessor\":i=this.loadAccessor(t);break;case\"bufferView\":i=this.loadBufferView(t);break;case\"buffer\":i=this.loadBuffer(t);break;case\"material\":i=this.loadMaterial(t);break;case\"texture\":i=this.loadTexture(t);break;case\"skin\":i=this.loadSkin(t);break;case\"animation\":i=this.loadAnimation(t);break;case\"camera\":i=this.loadCamera(t);break;case\"light\":i=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error(\"Unknown type: \"+e)}this.cache.add(r,i)}return i},G.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+(\"mesh\"===e?\"es\":\"s\")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},G.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&\"arraybuffer\"!==t.type)throw new Error(\"THREE.GLTFLoader: \"+t.type+\" buffer type is not supported.\");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,n){r.load(I(t.uri,i.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer \"'+t.uri+'\".'))}))}))},G.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency(\"buffer\",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},G.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency(\"bufferView\",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency(\"bufferView\",r.sparse.indices.bufferView)),i.push(this.getDependency(\"bufferView\",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,a,s=e[0],o=k[r.type],c=b[r.componentType],d=c.BYTES_PER_ELEMENT,p=d*o,u=r.byteOffset||0,l=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;if(l&&l!==p){var f=Math.floor(u/l),m=\"InterleavedBuffer:\"+r.bufferView+\":\"+r.componentType+\":\"+f+\":\"+r.count,v=t.cache.get(m);v||(i=new c(s,f*l,r.count*l/d),v=new THREE.InterleavedBuffer(i,l/d),t.cache.add(m,v)),a=new THREE.InterleavedBufferAttribute(v,o,u%l/d,h)}else i=null===s?new c(r.count*o):new c(s,u,r.count*o),a=new THREE.BufferAttribute(i,o,h);if(void 0!==r.sparse){var g=k.SCALAR,y=b[r.sparse.indices.componentType],T=r.sparse.indices.byteOffset||0,C=r.sparse.values.byteOffset||0,E=new y(e[1],T,r.sparse.count*g),S=new c(e[2],C,r.sparse.count*o);null!==s&&(a=new THREE.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var w=0,R=E.length;w<R;w++){var P=E[w];if(a.setX(P,S[w*o]),o>=2&&a.setY(P,S[w*o+1]),o>=3&&a.setZ(P,S[w*o+2]),o>=4&&a.setW(P,S[w*o+3]),o>=5)throw new Error(\"THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.\")}}return a}))},G.prototype.loadTexture=function(e){var t,r=this,i=this.json,a=this.options,s=this.textureLoader,o=self.URL||self.webkitURL,c=i.textures[e],d=c.extensions||{},p=(t=d[n.MSFT_TEXTURE_DDS]?i.images[d[n.MSFT_TEXTURE_DDS].source]:i.images[c.source]).uri,u=!1;return void 0!==t.bufferView&&(p=r.getDependency(\"bufferView\",t.bufferView).then((function(e){u=!0;var n=new Blob([e],{type:t.mimeType});return p=o.createObjectURL(n)}))),Promise.resolve(p).then((function(e){var t=a.manager.getHandler(e);return t||(t=d[n.MSFT_TEXTURE_DDS]?r.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise((function(n,r){t.load(I(e,a.path),n,void 0,r)}))})).then((function(e){!0===u&&o.revokeObjectURL(p),e.flipY=!1,c.name&&(e.name=c.name),t.mimeType in L&&(e.format=L[t.mimeType]);var n=(i.samplers||{})[c.sampler]||{};return e.magFilter=R[n.magFilter]||THREE.LinearFilter,e.minFilter=R[n.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=P[n.wrapS]||THREE.RepeatWrapping,e.wrapT=P[n.wrapT]||THREE.RepeatWrapping,e}))},G.prototype.assignTexture=function(e,t,r){var i=this;return this.getDependency(\"texture\",r.index).then((function(a){if(!a.isCompressedTexture)switch(t){case\"aoMap\":case\"emissiveMap\":case\"metalnessMap\":case\"normalMap\":case\"roughnessMap\":a.format=THREE.RGBFormat}if(void 0===r.texCoord||0==r.texCoord||\"aoMap\"===t&&1==r.texCoord||console.warn(\"THREE.GLTFLoader: Custom UV set \"+r.texCoord+\" for texture \"+t+\" not yet supported.\"),i.extensions[n.KHR_TEXTURE_TRANSFORM]){var s=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;s&&(a=i.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(a,s))}e[t]=a}))},G.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,r=void 0!==t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal,s=!0===e.isSkinnedMesh,o=Object.keys(t.morphAttributes).length>0,c=o&&void 0!==t.morphAttributes.normal;if(e.isPoints){var d=\"PointsMaterial:\"+n.uuid,p=this.cache.get(d);p||(p=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(p,n),p.color.copy(n.color),p.map=n.map,p.sizeAttenuation=!1,this.cache.add(d,p)),n=p}else if(e.isLine){d=\"LineBasicMaterial:\"+n.uuid;var u=this.cache.get(d);u||(u=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(d,u)),n=u}if(r||i||a||s||o){d=\"ClonedMaterial:\"+n.uuid+\":\";n.isGLTFSpecularGlossinessMaterial&&(d+=\"specular-glossiness:\"),s&&(d+=\"skinning:\"),r&&(d+=\"vertex-tangents:\"),i&&(d+=\"vertex-colors:\"),a&&(d+=\"flat-shading:\"),o&&(d+=\"morph-targets:\"),c&&(d+=\"morph-normals:\");var l=this.cache.get(d);l||(l=n.clone(),s&&(l.skinning=!0),r&&(l.vertexTangents=!0),i&&(l.vertexColors=!0),a&&(l.flatShading=!0),o&&(l.morphTargets=!0),c&&(l.morphNormals=!0),this.cache.add(d,l)),n=l}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute(\"uv2\",new THREE.BufferAttribute(t.attributes.uv.array,2)),n.normalScale&&!r&&(n.normalScale.y=-n.normalScale.y),n.clearcoatNormalScale&&!r&&(n.clearcoatNormalScale.y=-n.clearcoatNormalScale.y),e.material=n},G.prototype.loadMaterial=function(e){var t,r=this.json,i=this.extensions,a=r.materials[e],s={},o=a.extensions||{},c=[];if(o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var d=i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=d.getMaterialType(),c.push(d.extendParams(s,a,this))}else if(o[n.KHR_MATERIALS_UNLIT]){var p=i[n.KHR_MATERIALS_UNLIT];t=p.getMaterialType(),c.push(p.extendParams(s,a,this))}else{t=THREE.MeshStandardMaterial;var u=a.pbrMetallicRoughness||{};if(s.color=new THREE.Color(1,1,1),s.opacity=1,Array.isArray(u.baseColorFactor)){var l=u.baseColorFactor;s.color.fromArray(l),s.opacity=l[3]}void 0!==u.baseColorTexture&&c.push(this.assignTexture(s,\"map\",u.baseColorTexture)),s.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,s.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(c.push(this.assignTexture(s,\"metalnessMap\",u.metallicRoughnessTexture)),c.push(this.assignTexture(s,\"roughnessMap\",u.metallicRoughnessTexture)))}!0===a.doubleSided&&(s.side=THREE.DoubleSide);var f=a.alphaMode||x;if(f===A?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,f===_&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==THREE.MeshBasicMaterial&&(c.push(this.assignTexture(s,\"normalMap\",a.normalTexture)),s.normalScale=new THREE.Vector2(1,1),void 0!==a.normalTexture.scale&&s.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(c.push(this.assignTexture(s,\"aoMap\",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(s.emissive=(new THREE.Color).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==THREE.MeshBasicMaterial&&c.push(this.assignTexture(s,\"emissiveMap\",a.emissiveTexture)),o[n.KHR_MATERIALS_CLEARCOAT]){var m=i[n.KHR_MATERIALS_CLEARCOAT];t=m.getMaterialType(),c.push(m.extendParams(s,{extensions:o},this))}return Promise.all(c).then((function(){var e;return e=t===h?i[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),a.name&&(e.name=a.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),F(e,a),a.extensions&&N(i,e,a),e}))},G.prototype.loadGeometries=function(e){var t=this,r=this.extensions,i=this.primitiveCache;function a(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return B(n,e,t)}))}for(var s=[],o=0,c=e.length;o<c;o++){var d,p=e[o],u=H(p),l=i[u];if(l)s.push(l.promise);else d=p.extensions&&p.extensions[n.KHR_DRACO_MESH_COMPRESSION]?a(p):B(new THREE.BufferGeometry,p,t),i[u]={primitive:p,promise:d},s.push(d)}return Promise.all(s)},G.prototype.loadMesh=function(e){for(var t,n=this,r=this.json.meshes[e],i=r.primitives,a=[],s=0,o=i.length;s<o;s++){var c=void 0===i[s].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),t.DefaultMaterial):this.getDependency(\"material\",i[s].material);a.push(c)}return a.push(n.loadGeometries(i)),Promise.all(a).then((function(t){for(var a=t.slice(0,t.length-1),s=t[t.length-1],o=[],c=0,d=s.length;c<d;c++){var p,u=s[c],l=i[c],h=a[c];if(l.mode===E||l.mode===S||l.mode===w||void 0===l.mode)!0!==(p=!0===r.isSkinnedMesh?new THREE.SkinnedMesh(u,h):new THREE.Mesh(u,h)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),l.mode===S?p.geometry=z(p.geometry,THREE.TriangleStripDrawMode):l.mode===w&&(p.geometry=z(p.geometry,THREE.TriangleFanDrawMode));else if(l.mode===y)p=new THREE.LineSegments(u,h);else if(l.mode===C)p=new THREE.Line(u,h);else if(l.mode===T)p=new THREE.LineLoop(u,h);else{if(l.mode!==g)throw new Error(\"THREE.GLTFLoader: Primitive mode unsupported: \"+l.mode);p=new THREE.Points(u,h)}Object.keys(p.geometry.morphAttributes).length>0&&j(p,r),p.name=r.name||\"mesh_\"+e,s.length>1&&(p.name+=\"_\"+c),F(p,r),n.assignFinalMaterial(p),o.push(p)}if(1===o.length)return o[0];var f=new THREE.Group;for(c=0,d=o.length;c<d;c++)f.add(o[c]);return f}))},G.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return\"perspective\"===n.type?t=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):\"orthographic\"===n.type&&(t=new THREE.OrthographicCamera(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),n.name&&(t.name=n.name),F(t,n),Promise.resolve(t);console.warn(\"THREE.GLTFLoader: Missing camera parameters.\")},G.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency(\"accessor\",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},G.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],a=[],s=[],o=0,c=t.channels.length;o<c;o++){var d=t.channels[o],p=t.samplers[d.sampler],u=d.target,l=void 0!==u.node?u.node:u.id,h=void 0!==t.parameters?t.parameters[p.input]:p.input,f=void 0!==t.parameters?t.parameters[p.output]:p.output;n.push(this.getDependency(\"node\",l)),r.push(this.getDependency(\"accessor\",h)),i.push(this.getDependency(\"accessor\",f)),a.push(p),s.push(u)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(a),Promise.all(s)]).then((function(n){for(var r=n[0],i=n[1],a=n[2],s=n[3],o=n[4],c=[],d=0,p=r.length;d<p;d++){var u=r[d],l=i[d],h=a[d],f=s[d],m=o[d];if(void 0!==u){var g;switch(u.updateMatrix(),u.matrixAutoUpdate=!0,M[m.path]){case M.weights:g=THREE.NumberKeyframeTrack;break;case M.rotation:g=THREE.QuaternionKeyframeTrack;break;case M.position:case M.scale:default:g=THREE.VectorKeyframeTrack}var y=u.name?u.name:u.uuid,T=void 0!==f.interpolation?D[f.interpolation]:THREE.InterpolateLinear,C=[];M[m.path]===M.weights?u.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&C.push(e.name?e.name:e.uuid)})):C.push(y);var E=h.array;if(h.normalized){var S;if(E.constructor===Int8Array)S=1/127;else if(E.constructor===Uint8Array)S=1/255;else if(E.constructor==Int16Array)S=1/32767;else{if(E.constructor!==Uint16Array)throw new Error(\"THREE.GLTFLoader: Unsupported output accessor component type.\");S=1/65535}for(var w=new Float32Array(E.length),b=0,R=E.length;b<R;b++)w[b]=E[b]*S;E=w}for(b=0,R=C.length;b<R;b++){var P=new g(C[b]+\".\"+M[m.path],l.array,E,T);\"CUBICSPLINE\"===f.interpolation&&(P.createInterpolant=function(e){return new v(this.times,this.values,this.getValueSize()/3,e)},P.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(P)}}}var k=t.name?t.name:\"animation_\"+e;return new THREE.AnimationClip(k,void 0,c)}))},G.prototype.loadNode=function(e){var t=this.json,r=this.extensions,i=this,a=t.meshReferences,s=t.meshUses,o=t.nodes[e];return function(){var e=[];return void 0!==o.mesh&&e.push(i.getDependency(\"mesh\",o.mesh).then((function(e){var t;if(a[o.mesh]>1){var n=s[o.mesh]++;(t=e.clone()).name+=\"_instance_\"+n}else t=e;return void 0!==o.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=o.weights.length;t<n;t++)e.morphTargetInfluences[t]=o.weights[t]})),t}))),void 0!==o.camera&&e.push(i.getDependency(\"camera\",o.camera)),o.extensions&&o.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==o.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&e.push(i.getDependency(\"light\",o.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then((function(e){var t;if((t=!0===o.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var n=0,i=e.length;n<i;n++)t.add(e[n]);if(o.name&&(t.userData.name=o.name,t.name=THREE.PropertyBinding.sanitizeNodeName(o.name)),F(t,o),o.extensions&&N(r,t,o),void 0!==o.matrix){var a=new THREE.Matrix4;a.fromArray(o.matrix),t.applyMatrix4(a)}else void 0!==o.translation&&t.position.fromArray(o.translation),void 0!==o.rotation&&t.quaternion.fromArray(o.rotation),void 0!==o.scale&&t.scale.fromArray(o.scale);return t}))},G.prototype.loadScene=function(){function e(t,n,r,i){var a=r.nodes[t];return i.getDependency(\"node\",t).then((function(e){return void 0===a.skin?e:i.getDependency(\"skin\",a.skin).then((function(e){for(var n=[],r=0,a=(t=e).joints.length;r<a;r++)n.push(i.getDependency(\"node\",t.joints[r]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],a=0,s=n.length;a<s;a++){var o=n[a];if(o){r.push(o);var c=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*a),i.push(c)}else console.warn('THREE.GLTFLoader: Joint \"%s\" could not be found.',t.joints[a])}e.bind(new THREE.Skeleton(r,i),e.matrixWorld)}})),e}));var t})).then((function(t){n.add(t);var s=[];if(a.children)for(var o=a.children,c=0,d=o.length;c<d;c++){var p=o[c];s.push(e(p,t,r,i))}return Promise.all(s)}))}return function(t){var n=this.json,r=this.extensions,i=this.json.scenes[t],a=new THREE.Group;i.name&&(a.name=i.name),F(a,i),i.extensions&&N(r,a,i);for(var s=i.nodes||[],o=[],c=0,d=s.length;c<d;c++)o.push(e(s[c],a,n,this));return Promise.all(o).then((function(){return a}))}}(),e}()},\"0JNz\":function(e,t,n){\"use strict\";(function(t){var r=n(\"GAh6\");e.exports=r({window:t.window})}).call(this,n(\"yLpj\"))},\"1OyB\":function(e,t,n){\"use strict\";function r(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}n.d(t,\"a\",(function(){return r}))},\"5YFB\":function(e,t,n){\"use strict\";n.r(t);var r=n(\"1OyB\"),i=n(\"vuIU\"),a=n(\"md7G\"),s=n(\"foSv\"),o=n(\"Ji7U\"),c=(n(\"/xkB\"),n(\"WeY7\"),n(\"STrH\"),n(\"0JNz\"),n(\"q1tI\")),d=n.n(c),p=n(\"i8i4\"),u=n.n(p),l=d.a.createElement;function h(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var f=function(e){Object(o.a)(c,e);var t,n=(t=c,function(){var e,n=Object(s.a)(t);if(h()){var r=Object(s.a)(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Object(a.a)(this,e)});function c(e){var t;return Object(r.a)(this,c),(t=n.call(this,e)).state={},t}return Object(i.a)(c,[{key:\"render\",value:function(){return l(\"a-scene\",{renderer:\"antialias: true\",background:\"color: #FAFAFA\"},l(\"a-box\",{position:\"-1 0.5 -3\",rotation:\"0 45 0\",color:\"#4CC3D9\",shadow:!0}),l(\"a-sphere\",{position:\"0 1.25 -5\",radius:\"1.25\",color:\"#EF2D5E\",shadow:!0}),l(\"a-cylinder\",{position:\"1 0.75 -3\",radius:\"0.5\",height:\"1.5\",color:\"#FFC65D\",shadow:!0}),l(\"a-plane\",{position:\"0 0 -4\",rotation:\"-90 0 0\",width:\"4\",height:\"4\",color:\"#7BC8A4\",shadow:!0}))}}]),c}(d.a.Component);u.a.render(l(f,null),document.querySelector(\"#sceneContainer\"))},\"7dnI\":function(e,t,n){\"use strict\";e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var n;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var a=s,o=Number(new Date),c=o-(n||o);a.diff=c,a.prev=n,a.curr=o,n=o,t[0]=r.coerce(t[0]),\"string\"!==typeof t[0]&&t.unshift(\"%O\");var d=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if(\"%%\"===e)return e;d++;var i=r.formatters[n];if(\"function\"===typeof i){var s=t[d];e=i.call(a,s),t.splice(d,1),d--}return e})),r.formatArgs.call(a,t),(a.log||r.log).apply(a,t)}}return s.namespace=e,s.enabled=r.enabled(e),s.useColors=r.useColors(),s.color=t(e),s.destroy=i,s.extend=a,\"function\"===typeof r.init&&r.init(s),r.instances.push(s),s}function i(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function a(e,t){return r(this.namespace+(\"undefined\"===typeof t?\":\":t)+e)}return r.debug=r,r.default=r,r.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){r.enable(\"\")},r.enable=function(e){var t;r.save(e),r.names=[],r.skips=[];var n=(\"string\"===typeof e?e:\"\").split(/[\\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&(\"-\"===(e=n[t].replace(/\\*/g,\".*?\"))[0]?r.skips.push(new RegExp(\"^\"+e.substr(1)+\"$\")):r.names.push(new RegExp(\"^\"+e+\"$\")));for(t=0;t<r.instances.length;t++){var a=r.instances[t];a.enabled=r.enabled(a.namespace)}},r.enabled=function(e){if(\"*\"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(\"FGiv\"),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},\"8D0k\":function(e,t,n){\"use strict\";var r=n(\"KCt4\");function i(e,t,n,i,a){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),\"offer\"===n?\"actpass\":a||\"active\"),s+=\"a=mid:\"+e.mid+\"\\r\\n\",e.rtpSender&&e.rtpReceiver?s+=\"a=sendrecv\\r\\n\":e.rtpSender?s+=\"a=sendonly\\r\\n\":e.rtpReceiver?s+=\"a=recvonly\\r\\n\":s+=\"a=inactive\\r\\n\",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var c=\"msid:\"+(i?i.id:\"-\")+\" \"+o+\"\\r\\n\";s+=\"a=\"+c,s+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" \"+c,e.sendEncodingParameters[0].rtx&&(s+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" \"+c,s+=\"a=ssrc-group:FID \"+e.sendEncodingParameters[0].ssrc+\" \"+e.sendEncodingParameters[0].rtx.ssrc+\"\\r\\n\")}return s+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" cname:\"+r.localCName+\"\\r\\n\",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" cname:\"+r.localCName+\"\\r\\n\"),s}function a(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var a=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return a&&s&&a.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var a=0;a<t.codecs.length;a++){var s=t.codecs[a];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if(\"rtx\"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:[\"stable\",\"have-local-offer\"],setRemoteDescription:[\"stable\",\"have-remote-offer\"]},answer:{setLocalDescription:[\"have-remote-offer\",\"have-local-pranswer\"],setRemoteDescription:[\"have-local-offer\",\"have-remote-pranswer\"]}}[t][e].indexOf(n)}function o(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent(\"addtrack\",{track:t}))}function d(t,n,r,i){var a=new Event(\"track\");a.track=n,a.receiver=r,a.transceiver={receiver:r},a.streams=i,e.setTimeout((function(){t._dispatchEvent(\"track\",a)}))}var p=function(n){var i=this,a=document.createDocumentFragment();if([\"addEventListener\",\"removeEventListener\",\"dispatchEvent\"].forEach((function(e){i[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState=\"stable\",this.iceConnectionState=\"new\",this.connectionState=\"new\",this.iceGatheringState=\"new\",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle=\"max-bundle\"===n.bundlePolicy,\"negotiate\"===n.rtcpMuxPolicy)throw c(\"NotSupportedError\",\"rtcpMuxPolicy 'negotiate' is not supported\");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy=\"require\"),n.iceTransportPolicy){case\"all\":case\"relay\":break;default:n.iceTransportPolicy=\"all\"}switch(n.bundlePolicy){case\"balanced\":case\"max-compat\":case\"max-bundle\":break;default:n.bundlePolicy=\"balanced\"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn(\"RTCIceServer.url is deprecated! Use urls instead.\");var i=\"string\"===typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0===e.indexOf(\"turn:\")&&-1!==e.indexOf(\"transport=udp\")&&-1===e.indexOf(\"turn:[\")&&!n?(n=!0,!0):0===e.indexOf(\"stun:\")&&t>=14393&&-1===e.indexOf(\"?transport=udp\")})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(p.prototype,\"localDescription\",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(p.prototype,\"remoteDescription\",{configurable:!0,get:function(){return this._remoteDescription}}),p.prototype.onicecandidate=null,p.prototype.onaddstream=null,p.prototype.ontrack=null,p.prototype.onremovestream=null,p.prototype.onsignalingstatechange=null,p.prototype.oniceconnectionstatechange=null,p.prototype.onconnectionstatechange=null,p.prototype.onicegatheringstatechange=null,p.prototype.onnegotiationneeded=null,p.prototype.ondatachannel=null,p.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),\"function\"===typeof this[\"on\"+e]&&this[\"on\"+e](t))},p.prototype._emitGatheringStateChange=function(){var e=new Event(\"icegatheringstatechange\");this._dispatchEvent(\"icegatheringstatechange\",e)},p.prototype.getConfiguration=function(){return this._config},p.prototype.getLocalStreams=function(){return this.localStreams},p.prototype.getRemoteStreams=function(){return this.remoteStreams},p.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},p.prototype.addTrack=function(t,n){if(this._isClosed)throw c(\"InvalidStateError\",\"Attempted to call addTrack on a closed peerconnection.\");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c(\"InvalidAccessError\",\"Track already exists.\");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},p.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener(\"enabled\",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},p.prototype.removeTrack=function(t){if(this._isClosed)throw c(\"InvalidStateError\",\"Attempted to call removeTrack on a closed peerconnection.\");if(!(t instanceof e.RTCRtpSender))throw new TypeError(\"Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.\");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c(\"InvalidAccessError\",\"Sender was not created by this connection.\");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},p.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},p.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},p.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},p.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,\"state\",{value:\"new\",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?\"completed\":\"gathering\",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener(\"localcandidate\",this.transceivers[t].bufferCandidates),i},p.prototype._gather=function(t,n){var i=this,a=this.transceivers[n].iceGatherer;if(!a.onlocalcandidate){var s=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,a.removeEventListener(\"localcandidate\",this.transceivers[n].bufferCandidates),a.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var s=new Event(\"icecandidate\");s.candidate={sdpMid:t,sdpMLineIndex:n};var o=e.candidate,c=!o||0===Object.keys(o).length;if(c)\"new\"!==a.state&&\"gathering\"!==a.state||(a.state=\"completed\");else{\"new\"===a.state&&(a.state=\"gathering\"),o.component=1,o.ufrag=a.getLocalParameters().usernameFragment;var d=r.writeCandidate(o);s.candidate=Object.assign(s.candidate,r.parseCandidate(d)),s.candidate.candidate=d,s.candidate.toJSON=function(){return{candidate:s.candidate.candidate,sdpMid:s.candidate.sdpMid,sdpMLineIndex:s.candidate.sdpMLineIndex,usernameFragment:s.candidate.usernameFragment}}}var p=r.getMediaSections(i._localDescription.sdp);p[s.candidate.sdpMLineIndex]+=c?\"a=end-of-candidates\\r\\n\":\"a=\"+s.candidate.candidate+\"\\r\\n\",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+p.join(\"\");var u=i.transceivers.every((function(e){return e.iceGatherer&&\"completed\"===e.iceGatherer.state}));\"gathering\"!==i.iceGatheringState&&(i.iceGatheringState=\"gathering\",i._emitGatheringStateChange()),c||i._dispatchEvent(\"icecandidate\",s),u&&(i._dispatchEvent(\"icecandidate\",new Event(\"icecandidate\")),i.iceGatheringState=\"complete\",i._emitGatheringStateChange())}},e.setTimeout((function(){s.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},p.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,\"state\",{value:\"failed\",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},p.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},p.prototype._transceive=function(e,n,i){var s=a(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(s.encodings=e.sendEncodingParameters,s.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(s.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(s)),i&&e.rtpReceiver&&s.codecs.length>0&&(\"video\"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?s.encodings=e.recvEncodingParameters:s.encodings=[{}],s.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(s.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(s.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(s))},p.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===[\"offer\",\"answer\"].indexOf(e.type))return Promise.reject(c(\"TypeError\",'Unsupported type \"'+e.type+'\"'));if(!s(\"setLocalDescription\",e.type,i.signalingState)||i._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not set local \"+e.type+\" in state \"+i.signalingState));if(\"offer\"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if(\"answer\"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var o=r.matchPrefix(n,\"a=ice-lite\").length>0;t.forEach((function(e,t){var s=i.transceivers[t],c=s.iceGatherer,d=s.iceTransport,p=s.dtlsTransport,u=s.localCapabilities,l=s.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,\"a=bundle-only\").length)&&!s.rejected){var h=r.getIceParameters(e,n),f=r.getDtlsParameters(e,n);o&&(f.role=\"server\"),i.usingBundle&&0!==t||(i._gather(s.mid,t),\"new\"===d.state&&d.start(c,h,o?\"controlling\":\"controlled\"),\"new\"===p.state&&p.start(f));var m=a(u,l);i._transceive(s,m.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},\"offer\"===e.type?i._updateSignalingState(\"have-local-offer\"):i._updateSignalingState(\"stable\"),Promise.resolve()},p.prototype.setRemoteDescription=function(i){var p=this;if(-1===[\"offer\",\"answer\"].indexOf(i.type))return Promise.reject(c(\"TypeError\",'Unsupported type \"'+i.type+'\"'));if(!s(\"setRemoteDescription\",i.type,p.signalingState)||p._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not set remote \"+i.type+\" in state \"+p.signalingState));var u={};p.remoteStreams.forEach((function(e){u[e.id]=e}));var l=[],h=r.splitSections(i.sdp),f=h.shift(),m=r.matchPrefix(f,\"a=ice-lite\").length>0,v=r.matchPrefix(f,\"a=group:BUNDLE \").length>0;p.usingBundle=v;var g=r.matchPrefix(f,\"a=ice-options:\")[0];return p.canTrickleIceCandidates=!!g&&g.substr(14).split(\" \").indexOf(\"trickle\")>=0,h.forEach((function(s,c){var d=r.splitLines(s),h=r.getKind(s),g=r.isRejected(s)&&0===r.matchPrefix(s,\"a=bundle-only\").length,y=d[0].substr(2).split(\" \")[2],T=r.getDirection(s,f),C=r.parseMsid(s),E=r.getMid(s)||r.generateIdentifier();if(g||\"application\"===h&&(\"DTLS/SCTP\"===y||\"UDP/DTLS/SCTP\"===y))p.transceivers[c]={mid:E,kind:h,protocol:y,rejected:!0};else{var S,w,b,R,P,k,O,M,D;!g&&p.transceivers[c]&&p.transceivers[c].rejected&&(p.transceivers[c]=p._createTransceiver(h,!0));var x,_,A=r.parseRtpParameters(s);g||(x=r.getIceParameters(s,f),(_=r.getDtlsParameters(s,f)).role=\"client\"),O=r.parseRtpEncodingParameters(s);var L=r.parseRtcpParameters(s),I=r.matchPrefix(s,\"a=end-of-candidates\",f).length>0,N=r.matchPrefix(s,\"a=candidate:\").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if((\"offer\"===i.type||\"answer\"===i.type)&&!g&&v&&c>0&&p.transceivers[c]&&(p._disposeIceAndDtlsTransports(c),p.transceivers[c].iceGatherer=p.transceivers[0].iceGatherer,p.transceivers[c].iceTransport=p.transceivers[0].iceTransport,p.transceivers[c].dtlsTransport=p.transceivers[0].dtlsTransport,p.transceivers[c].rtpSender&&p.transceivers[c].rtpSender.setTransport(p.transceivers[0].dtlsTransport),p.transceivers[c].rtpReceiver&&p.transceivers[c].rtpReceiver.setTransport(p.transceivers[0].dtlsTransport)),\"offer\"!==i.type||g){if(\"answer\"===i.type&&!g){w=(S=p.transceivers[c]).iceGatherer,b=S.iceTransport,R=S.dtlsTransport,P=S.rtpReceiver,k=S.sendEncodingParameters,M=S.localCapabilities,p.transceivers[c].recvEncodingParameters=O,p.transceivers[c].remoteCapabilities=A,p.transceivers[c].rtcpParameters=L,N.length&&\"new\"===b.state&&(!m&&!I||v&&0!==c?N.forEach((function(e){o(S.iceTransport,e)})):b.setRemoteCandidates(N)),v&&0!==c||(\"new\"===b.state&&b.start(w,x,\"controlling\"),\"new\"===R.state&&R.start(_)),!a(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return\"rtx\"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,p._transceive(S,\"sendrecv\"===T||\"recvonly\"===T,\"sendrecv\"===T||\"sendonly\"===T),!P||\"sendrecv\"!==T&&\"sendonly\"!==T?delete S.rtpReceiver:(D=P.track,C?(u[C.stream]||(u[C.stream]=new e.MediaStream),n(D,u[C.stream]),l.push([D,P,u[C.stream]])):(u.default||(u.default=new e.MediaStream),n(D,u.default),l.push([D,P,u.default])))}}else{(S=p.transceivers[c]||p._createTransceiver(h)).mid=E,S.iceGatherer||(S.iceGatherer=p._createIceGatherer(c,v)),N.length&&\"new\"===S.iceTransport.state&&(!I||v&&0!==c?N.forEach((function(e){o(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(N)),M=e.RTCRtpReceiver.getCapabilities(h),t<15019&&(M.codecs=M.codecs.filter((function(e){return\"rtx\"!==e.name}))),k=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var F,j=!1;if(\"sendrecv\"===T||\"sendonly\"===T){if(j=!S.rtpReceiver,P=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,h),j)D=P.track,C&&\"-\"===C.stream||(C?(u[C.stream]||(u[C.stream]=new e.MediaStream,Object.defineProperty(u[C.stream],\"id\",{get:function(){return C.stream}})),Object.defineProperty(D,\"id\",{get:function(){return C.track}}),F=u[C.stream]):(u.default||(u.default=new e.MediaStream),F=u.default)),F&&(n(D,F),S.associatedRemoteMediaStreams.push(F)),l.push([D,P,F])}else S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent(\"removetrack\",{track:t}))}(n,t)})),S.associatedRemoteMediaStreams=[]);S.localCapabilities=M,S.remoteCapabilities=A,S.rtpReceiver=P,S.rtcpParameters=L,S.sendEncodingParameters=k,S.recvEncodingParameters=O,p._transceive(p.transceivers[c],!1,j)}}})),void 0===p._dtlsRole&&(p._dtlsRole=\"offer\"===i.type?\"active\":\"passive\"),p._remoteDescription={type:i.type,sdp:i.sdp},\"offer\"===i.type?p._updateSignalingState(\"have-remote-offer\"):p._updateSignalingState(\"stable\"),Object.keys(u).forEach((function(t){var n=u[t];if(n.getTracks().length){if(-1===p.remoteStreams.indexOf(n)){p.remoteStreams.push(n);var r=new Event(\"addstream\");r.stream=n,e.setTimeout((function(){p._dispatchEvent(\"addstream\",r)}))}l.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&d(p,t,r,[n])}))}})),l.forEach((function(e){e[2]||d(p,e[0],e[1],[])})),e.setTimeout((function(){p&&p.transceivers&&p.transceivers.forEach((function(e){e.iceTransport&&\"new\"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn(\"Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification\"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},p.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState(\"closed\")},p.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event(\"signalingstatechange\");this._dispatchEvent(\"signalingstatechange\",t)},p.prototype._maybeFireNegotiationNeeded=function(){var t=this;\"stable\"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event(\"negotiationneeded\");t._dispatchEvent(\"negotiationneeded\",e)}}),0))},p.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e=\"new\",t.failed>0?e=\"failed\":t.checking>0?e=\"checking\":t.disconnected>0?e=\"disconnected\":t.new>0?e=\"new\":t.connected>0?e=\"connected\":t.completed>0&&(e=\"completed\"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event(\"iceconnectionstatechange\");this._dispatchEvent(\"iceconnectionstatechange\",n)}},p.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e=\"new\",t.failed>0?e=\"failed\":t.connecting>0?e=\"connecting\":t.disconnected>0?e=\"disconnected\":t.new>0?e=\"new\":t.connected>0&&(e=\"connected\"),e!==this.connectionState){this.connectionState=e;var n=new Event(\"connectionstatechange\");this._dispatchEvent(\"connectionstatechange\",n)}},p.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not call createOffer after close\"));var a=n.transceivers.filter((function(e){return\"audio\"===e.kind})).length,s=n.transceivers.filter((function(e){return\"video\"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError(\"Legacy mandatory/optional constraints not supported.\");void 0!==o.offerToReceiveAudio&&(a=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(s=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){\"audio\"===e.kind?--a<0&&(e.wantReceive=!1):\"video\"===e.kind&&--s<0&&(e.wantReceive=!1)}));a>0||s>0;)a>0&&(n._createTransceiver(\"audio\"),a--),s>0&&(n._createTransceiver(\"video\"),s--);var d=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,a){var s=i.track,o=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(a,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(o);t<15019&&(d.codecs=d.codecs.filter((function(e){return\"rtx\"!==e.name}))),d.codecs.forEach((function(e){\"H264\"===e.name&&void 0===e.parameters[\"level-asymmetry-allowed\"]&&(e.parameters[\"level-asymmetry-allowed\"]=\"1\"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var p=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];s&&t>=15019&&\"video\"===o&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,o)),i.localCapabilities=d,i.sendEncodingParameters=p})),\"max-compat\"!==n._config.bundlePolicy&&(d+=\"a=group:BUNDLE \"+n.transceivers.map((function(e){return e.mid})).join(\" \")+\"\\r\\n\"),d+=\"a=ice-options:trickle\\r\\n\",n.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,\"offer\",e.stream,n._dtlsRole),d+=\"a=rtcp-rsize\\r\\n\",!e.iceGatherer||\"new\"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+=\"a=\"+r.writeCandidate(e)+\"\\r\\n\"})),\"completed\"===e.iceGatherer.state&&(d+=\"a=end-of-candidates\\r\\n\"))}));var p=new e.RTCSessionDescription({type:\"offer\",sdp:d});return Promise.resolve(p)},p.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c(\"InvalidStateError\",\"Can not call createAnswer after close\"));if(\"have-remote-offer\"!==n.signalingState&&\"have-local-pranswer\"!==n.signalingState)return Promise.reject(c(\"InvalidStateError\",\"Can not call createAnswer in signalingState \"+n.signalingState));var s=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+=\"a=group:BUNDLE \"+n.transceivers.map((function(e){return e.mid})).join(\" \")+\"\\r\\n\"),s+=\"a=ice-options:trickle\\r\\n\";var o=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>o)){if(e.rejected)return\"application\"===e.kind?\"DTLS/SCTP\"===e.protocol?s+=\"m=application 0 DTLS/SCTP 5000\\r\\n\":s+=\"m=application 0 \"+e.protocol+\" webrtc-datachannel\\r\\n\":\"audio\"===e.kind?s+=\"m=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\na=rtpmap:0 PCMU/8000\\r\\n\":\"video\"===e.kind&&(s+=\"m=video 0 UDP/TLS/RTP/SAVPF 120\\r\\na=rtpmap:120 VP8/90000\\r\\n\"),void(s+=\"c=IN IP4 0.0.0.0\\r\\na=inactive\\r\\na=mid:\"+e.mid+\"\\r\\n\");var c;if(e.stream)\"audio\"===e.kind?c=e.stream.getAudioTracks()[0]:\"video\"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&\"video\"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=a(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return\"rtx\"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=i(e,d,\"answer\",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+=\"a=rtcp-rsize\\r\\n\")}}));var d=new e.RTCSessionDescription({type:\"answer\",sdp:s});return Promise.resolve(d)},p.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError(\"sdpMLineIndex or sdpMid required\")):new Promise((function(i,a){if(!n._remoteDescription)return a(c(\"InvalidStateError\",\"Can not add ICE candidate without a remote description\"));if(e&&\"\"!==e.candidate){var s=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){s=d;break}var p=n.transceivers[s];if(!p)return a(c(\"OperationError\",\"Can not add ICE candidate\"));if(p.rejected)return i();var u=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if(\"tcp\"===u.protocol&&(0===u.port||9===u.port))return i();if(u.component&&1!==u.component)return i();if((0===s||s>0&&p.iceTransport!==n.transceivers[0].iceTransport)&&!o(p.iceTransport,u))return a(c(\"OperationError\",\"Can not add ICE candidate\"));var l=e.candidate.trim();0===l.indexOf(\"a=\")&&(l=l.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[s]+=\"a=\"+(u.type?l:\"end-of-candidates\")+\"\\r\\n\",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(\"\")}else for(var h=0;h<n.transceivers.length&&(n.transceivers[h].rejected||(n.transceivers[h].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[h]+=\"a=end-of-candidates\\r\\n\",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(\"\"),!n.usingBundle));h++);i()}))},p.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c(\"InvalidAccessError\",\"Invalid selector.\");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){[\"rtpSender\",\"rtpReceiver\",\"iceGatherer\",\"iceTransport\",\"dtlsTransport\"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};[\"RTCRtpSender\",\"RTCRtpReceiver\",\"RTCIceGatherer\",\"RTCIceTransport\",\"RTCDtlsTransport\"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:\"inbound-rtp\",outboundrtp:\"outbound-rtp\",candidatepair:\"candidate-pair\",localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var u=[\"createOffer\",\"createAnswer\"];return u.forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[0]||\"function\"===typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){\"function\"===typeof e[0]&&e[0].apply(null,[t])}),(function(t){\"function\"===typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"]).forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[1]||\"function\"===typeof e[2]?t.apply(this,arguments).then((function(){\"function\"===typeof e[1]&&e[1].apply(null)}),(function(t){\"function\"===typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),[\"getStats\"].forEach((function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return\"function\"===typeof e[1]?t.apply(this,arguments).then((function(){\"function\"===typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),p}},\"8oxB\":function(e,t){var n,r,i=e.exports={};function a(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n=\"function\"===typeof setTimeout?setTimeout:a}catch(e){n=a}try{r=\"function\"===typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,d=[],p=!1,u=-1;function l(){p&&c&&(p=!1,c.length?d=c.concat(d):u=-1,d.length&&h())}function h(){if(!p){var e=o(l);p=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,p=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||p||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(e){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},DSTq:function(e,t,n){var r=n(\"f2ge\");e.exports=class extends r{setServerUrl(e){this.notImplemented(\"setServerUrl\")}setApp(e){this.notImplemented(\"setApp\")}setRoom(e){this.notImplemented(\"setRoom\")}setWebRtcOptions(e){this.notImplemented(\"setWebRtcOptions\")}setServerConnectListeners(e,t){this.notImplemented(\"setServerConnectListeners\")}setRoomOccupantListener(e){this.notImplemented(\"setRoomOccupantListener\")}setDataChannelListeners(e,t,n){this.notImplemented(\"setDataChannelListeners\")}connect(){this.notImplemented(\"connect\")}shouldStartConnectionTo(e){this.notImplemented(\"shouldStartConnectionTo\")}startStreamConnection(e){this.notImplemented(\"startStreamConnection\")}closeStreamConnection(e){this.notImplemented(\"closeStreamConnection\")}getConnectStatus(e){this.notImplemented(\"getConnectStatus\")}getMediaStream(e){return Promise.reject(\"Interface method not implemented: getMediaStream\")}getServerTime(){this.notImplemented(\"getServerTime\")}sendData(e,t,n){this.notImplemented(\"sendData\")}sendDataGuaranteed(e,t,n){this.notImplemented(\"sendDataGuaranteed\")}broadcastData(e,t){this.notImplemented(\"broadcastData\")}broadcastDataGuaranteed(e,t){this.notImplemented(\"broadcastDataGuaranteed\")}disconnect(){this.notImplemented(\"disconnect\")}}},EYIQ:function(e,t,n){var r=n(\"tvSW\"),i=n(\"iBZa\"),a=n(\"mqsc\"),s=n(\"umSQ\"),o=n(\"G4PH\"),c=n(\"Pozc\"),d=n(\"V8Jh\"),p={app:\"\",room:\"\",clientId:\"\"};p.options=r,p.utils=i,p.log=new a,p.schemas=new s,p.version=\"0.6.1\",p.adapters=new d;var u=new o,l=new c(u);p.connection=l,p.entities=u,e.exports=window.NAF=p},FGiv:function(e,t){var n=1e3,r=60*n,i=60*r,a=24*i,s=7*a,o=365.25*a;function c(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+\" \"+r+(i?\"s\":\"\")}e.exports=function(e,t){t=t||{};var d=typeof e;if(\"string\"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||\"ms\").toLowerCase()){case\"years\":case\"year\":case\"yrs\":case\"yr\":case\"y\":return c*o;case\"weeks\":case\"week\":case\"w\":return c*s;case\"days\":case\"day\":case\"d\":return c*a;case\"hours\":case\"hour\":case\"hrs\":case\"hr\":case\"h\":return c*i;case\"minutes\":case\"minute\":case\"mins\":case\"min\":case\"m\":return c*r;case\"seconds\":case\"second\":case\"secs\":case\"sec\":case\"s\":return c*n;case\"milliseconds\":case\"millisecond\":case\"msecs\":case\"msec\":case\"ms\":return c;default:return}}(e);if(\"number\"===d&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=a)return c(e,t,a,\"day\");if(t>=i)return c(e,t,i,\"hour\");if(t>=r)return c(e,t,r,\"minute\");if(t>=n)return c(e,t,n,\"second\");return e+\" ms\"}(e):function(e){var t=Math.abs(e);if(t>=a)return Math.round(e/a)+\"d\";if(t>=i)return Math.round(e/i)+\"h\";if(t>=r)return Math.round(e/r)+\"m\";if(t>=n)return Math.round(e/n)+\"s\";return e+\"ms\"}(e);throw new Error(\"val is not a non-empty string or a valid number. val=\"+JSON.stringify(e))}},FJvS:function(e,t){AFRAME.registerComponent(\"networked-scene\",{schema:{serverURL:{default:\"/\"},app:{default:\"default\"},room:{default:\"default\"},connectOnLoad:{default:!0},onConnect:{default:\"onConnect\"},adapter:{default:\"wsEasyRtc\"},audio:{default:!1},debug:{default:!1}},init:function(){var e=this.el;this.connect=this.connect.bind(this),e.addEventListener(\"connect\",this.connect),this.data.connectOnLoad&&e.emit(\"connect\",null,!1)},connect:function(){return NAF.log.setDebug(this.data.debug),NAF.log.write(\"Networked-Aframe Connecting...\"),this.checkDeprecatedProperties(),this.setupNetworkAdapter(),this.hasOnConnectFunction()&&this.callOnConnect(),NAF.connection.connect(this.data.serverURL,this.data.app,this.data.room,this.data.audio)},checkDeprecatedProperties:function(){},setupNetworkAdapter:function(){var e=this.data.adapter,t=NAF.adapters.make(e);NAF.connection.setNetworkAdapter(t),this.el.emit(\"adapter-ready\",t,!1)},hasOnConnectFunction:function(){return\"\"!=this.data.onConnect&&window.hasOwnProperty(this.data.onConnect)},callOnConnect:function(){NAF.connection.onConnect(window[this.data.onConnect])},remove:function(){NAF.log.write(\"networked-scene disconnected\"),this.el.removeEventListener(\"connect\",this.connect),NAF.connection.disconnect()}})},G4PH:function(e,t,n){var r=n(\"ozXo\");e.exports=class{constructor(){this.entities={},this.childCache=new r,this.onRemoteEntityCreatedEvent=new Event(\"remoteEntityCreated\"),this._persistentFirstSyncs={}}registerEntity(e,t){this.entities[e]=t}createRemoteEntity(e){NAF.log.write(\"Creating remote entity\",e);var t=e.networkId,n=NAF.schemas.getCachedTemplate(e.template);return this.initPosition(n,e.components),this.initRotation(n,e.components),this.addNetworkComponent(n,e),this.registerEntity(t,n),n}initPosition(e,t){if(t.hasOwnProperty(\"position\")){var n=t.position;e.setAttribute(\"position\",n)}}initRotation(e,t){if(t.hasOwnProperty(\"rotation\")){var n=t.rotation;e.setAttribute(\"rotation\",n)}}addNetworkComponent(e,t){var n={template:t.template,creator:t.creator,owner:t.owner,networkId:t.networkId,persistent:t.persistent};e.setAttribute(\"networked\",n),e.firstUpdateData=t}updateEntityMulti(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource)for(let i=0,a=n.d.length;i<a;i++)this.updateEntity(e,\"u\",n.d[i],r)}updateEntity(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource){var i=n.networkId;this.hasEntity(i)?this.entities[i].components.networked.networkUpdate(n):n.isFirstSync&&(NAF.options.firstSyncSource&&r!==NAF.options.firstSyncSource?NAF.log.write(\"Ignoring first sync from disallowed source\",r):n.persistent?this._persistentFirstSyncs[i]=n:this.receiveFirstUpdateFromEntity(n))}}receiveFirstUpdateFromEntity(e){var t=e.parent,n=e.networkId;if(t&&!this.hasEntity(t))this.childCache.addChild(t,e);else{var r=this.createRemoteEntity(e);this.createAndAppendChildren(n,r),this.addEntityToPage(r,t)}}createAndAppendChildren(e,t){for(var n=this.childCache.getChildren(e),r=0;r<n.length;r++){var i=n[r],a=i.networkId;if(this.hasEntity(a))NAF.log.warn(\"Tried to instantiate entity multiple times\",a,i,\"Existing entity:\",this.getEntity(a));else{var s=this.createRemoteEntity(i);this.createAndAppendChildren(a,s),t.appendChild(s)}}}addEntityToPage(e,t){this.hasEntity(t)?this.addEntityToParent(e,t):this.addEntityToSceneRoot(e)}addEntityToParent(e,t){this.entities[t].appendChild(e)}addEntityToSceneRoot(e){document.querySelector(\"a-scene\").appendChild(e)}completeSync(e,t){for(var n in this.entities)this.entities.hasOwnProperty(n)&&this.entities[n].components.networked.syncAll(e,t)}removeRemoteEntity(e,t,n,r){if(!NAF.options.syncSource||r===NAF.options.syncSource){var i=n.networkId;return this.removeEntity(i)}}removeEntitiesOfClient(e){var t=[];for(var n in this.entities){if(NAF.utils.getCreator(this.entities[n])===e){let e;const i=this.entities[n].getAttribute(\"networked\");if(i&&i.persistent&&(e=NAF.utils.isMine(this.entities[n])||NAF.utils.takeOwnership(this.entities[n])),!e){var r=this.removeEntity(n);t.push(r)}}}return t}removeEntity(e){if(this.forgetPersistentFirstSync(e),this.hasEntity(e)){var t=this.entities[e];return this.forgetEntity(e),t.parentNode.removeChild(t),t}return NAF.log.error(\"Tried to remove entity I don't have.\"),null}forgetEntity(e){delete this.entities[e],this.forgetPersistentFirstSync(e)}getPersistentFirstSync(e){return this._persistentFirstSyncs[e]}forgetPersistentFirstSync(e){delete this._persistentFirstSyncs[e]}getEntity(e){return this.entities.hasOwnProperty(e)?this.entities[e]:null}hasEntity(e){return this.entities.hasOwnProperty(e)}removeRemoteEntities(){for(var e in this.childCache=new r,this.entities){this.entities[e].getAttribute(\"networked\").owner!=NAF.clientId&&this.removeEntity(e)}}}},GAh6:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports=function(e,t){var i=e&&e.window,a={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);var o=r.log,c=r.detectBrowser(i),d=n(\"+phH\")||null,p=n(\"sJPo\")||null,u=n(\"Mupt\")||null,l=n(\"goMv\")||null,h=n(\"ggQn\")||null,f={browserDetails:c,commonShim:h,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case\"chrome\":if(!d||!d.shimPeerConnection||!a.shimChrome)return o(\"Chrome shim is not included in this adapter release.\"),f;o(\"adapter.js shimming chrome.\"),f.browserShim=d,h.shimCreateObjectURL(i),d.shimGetUserMedia(i),d.shimMediaStream(i),d.shimSourceObject(i),d.shimPeerConnection(i),d.shimOnTrack(i),d.shimAddTrackRemoveTrack(i),d.shimGetSendersWithDtmf(i),d.shimSenderReceiverGetStats(i),d.fixNegotiationNeeded(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"firefox\":if(!u||!u.shimPeerConnection||!a.shimFirefox)return o(\"Firefox shim is not included in this adapter release.\"),f;o(\"adapter.js shimming firefox.\"),f.browserShim=u,h.shimCreateObjectURL(i),u.shimGetUserMedia(i),u.shimSourceObject(i),u.shimPeerConnection(i),u.shimOnTrack(i),u.shimRemoveStream(i),u.shimSenderGetStats(i),u.shimReceiverGetStats(i),u.shimRTCDataChannel(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"edge\":if(!p||!p.shimPeerConnection||!a.shimEdge)return o(\"MS edge shim is not included in this adapter release.\"),f;o(\"adapter.js shimming edge.\"),f.browserShim=p,h.shimCreateObjectURL(i),p.shimGetUserMedia(i),p.shimPeerConnection(i),p.shimReplaceTrack(i),p.shimGetDisplayMedia(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;case\"safari\":if(!l||!a.shimSafari)return o(\"Safari shim is not included in this adapter release.\"),f;o(\"adapter.js shimming safari.\"),f.browserShim=l,h.shimCreateObjectURL(i),l.shimRTCIceServerUrls(i),l.shimCreateOfferLegacy(i),l.shimCallbacksAPI(i),l.shimLocalStreamsAPI(i),l.shimRemoteStreamsAPI(i),l.shimTrackEventTransceiver(i),l.shimGetUserMedia(i),h.shimRTCIceCandidate(i),h.shimMaxMessageSize(i),h.shimSendThrowTypeError(i);break;default:o(\"Unsupported browser!\")}return f}},JX7q:function(e,t,n){\"use strict\";function r(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}n.d(t,\"a\",(function(){return r}))},Ji7U:function(e,t,n){\"use strict\";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if(\"function\"!==typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,\"a\",(function(){return i}))},KCt4:function(e,t,n){\"use strict\";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split(\"\\n\").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split(\"\\nm=\").map((function(e,t){return(t>0?\"m=\"+e:e).trim()+\"\\r\\n\"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf(\"a=candidate:\")?e.substring(12).split(\" \"):e.substring(10).split(\" \"))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case\"raddr\":n.relatedAddress=t[r+1];break;case\"rport\":n.relatedPort=parseInt(t[r+1],10);break;case\"tcptype\":n.tcpType=t[r+1];break;case\"ufrag\":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push(\"typ\"),t.push(n),\"host\"!==n&&e.relatedAddress&&e.relatedPort&&(t.push(\"raddr\"),t.push(e.relatedAddress),t.push(\"rport\"),t.push(e.relatedPort)),e.tcpType&&\"tcp\"===e.protocol.toLowerCase()&&(t.push(\"tcptype\"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push(\"ufrag\"),t.push(e.usernameFragment||e.ufrag)),\"candidate:\"+t.join(\" \")},r.parseIceOptions=function(e){return e.substr(14).split(\" \")},r.parseRtpMap=function(e){var t=e.substr(9).split(\" \"),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split(\"/\"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return\"a=rtpmap:\"+t+\" \"+e.name+\"/\"+e.clockRate+(1!==n?\"/\"+n:\"\")+\"\\r\\n\"},r.parseExtmap=function(e){var t=e.substr(9).split(\" \");return{id:parseInt(t[0],10),direction:t[0].indexOf(\"/\")>0?t[0].split(\"/\")[1]:\"sendrecv\",uri:t[1]}},r.writeExtmap=function(e){return\"a=extmap:\"+(e.id||e.preferredId)+(e.direction&&\"sendrecv\"!==e.direction?\"/\"+e.direction:\"\")+\" \"+e.uri+\"\\r\\n\"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(\" \")+1).split(\";\"),i=0;i<r.length;i++)n[(t=r[i].trim().split(\"=\"))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t=\"\",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+\"=\"+e.parameters[t]):r.push(t)})),t+=\"a=fmtp:\"+n+\" \"+r.join(\";\")+\"\\r\\n\"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(\" \")+1).split(\" \");return{type:t.shift(),parameter:t.join(\" \")}},r.writeRtcpFb=function(e){var t=\"\",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+=\"a=rtcp-fb:\"+n+\" \"+e.type+(e.parameter&&e.parameter.length?\" \"+e.parameter:\"\")+\"\\r\\n\"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(\" \"),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(\":\",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(\" \");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,\"a=mid:\")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(\" \");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:\"auto\",fingerprints:r.matchPrefix(e+t,\"a=fingerprint:\").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n=\"a=setup:\"+t+\"\\r\\n\";return e.fingerprints.forEach((function(e){n+=\"a=fingerprint:\"+e.algorithm+\" \"+e.value+\"\\r\\n\"})),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(\" \");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return\"a=crypto:\"+e.tag+\" \"+e.cryptoSuite+\" \"+(\"object\"===typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?\" \"+e.sessionParams.join(\" \"):\"\")+\"\\r\\n\"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf(\"inline:\"))return null;var t=e.substr(7).split(\"|\");return{keyMethod:\"inline\",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(\":\")[0]:void 0,mkiLength:t[2]?t[2].split(\":\")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+\":\"+e.keySalt+(e.lifeTime?\"|\"+e.lifeTime:\"\")+(e.mkiValue&&e.mkiLength?\"|\"+e.mkiValue+\":\"+e.mkiLength:\"\")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,\"a=crypto:\").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,\"a=ice-ufrag:\")[0],i=r.matchPrefix(e+t,\"a=ice-pwd:\")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return\"a=ice-ufrag:\"+e.usernameFragment+\"\\r\\na=ice-pwd:\"+e.password+\"\\r\\n\"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(\" \"),i=3;i<n.length;i++){var a=n[i],s=r.matchPrefix(e,\"a=rtpmap:\"+a+\" \")[0];if(s){var o=r.parseRtpMap(s),c=r.matchPrefix(e,\"a=fmtp:\"+a+\" \");switch(o.parameters=c.length?r.parseFmtp(c[0]):{},o.rtcpFeedback=r.matchPrefix(e,\"a=rtcp-fb:\"+a+\" \").map(r.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case\"RED\":case\"ULPFEC\":t.fecMechanisms.push(o.name.toUpperCase())}}}return r.matchPrefix(e,\"a=extmap:\").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n=\"\";n+=\"m=\"+e+\" \",n+=t.codecs.length>0?\"9\":\"0\",n+=\" UDP/TLS/RTP/SAVPF \",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(\" \")+\"\\r\\n\",n+=\"c=IN IP4 0.0.0.0\\r\\n\",n+=\"a=rtcp:9 IN IP4 0.0.0.0\\r\\n\",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+=\"a=maxptime:\"+i+\"\\r\\n\"),n+=\"a=rtcp-mux\\r\\n\",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf(\"RED\"),s=-1!==i.fecMechanisms.indexOf(\"ULPFEC\"),o=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"cname\"===e.attribute})),c=o.length>0&&o[0].ssrc,d=r.matchPrefix(e,\"a=ssrc-group:FID\").map((function(e){return e.substr(17).split(\" \").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),i.codecs.forEach((function(e){if(\"RTX\"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),a&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:s?\"red+ulpfec\":\"red\"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var p=r.matchPrefix(e,\"b=\");return p.length&&(p=0===p[0].indexOf(\"b=TIAS:\")?parseInt(p[0].substr(7),10):0===p[0].indexOf(\"b=AS:\")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=p}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"cname\"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,\"a=rtcp-rsize\");t.reducedSize=i.length>0,t.compound=0===i.length;var a=r.matchPrefix(e,\"a=rtcp-mux\");return t.mux=a.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,\"a=msid:\");if(1===n.length)return{stream:(t=n[0].substr(7).split(\" \"))[0],track:t[1]};var i=r.matchPrefix(e,\"a=ssrc:\").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return\"msid\"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(\" \"))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,\"a=max-message-size:\");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var a=r.matchPrefix(e,\"a=sctp-port:\");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,\"a=sctpmap:\").length>0){var s=r.matchPrefix(e,\"a=sctpmap:\")[0].substr(10).split(\" \");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n=\"DTLS/SCTP\"!==e.protocol?[\"m=\"+e.kind+\" 9 \"+e.protocol+\" \"+t.protocol+\"\\r\\n\",\"c=IN IP4 0.0.0.0\\r\\n\",\"a=sctp-port:\"+t.port+\"\\r\\n\"]:[\"m=\"+e.kind+\" 9 \"+e.protocol+\" \"+t.port+\"\\r\\n\",\"c=IN IP4 0.0.0.0\\r\\n\",\"a=sctpmap:\"+t.port+\" \"+t.protocol+\" 65535\\r\\n\"],void 0!==t.maxMessageSize&&n.push(\"a=max-message-size:\"+t.maxMessageSize+\"\\r\\n\"),n.join(\"\")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return\"v=0\\r\\no=\"+(n||\"thisisadapterortc\")+\" \"+(e||r.generateSessionId())+\" \"+i+\" IN IP4 127.0.0.1\\r\\ns=-\\r\\nt=0 0\\r\\n\"},r.writeMediaSection=function(e,t,n,i){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),\"offer\"===n?\"actpass\":\"active\"),a+=\"a=mid:\"+e.mid+\"\\r\\n\",e.direction?a+=\"a=\"+e.direction+\"\\r\\n\":e.rtpSender&&e.rtpReceiver?a+=\"a=sendrecv\\r\\n\":e.rtpSender?a+=\"a=sendonly\\r\\n\":e.rtpReceiver?a+=\"a=recvonly\\r\\n\":a+=\"a=inactive\\r\\n\",e.rtpSender){var s=\"msid:\"+i.id+\" \"+e.rtpSender.track.id+\"\\r\\n\";a+=\"a=\"+s,a+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" \"+s,e.sendEncodingParameters[0].rtx&&(a+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" \"+s,a+=\"a=ssrc-group:FID \"+e.sendEncodingParameters[0].ssrc+\" \"+e.sendEncodingParameters[0].rtx.ssrc+\"\\r\\n\")}return a+=\"a=ssrc:\"+e.sendEncodingParameters[0].ssrc+\" cname:\"+r.localCName+\"\\r\\n\",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+=\"a=ssrc:\"+e.sendEncodingParameters[0].rtx.ssrc+\" cname:\"+r.localCName+\"\\r\\n\"),a},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case\"a=sendrecv\":case\"a=sendonly\":case\"a=recvonly\":case\"a=inactive\":return n[i].substr(2)}return t?r.getDirection(t):\"sendrecv\"},r.getKind=function(e){return r.splitLines(e)[0].split(\" \")[0].substr(2)},r.isRejected=function(e){return\"0\"===e.split(\" \",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(\" \");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(\" \")}},r.parseOLine=function(e){var t=r.matchPrefix(e,\"o=\")[0].substr(2).split(\" \");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if(\"string\"!==typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||\"=\"!==t[n].charAt(1))return!1;return!0},e.exports=r},Mupt:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports={shimGetUserMedia:n(\"pXin\"),shimOnTrack:function(e){\"object\"!==typeof e||!e.RTCPeerConnection||\"ontrack\"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,\"ontrack\",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener(\"track\",this._ontrack),this.removeEventListener(\"addstream\",this._ontrackpoly)),this.addEventListener(\"track\",this._ontrack=e),this.addEventListener(\"addstream\",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event(\"track\");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))},enumerable:!0,configurable:!0}),\"object\"===typeof e&&e.RTCTrackEvent&&\"receiver\"in e.RTCTrackEvent.prototype&&!(\"transceiver\"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,\"transceiver\",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){\"object\"===typeof e&&(!e.HTMLMediaElement||\"srcObject\"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,\"srcObject\",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(\"object\"===typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,r){if(t.version<38&&n&&n.iceServers){for(var i=[],a=0;a<n.iceServers.length;a++){var s=n.iceServers[a];if(s.hasOwnProperty(\"urls\"))for(var o=0;o<s.urls.length;o++){var c={url:s.urls[o]};0===s.urls[o].indexOf(\"turn\")&&(c.username=s.username,c.credential=s.credential),i.push(c)}else i.push(n.iceServers[a])}n.iceServers=i}return new e.mozRTCPeerConnection(n,r)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),[\"setLocalDescription\",\"setRemoteDescription\",\"addIceCandidate\"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new(\"addIceCandidate\"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:\"inbound-rtp\",outboundrtp:\"outbound-rtp\",candidatepair:\"candidate-pair\",localcandidate:\"local-candidate\",remotecandidate:\"remote-candidate\"},a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){return a.apply(this,[e||null]).then((function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n]),t[n]=e[n]})),t}(e)),t.version<53&&!n)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(r){if(\"TypeError\"!==r.name)throw r;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(n,r)}}},shimSenderGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&\"getStats\"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&\"getStats\"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(e,[]);return n.forEach((function(t){t._pc=e})),n}),r.wrapPeerConnectionEvent(e,\"track\",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||\"removeStream\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated(\"removeStream\",\"removeTrack\"),this.getSenders().forEach((function(n){n.track&&-1!==e.getTracks().indexOf(n.track)&&t.removeTrack(n)}))})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){!e.navigator||!e.navigator.mediaDevices||\"getDisplayMedia\"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException(\"getDisplayMedia without video constraints is undefined\");return r.name=\"NotFoundError\",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),e.navigator.mediaDevices.getDisplayMedia(t)})}}},Pozc:function(e,t){var n={Update:\"u\",UpdateMulti:\"um\",Remove:\"r\"};e.exports=class{constructor(e){this.entities=e,this.setupDefaultDataSubscriptions(),this.connectedClients={},this.activeDataChannels={}}setNetworkAdapter(e){this.adapter=e}setupDefaultDataSubscriptions(){this.dataChannelSubs={},this.dataChannelSubs[n.Update]=this.entities.updateEntity.bind(this.entities),this.dataChannelSubs[n.UpdateMulti]=this.entities.updateEntityMulti.bind(this.entities),this.dataChannelSubs[n.Remove]=this.entities.removeRemoteEntity.bind(this.entities)}connect(e,t,n,r=!1){NAF.app=t,NAF.room=n,this.adapter.setServerUrl(e),this.adapter.setApp(t),this.adapter.setRoom(n);var i={audio:r,video:!1,datachannel:!0};return this.adapter.setWebRtcOptions(i),this.adapter.setServerConnectListeners(this.connectSuccess.bind(this),this.connectFailure.bind(this)),this.adapter.setDataChannelListeners(this.dataChannelOpen.bind(this),this.dataChannelClosed.bind(this),this.receivedData.bind(this)),this.adapter.setRoomOccupantListener(this.occupantsReceived.bind(this)),this.adapter.connect()}onConnect(e){this.onConnectCallback=e,this.isConnected()?e():document.body.addEventListener(\"connected\",e,!1)}connectSuccess(e){NAF.log.write(\"Networked-Aframe Client ID:\",e),NAF.clientId=e;var t=new CustomEvent(\"connected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}connectFailure(e,t){NAF.log.error(e,\"failure to connect\")}occupantsReceived(e){var t=Object.assign({},this.connectedClients);this.connectedClients=e,this.checkForDisconnectingClients(t,e),this.checkForConnectingClients(e)}checkForDisconnectingClients(e,t){for(var n in e){t.hasOwnProperty(n)||(NAF.log.write(\"Closing stream to \",n),this.adapter.closeStreamConnection(n))}}checkForConnectingClients(e){for(var t in e){this.isNewClient(t)&&this.adapter.shouldStartConnectionTo(e[t])&&(NAF.log.write(\"Opening datachannel to \",t),this.adapter.startStreamConnection(t))}}getConnectedClients(){return this.connectedClients}isConnected(){return!!NAF.clientId}isMineAndConnected(e){return this.isConnected()&&NAF.clientId===e}isNewClient(e){return!this.isConnectedTo(e)}isConnectedTo(e){return this.adapter.getConnectStatus(e)===NAF.adapters.IS_CONNECTED}dataChannelOpen(e){NAF.log.write(\"Opened data channel from \"+e),this.activeDataChannels[e]=!0,this.entities.completeSync(e,!0);var t=new CustomEvent(\"clientConnected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}dataChannelClosed(e){NAF.log.write(\"Closed data channel from \"+e),this.activeDataChannels[e]=!1,this.entities.removeEntitiesOfClient(e);var t=new CustomEvent(\"clientDisconnected\",{detail:{clientId:e}});document.body.dispatchEvent(t)}hasActiveDataChannel(e){return this.activeDataChannels.hasOwnProperty(e)&&this.activeDataChannels[e]}broadcastData(e,t){this.adapter.broadcastData(e,t)}broadcastDataGuaranteed(e,t){this.adapter.broadcastDataGuaranteed(e,t)}sendData(e,t,n,r){this.hasActiveDataChannel(e)&&(r?this.adapter.sendDataGuaranteed(e,t,n):this.adapter.sendData(e,t,n))}sendDataGuaranteed(e,t,n){this.sendData(e,t,n,!0)}subscribeToDataChannel(e,t){this.isReservedDataType(e)?NAF.log.error(\"NetworkConnection@subscribeToDataChannel: \"+e+\" is a reserved dataType. Choose another\"):this.dataChannelSubs[e]=t}unsubscribeToDataChannel(e){this.isReservedDataType(e)?NAF.log.error(\"NetworkConnection@unsubscribeToDataChannel: \"+e+\" is a reserved dataType. Choose another\"):delete this.dataChannelSubs[e]}isReservedDataType(e){return e==n.Update||e==n.Remove}receivedData(e,t,n,r){this.dataChannelSubs.hasOwnProperty(t)?this.dataChannelSubs[t](e,t,n,r):NAF.log.write(\"NetworkConnection@receivedData: \"+t+\" has not been subscribed to yet. Call subscribeToDataChannel()\")}getServerTime(){return this.adapter.getServerTime()}disconnect(){this.entities.removeRemoteEntities(),this.adapter.disconnect(),NAF.app=\"\",NAF.room=\"\",NAF.clientId=\"\",this.connectedClients={},this.activeDataChannels={},this.adapter=null,this.setupDefaultDataSubscriptions(),document.body.removeEventListener(\"connected\",this.onConnectCallback)}}},Qetd:function(e,t,n){\"use strict\";var r=Object.assign.bind(Object);e.exports=r,e.exports.default=e.exports},STrH:function(e,t,n){var r=n(\"VKE9\"),i=n(\"KCt4\"),a=n(\"vPXE\")(\"naf-janus-adapter:debug\"),s=(n(\"vPXE\")(\"naf-janus-adapter:warn\"),n(\"vPXE\")(\"naf-janus-adapter:error\")),o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);const c=15e3;function d(e){var t=Promise.resolve();return function(){var n=Array.prototype.slice.call(arguments);t=t.then(t=>e.apply(this,n))}}function p(e){return new Promise((t,n)=>{if(\"open\"===e.readyState)t();else{let r,i;const a=()=>{e.removeEventListener(\"open\",r),e.removeEventListener(\"error\",i)};r=()=>{a(),t()},i=()=>{a(),n()},e.addEventListener(\"open\",r),e.addEventListener(\"error\",i)}})}const u=\"\"!==document.createElement(\"video\").canPlayType('video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"'),l={usedtx:1,stereo:0,\"sprop-stereo\":0},h={iceServers:[{urls:\"stun:stun1.l.google.com:19302\"},{urls:\"stun:stun2.l.google.com:19302\"}]},f=1e3;class m{constructor(){this.room=null,this.clientId=null,this.joinToken=null,this.serverUrl=null,this.webRtcOptions={},this.peerConnectionConfig=null,this.ws=null,this.session=null,this.reliableTransport=\"datachannel\",this.unreliableTransport=\"datachannel\",this.initialReconnectionDelay=1e3*Math.random(),this.reconnectionDelay=this.initialReconnectionDelay,this.reconnectionTimeout=null,this.maxReconnectionAttempts=10,this.reconnectionAttempts=0,this.publisher=null,this.occupants={},this.leftOccupants=new Set,this.mediaStreams={},this.localMediaStream=null,this.pendingMediaRequests=new Map,this.blockedClients=new Map,this.frozenUpdates=new Map,this.timeOffsets=[],this.serverTimeRequests=0,this.avgTimeOffset=0,this.onWebsocketOpen=this.onWebsocketOpen.bind(this),this.onWebsocketClose=this.onWebsocketClose.bind(this),this.onWebsocketMessage=this.onWebsocketMessage.bind(this),this.onDataChannelMessage=this.onDataChannelMessage.bind(this),this.onData=this.onData.bind(this)}setServerUrl(e){this.serverUrl=e}setApp(e){}setRoom(e){this.room=e}setJoinToken(e){this.joinToken=e}setClientId(e){this.clientId=e}setWebRtcOptions(e){this.webRtcOptions=e}setPeerConnectionConfig(e){this.peerConnectionConfig=e}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.onOccupantsChanged=e}setDataChannelListeners(e,t,n){this.onOccupantConnected=e,this.onOccupantDisconnected=t,this.onOccupantMessage=n}setReconnectionListeners(e,t,n){this.onReconnecting=e,this.onReconnected=t,this.onReconnectionError=n}connect(){a(`connecting to ${this.serverUrl}`);const e=new Promise((e,t)=>{let n;this.ws=new WebSocket(this.serverUrl,\"janus-protocol\"),this.session=new r.JanusSession(this.ws.send.bind(this.ws),{timeoutMs:3e4});const i=()=>{t(s)};this.ws.addEventListener(\"close\",this.onWebsocketClose),this.ws.addEventListener(\"message\",this.onWebsocketMessage),n=()=>{this.ws.removeEventListener(\"open\",n),this.ws.removeEventListener(\"error\",i),this.onWebsocketOpen().then(e).catch(t)},this.ws.addEventListener(\"open\",n)});return Promise.all([e,this.updateTimeOffset()])}disconnect(){a(\"disconnecting\"),clearTimeout(this.reconnectionTimeout),this.removeAllOccupants(),this.leftOccupants=new Set,this.publisher&&(this.publisher.conn.close(),this.publisher=null),this.session&&(this.session.dispose(),this.session=null),this.ws&&(this.ws.removeEventListener(\"open\",this.onWebsocketOpen),this.ws.removeEventListener(\"close\",this.onWebsocketClose),this.ws.removeEventListener(\"message\",this.onWebsocketMessage),this.ws.close(),this.ws=null)}isDisconnected(){return null===this.ws}async onWebsocketOpen(){await this.session.create(),this.publisher=await this.createPublisher(),this.connectSuccess(this.clientId);const e=[];for(let t=0;t<this.publisher.initialOccupants.length;t++){const n=this.publisher.initialOccupants[t];n!==this.clientId&&e.push(this.addOccupant(n))}await Promise.all(e)}onWebsocketClose(e){e.code!==f&&(this.onReconnecting&&this.onReconnecting(this.reconnectionDelay),this.reconnectionTimeout=setTimeout(()=>this.reconnect(),this.reconnectionDelay))}reconnect(){this.disconnect(),this.connect().then(()=>{this.reconnectionDelay=this.initialReconnectionDelay,this.reconnectionAttempts=0,this.onReconnected&&this.onReconnected()}).catch(e=>{if(this.reconnectionDelay+=1e3,this.reconnectionAttempts++,this.reconnectionAttempts>this.maxReconnectionAttempts&&this.onReconnectionError)return this.onReconnectionError(new Error(\"Connection could not be reestablished, exceeded maximum number of reconnection attempts.\"));console.warn(\"Error during reconnect, retrying.\"),console.warn(e),this.onReconnecting&&this.onReconnecting(this.reconnectionDelay),this.reconnectionTimeout=setTimeout(()=>this.reconnect(),this.reconnectionDelay)})}performDelayedReconnect(){this.delayedReconnectTimeout&&clearTimeout(this.delayedReconnectTimeout),this.delayedReconnectTimeout=setTimeout(()=>{this.delayedReconnectTimeout=null,this.reconnect()},1e4)}onWebsocketMessage(e){this.session.receive(JSON.parse(e.data))}async addOccupant(e){this.occupants[e]&&this.removeOccupant(e),this.leftOccupants.delete(e);var t=await this.createSubscriber(e);if(t)return this.occupants[e]=t,this.setMediaStream(e,t.mediaStream),this.onOccupantConnected(e),this.onOccupantsChanged(this.occupants),t}removeAllOccupants(){for(const e of Object.getOwnPropertyNames(this.occupants))this.removeOccupant(e)}removeOccupant(e){if(this.leftOccupants.add(e),this.occupants[e]){if(this.occupants[e]&&(this.occupants[e].conn.close(),delete this.occupants[e]),this.mediaStreams[e]&&delete this.mediaStreams[e],this.pendingMediaRequests.has(e)){const t=\"The user disconnected before the media stream was resolved.\";this.pendingMediaRequests.get(e).audio.reject(t),this.pendingMediaRequests.get(e).video.reject(t),this.pendingMediaRequests.delete(e)}this.onOccupantDisconnected(e),this.onOccupantsChanged(this.occupants)}}associate(e,t){e.addEventListener(\"icecandidate\",e=>{t.sendTrickle(e.candidate||null).catch(e=>s(\"Error trickling ICE: %o\",e))}),e.addEventListener(\"iceconnectionstatechange\",t=>{\"failed\"===e.iceConnectionState&&(console.warn(\"ICE failure detected. Reconnecting in 10s.\"),this.performDelayedReconnect())}),e.addEventListener(\"negotiationneeded\",d(n=>{a(\"Sending new offer for handle: %o\",t);var r=e.createOffer().then(this.configurePublisherSdp).then(this.fixSafariIceUFrag),i=r.then(t=>e.setLocalDescription(t)),o=r;return o=o.then(this.fixSafariIceUFrag).then(e=>t.sendJsep(e)).then(t=>e.setRemoteDescription(t.jsep)),Promise.all([i,o]).catch(e=>s(\"Error negotiating offer: %o\",e))})),t.on(\"event\",d(n=>{var r=n.jsep;if(r&&\"offer\"==r.type){a(\"Accepting new offer for handle: %o\",t);var i=e.setRemoteDescription(this.configureSubscriberSdp(r)).then(t=>e.createAnswer()).then(this.fixSafariIceUFrag),o=i.then(t=>e.setLocalDescription(t)),c=i.then(e=>t.sendJsep(e));return Promise.all([o,c]).catch(e=>s(\"Error negotiating answer: %o\",e))}return null}))}async createPublisher(){var e=new r.JanusPluginHandle(this.session),t=new RTCPeerConnection(this.peerConnectionConfig||h);a(\"pub waiting for sfu\"),await e.attach(\"janus.plugin.sfu\"),this.associate(t,e),a(\"pub waiting for data channels & webrtcup\");var n=new Promise(t=>e.on(\"webrtcup\",t)),i=t.createDataChannel(\"reliable\",{ordered:!0}),s=t.createDataChannel(\"unreliable\",{ordered:!1,maxRetransmits:0});i.addEventListener(\"message\",e=>this.onDataChannelMessage(e,\"janus-reliable\")),s.addEventListener(\"message\",e=>this.onDataChannelMessage(e,\"janus-unreliable\")),await n,await p(i),await p(s),this.localMediaStream&&this.localMediaStream.getTracks().forEach(e=>{t.addTrack(e,this.localMediaStream)}),e.on(\"event\",e=>{var t=e.plugindata.data;\"join\"==t.event&&t.room_id==this.room?this.addOccupant(t.user_id):\"leave\"==t.event&&t.room_id==this.room?this.removeOccupant(t.user_id):\"blocked\"==t.event?document.body.dispatchEvent(new CustomEvent(\"blocked\",{detail:{clientId:t.by}})):\"unblocked\"==t.event?document.body.dispatchEvent(new CustomEvent(\"unblocked\",{detail:{clientId:t.by}})):\"data\"===t.event&&this.onData(JSON.parse(t.body),\"janus-event\")}),a(\"pub waiting for join\");var o=await this.sendJoin(e,{notifications:!0,data:!0});if(!o.plugindata.data.success){const e=o.plugindata.data.error;throw console.error(e),e}var c=o.plugindata.data.response.users[this.room]||[];return c.includes(this.clientId)&&(console.warn(\"Janus still has previous session for this client. Reconnecting in 10s.\"),this.performDelayedReconnect()),a(\"publisher ready\"),{handle:e,initialOccupants:c,reliableChannel:i,unreliableChannel:s,conn:t}}configurePublisherSdp(e){return e.sdp=e.sdp.replace(/a=fmtp:(109|111).*\\r\\n/g,(e,t)=>{const n=Object.assign(i.parseFmtp(e),l);return i.writeFmtp({payloadType:t,parameters:n})}),e}configureSubscriberSdp(e){return u||-1!==navigator.userAgent.indexOf(\"HeadlessChrome\")&&(e.sdp=e.sdp.replace(/m=video[^]*m=/,\"m=\")),-1===navigator.userAgent.indexOf(\"Android\")?e.sdp=e.sdp.replace(\"a=rtcp-fb:107 goog-remb\\r\\n\",\"a=rtcp-fb:107 goog-remb\\r\\na=rtcp-fb:107 transport-cc\\r\\na=fmtp:107 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f\\r\\n\"):e.sdp=e.sdp.replace(\"a=rtcp-fb:107 goog-remb\\r\\n\",\"a=rtcp-fb:107 goog-remb\\r\\na=rtcp-fb:107 transport-cc\\r\\na=fmtp:107 level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42001f\\r\\n\"),e}async fixSafariIceUFrag(e){return e.sdp=e.sdp.replace(/[^\\r]\\na=ice-ufrag/g,\"\\r\\na=ice-ufrag\"),e}async createSubscriber(e){if(this.leftOccupants.has(e))return console.warn(e+\": cancelled occupant connection, occupant left before subscription negotation.\"),null;var t=new r.JanusPluginHandle(this.session),n=new RTCPeerConnection(this.peerConnectionConfig||h);if(a(e+\": sub waiting for sfu\"),await t.attach(\"janus.plugin.sfu\"),this.associate(n,t),a(e+\": sub waiting for join\"),this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancelled occupant connection, occupant left after attach\"),null;let i=!1;const s=new Promise(n=>{const r=setInterval(()=>{this.leftOccupants.has(e)&&(clearInterval(r),n())},1e3),a=setTimeout(()=>{clearInterval(r),i=!0,n()},c);t.on(\"webrtcup\",()=>{clearTimeout(a),clearInterval(r),n()})});await this.sendJoin(t,{media:e});if(this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancelled occupant connection, occupant left after join\"),null;if(a(e+\": sub waiting for webrtcup\"),await s,this.leftOccupants.has(e))return n.close(),console.warn(e+\": cancel occupant connection, occupant left during or after webrtcup\"),null;if(i)return n.close(),console.warn(e+\": webrtc up timed out\"),null;o&&!this._iOSHackDelayedInitialPeer&&(await new Promise(e=>setTimeout(e,3e3)),this._iOSHackDelayedInitialPeer=!0);var d=new MediaStream;return n.getReceivers().forEach(e=>{e.track&&d.addTrack(e.track)}),0===d.getTracks().length&&(d=null),a(e+\": subscriber ready\"),{handle:t,mediaStream:d,conn:n}}sendJoin(e,t){return e.sendMessage({kind:\"join\",room_id:this.room,user_id:this.clientId,subscribe:t,token:this.joinToken})}toggleFreeze(){this.frozen?this.unfreeze():this.freeze()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1,this.flushPendingUpdates()}dataForUpdateMultiMessage(e,t){for(let n=0,r=t.data.d.length;n<r;n++){const r=t.data.d[n];if(r.networkId===e)return r}return null}getPendingData(e,t){if(!t)return null;let n=\"um\"===t.dataType?this.dataForUpdateMultiMessage(e,t):t.data;return n.owner&&!this.occupants[n.owner]?null:n.owner&&this.blockedClients.has(n.owner)?null:n}getPendingDataForNetworkId(e){return this.getPendingData(e,this.frozenUpdates.get(e))}flushPendingUpdates(){for(const[e,t]of this.frozenUpdates){let n=this.getPendingData(e,t);if(!n)continue;const r=\"um\"===t.dataType?\"u\":t.dataType;this.onOccupantMessage(null,r,n,t.source)}this.frozenUpdates.clear()}storeMessage(e){if(\"um\"===e.dataType)for(let t=0,n=e.data.d.length;t<n;t++)this.storeSingleMessage(e,t);else this.storeSingleMessage(e)}storeSingleMessage(e,t){const n=void 0!==t?e.data.d[t]:e.data,r=e.dataType,i=(e.source,n.networkId);if(this.frozenUpdates.has(i)){const t=this.frozenUpdates.get(i),a=\"um\"===t.dataType?this.dataForUpdateMultiMessage(i,t):t.data,s=n.lastOwnerTime<a.lastOwnerTime,o=n.lastOwnerTime===a.lastOwnerTime;if(s||o&&a.owner>n.owner)return;if(\"r\"===r){a&&a.isFirstSync?this.frozenUpdates.delete(i):this.frozenUpdates.set(i,e)}else a.components&&n.components&&Object.assign(a.components,n.components)}else this.frozenUpdates.set(i,e)}onDataChannelMessage(e,t){this.onData(JSON.parse(e.data),t)}onData(e,t){a.enabled&&a(`DC in: ${e}`),e.dataType&&(e.source=t,this.frozen?this.storeMessage(e):this.onOccupantMessage(null,e.dataType,e.data,e.source))}shouldStartConnectionTo(e){return!0}startStreamConnection(e){}closeStreamConnection(e){}getConnectStatus(e){return this.occupants[e]?NAF.adapters.IS_CONNECTED:NAF.adapters.NOT_CONNECTED}async updateTimeOffset(){if(this.isDisconnected())return;const e=Date.now(),t=await fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}),n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?(a(`new server time offset: ${this.avgTimeOffset}ms`),setTimeout(()=>this.updateTimeOffset(),3e5)):this.updateTimeOffset()}getServerTime(){return Date.now()+this.avgTimeOffset}getMediaStream(e,t=\"audio\"){if(this.mediaStreams[e])return a(`Already had ${t} for ${e}`),Promise.resolve(this.mediaStreams[e][t]);if(a(`Waiting on ${t} for ${e}`),!this.pendingMediaRequests.has(e)){this.pendingMediaRequests.set(e,{});const t=new Promise((t,n)=>{this.pendingMediaRequests.get(e).audio={resolve:t,reject:n}}),n=new Promise((t,n)=>{this.pendingMediaRequests.get(e).video={resolve:t,reject:n}});this.pendingMediaRequests.get(e).audio.promise=t,this.pendingMediaRequests.get(e).video.promise=n}return this.pendingMediaRequests.get(e)[t].promise}setMediaStream(e,t){const n=new MediaStream;t.getAudioTracks().forEach(e=>n.addTrack(e));const r=new MediaStream;t.getVideoTracks().forEach(e=>r.addTrack(e)),this.mediaStreams[e]={audio:n,video:r},this.pendingMediaRequests.has(e)&&(this.pendingMediaRequests.get(e).audio.resolve(n),this.pendingMediaRequests.get(e).video.resolve(r))}async setLocalMediaStream(e){if(this.publisher&&this.publisher.conn){const t=this.publisher.conn.getSenders(),n=[],r=e.getTracks();for(let i=0;i<r.length;i++){const a=r[i],s=t.find(e=>null!=e.track&&e.track.kind==a.kind);null!=s?(s.replaceTrack?(await s.replaceTrack(a),\"video\"===a.kind&&a.enabled&&navigator.userAgent.toLowerCase().indexOf(\"firefox\")>-1&&(a.enabled=!1,setTimeout(()=>a.enabled=!0,1e3))):(e.removeTrack(s.track),e.addTrack(a)),n.push(s)):n.push(this.publisher.conn.addTrack(a,e))}t.forEach(e=>{n.includes(e)||(e.track.enabled=!1)})}this.localMediaStream=e,this.setMediaStream(this.clientId,e)}enableMicrophone(e){this.publisher&&this.publisher.conn&&this.publisher.conn.getSenders().forEach(t=>{\"audio\"==t.track.kind&&(t.track.enabled=e)})}sendData(e,t,n){if(this.publisher)switch(this.unreliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:t,data:n}),whom:e});break;case\"datachannel\":this.publisher.unreliableChannel.send(JSON.stringify({clientId:e,dataType:t,data:n}));break;default:this.unreliableTransport(e,t,n)}else console.warn(\"sendData called without a publisher\")}sendDataGuaranteed(e,t,n){if(this.publisher)switch(this.reliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:t,data:n}),whom:e});break;case\"datachannel\":this.publisher.reliableChannel.send(JSON.stringify({clientId:e,dataType:t,data:n}));break;default:this.reliableTransport(e,t,n)}else console.warn(\"sendDataGuaranteed called without a publisher\")}broadcastData(e,t){if(this.publisher)switch(this.unreliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:e,data:t})});break;case\"datachannel\":this.publisher.unreliableChannel.send(JSON.stringify({dataType:e,data:t}));break;default:this.unreliableTransport(void 0,e,t)}else console.warn(\"broadcastData called without a publisher\")}broadcastDataGuaranteed(e,t){if(this.publisher)switch(this.reliableTransport){case\"websocket\":this.publisher.handle.sendMessage({kind:\"data\",body:JSON.stringify({dataType:e,data:t})});break;case\"datachannel\":this.publisher.reliableChannel.send(JSON.stringify({dataType:e,data:t}));break;default:this.reliableTransport(void 0,e,t)}else console.warn(\"broadcastDataGuaranteed called without a publisher\")}kick(e,t){return this.publisher.handle.sendMessage({kind:\"kick\",room_id:this.room,user_id:e,token:t}).then(()=>{document.body.dispatchEvent(new CustomEvent(\"kicked\",{detail:{clientId:e}}))})}block(e){return this.publisher.handle.sendMessage({kind:\"block\",whom:e}).then(()=>{this.blockedClients.set(e,!0),document.body.dispatchEvent(new CustomEvent(\"blocked\",{detail:{clientId:e}}))})}unblock(e){return this.publisher.handle.sendMessage({kind:\"unblock\",whom:e}).then(()=>{this.blockedClients.delete(e),document.body.dispatchEvent(new CustomEvent(\"unblocked\",{detail:{clientId:e}}))})}}NAF.adapters.register(\"janus\",m),e.exports=m},V8Jh:function(e,t,n){var r=n(\"qDOb\"),i=n(\"ramI\");class a{constructor(){this.adapters={wseasyrtc:r,easyrtc:i},this.IS_CONNECTED=a.IS_CONNECTED,this.CONNECTING=a.CONNECTING,this.NOT_CONNECTED=a.NOT_CONNECTED}register(e,t){this.adapters[e]=t}make(e){var t=e.toLowerCase();if(this.adapters[t])return new(0,this.adapters[t]);throw new Error(\"Adapter: \"+e+\" not registered. Please use NAF.adapters.register() to register this adapter.\")}}a.IS_CONNECTED=\"IS_CONNECTED\",a.CONNECTING=\"CONNECTING\",a.NOT_CONNECTED=\"NOT_CONNECTED\",e.exports=a},VKE9:function(e,t){function n(e){this.session=e,this.id=void 0}function r(e,t){this.output=e,this.id=void 0,this.nextTxId=0,this.txns={},this.eventHandlers={},this.options=Object.assign({verbose:!1,timeoutMs:1e4,keepaliveMs:3e4},t)}n.prototype.attach=function(e){var t={plugin:e,\"force-bundle\":!0,\"force-rtcp-mux\":!0};return this.session.send(\"attach\",t).then(e=>(this.id=e.data.id,e))},n.prototype.detach=function(){return this.send(\"detach\")},n.prototype.on=function(e,t){return this.session.on(e,e=>{e.sender==this.id&&t(e)})},n.prototype.send=function(e,t){return this.session.send(e,Object.assign({handle_id:this.id},t))},n.prototype.sendMessage=function(e){return this.send(\"message\",{body:e})},n.prototype.sendJsep=function(e){return this.send(\"message\",{body:{},jsep:e})},n.prototype.sendTrickle=function(e){return this.send(\"trickle\",{candidate:e})},r.prototype.create=function(){return this.send(\"create\").then(e=>(this.id=e.data.id,e))},r.prototype.destroy=function(){return this.send(\"destroy\").then(e=>(this.dispose(),e))},r.prototype.dispose=function(){for(var e in this._killKeepalive(),this.eventHandlers={},this.txns)if(this.txns.hasOwnProperty(e)){var t=this.txns[e];clearTimeout(t.timeout),t.reject(new Error(\"Janus session was disposed.\")),delete this.txns[e]}},r.prototype.isError=function(e){return\"error\"===e.janus},r.prototype.on=function(e,t){var n=this.eventHandlers[e];null==n&&(n=this.eventHandlers[e]=[]),n.push(t)},r.prototype.receive=function(e){this.options.verbose&&this._logIncoming(e),e.session_id!=this.id&&console.warn(\"Incorrect session ID received in Janus signalling message: was \"+e.session_id+\", expected \"+this.id+\".\");var t=e.janus,n=this.eventHandlers[t];if(null!=n)for(var r=0;r<n.length;r++)n[r](e);if(null!=e.transaction){var i=this.txns[e.transaction];if(null==i)return;if(\"ack\"===t&&\"message\"==i.type)return;clearTimeout(i.timeout),delete this.txns[e.transaction],(this.isError(e)?i.reject:i.resolve)(e)}},r.prototype.send=function(e,t){return t=Object.assign({transaction:(this.nextTxId++).toString()},t),new Promise((n,r)=>{var i=null;this.options.timeoutMs&&(i=setTimeout(()=>{delete this.txns[t.transaction],r(new Error(\"Signalling transaction with txid \"+t.transaction+\" timed out.\"))},this.options.timeoutMs)),this.txns[t.transaction]={resolve:n,reject:r,timeout:i,type:e},this._transmit(e,t)})},r.prototype._transmit=function(e,t){t=Object.assign({janus:e},t),null!=this.id&&(t=Object.assign({session_id:this.id},t)),this.options.verbose&&this._logOutgoing(t),this.output(JSON.stringify(t)),this._resetKeepalive()},r.prototype._logOutgoing=function(e){var t=e.janus;\"message\"===t&&e.jsep&&(t=e.jsep.type);var n=\"> Outgoing Janus \"+(t||\"signal\")+\" (#\"+e.transaction+\"): \";console.debug(\"%c\"+n,\"color: #040\",e)},r.prototype._logIncoming=function(e){var t=e.janus,n=e.transaction?\"< Incoming Janus \"+(t||\"signal\")+\" (#\"+e.transaction+\"): \":\"< Incoming Janus \"+(t||\"signal\")+\": \";console.debug(\"%c\"+n,\"color: #004\",e)},r.prototype._sendKeepalive=function(){return this.send(\"keepalive\")},r.prototype._killKeepalive=function(){clearTimeout(this.keepaliveTimeout)},r.prototype._resetKeepalive=function(){this._killKeepalive(),this.options.keepaliveMs&&(this.keepaliveTimeout=setTimeout(()=>{this._sendKeepalive().catch(e=>console.error(\"Error received from keepalive: \",e))},this.options.keepaliveMs))},e.exports={JanusPluginHandle:n,JanusSession:r}},WeY7:function(e,t,n){n(\"EYIQ\"),n(\"FJvS\"),n(\"xK6/\"),n(\"mxTd\")},XmTq:function(e,t,n){\"use strict\";e.exports=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:\"NotAllowedError\"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},ZTa3:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&r.deprecated(\"RTCIceServer.url\",\"RTCIceServer.urls\");var a=\"string\"===typeof i;return a&&(i=[i]),i=i.filter((function(e){return 0===e.indexOf(\"turn:\")&&-1!==e.indexOf(\"transport=udp\")&&-1===e.indexOf(\"turn:[\")&&!n?(n=!0,!0):0===e.indexOf(\"stun:\")&&t>=14393&&-1===e.indexOf(\"?transport=udp\")})),delete e.url,e.urls=a?i[0]:i,!!i.length}}))}},f2ge:function(e,t){e.exports=class{notImplemented(e){NAF.log.error(\"Interface method not implemented:\",e)}}},foSv:function(e,t,n){\"use strict\";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,\"a\",(function(){return r}))},ggQn:function(e,t,n){\"use strict\";var r=n(\"KCt4\"),i=n(\"lVut\");e.exports={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&\"foundation\"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if(\"object\"===typeof e&&e.candidate&&0===e.candidate.indexOf(\"a=\")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.parseCandidate(e.candidate),a=Object.assign(n,i);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,\"icecandidate\",(function(t){return t.candidate&&Object.defineProperty(t,\"candidate\",{value:new e.RTCIceCandidate(t.candidate),writable:\"false\"}),t}))}},shimCreateObjectURL:function(e){var t=e&&e.URL;if(\"object\"===typeof e&&e.HTMLMediaElement&&\"srcObject\"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),r=t.revokeObjectURL.bind(t),a=new Map,s=0;t.createObjectURL=function(e){if(\"getTracks\"in e){var t=\"polyblob:\"+ ++s;return a.set(t,e),i.deprecated(\"URL.createObjectURL(stream)\",\"elem.srcObject = stream\"),t}return n(e)},t.revokeObjectURL=function(e){r(e),a.delete(e)};var o=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,\"src\");Object.defineProperty(e.HTMLMediaElement.prototype,\"src\",{get:function(){return o.get.apply(this)},set:function(e){return this.srcObject=a.get(e)||null,o.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&\"src\"===(\"\"+arguments[0]).toLowerCase()&&(this.srcObject=a.get(arguments[1])||null),c.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=i.detectBrowser(e);\"sctp\"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,\"sctp\",{get:function(){return\"undefined\"===typeof this._sctp?null:this._sctp}});var n=function(e){var t=r.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.parseMLine(e);return t&&\"application\"===t.kind&&-1!==t.protocol.indexOf(\"SCTP\")}))},a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!==n?-1:n},s=function(e){var n=65536;return\"firefox\"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){var i=65536;\"firefox\"===t.browser&&57===t.version&&(i=65535);var a=r.matchPrefix(e.sdp,\"a=max-message-size:\");return a.length>0?i=parseInt(a[0].substr(19),10):\"firefox\"===t.browser&&-1!==n&&(i=2147483637),i},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(e._sctp=null,n(arguments[0])){var t,r=a(arguments[0]),i=s(r),d=o(arguments[0],r);t=0===i&&0===d?Number.POSITIVE_INFINITY:0===i||0===d?Math.max(i,d):Math.min(i,d);var p={};Object.defineProperty(p,\"maxMessageSize\",{get:function(){return t}}),e._sctp=p}return c.apply(e,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&\"createDataChannel\"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this,r=t.apply(e,arguments);return n(r,e),r},i.wrapPeerConnectionEvent(e,\"datachannel\",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if(\"open\"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError(\"Message too large (can send a maximum of \"+t.sctp.maxMessageSize+\" bytes)\");return n.apply(e,arguments)}}}}},goMv:function(e,t,n){\"use strict\";var r=n(\"lVut\");e.exports={shimLocalStreamsAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection){if(\"getLocalStreams\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),\"getStreamById\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach((function(n){n.id===e&&(t=n)})),this._remoteStreams&&this._remoteStreams.forEach((function(n){n.id===e&&(t=n)})),t}),!(\"addStream\"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach((function(r){t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}\"removeStream\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,r=e.getTracks();this.getSenders().forEach((function(e){-1!==r.indexOf(e.track)&&n.removeTrack(e)}))}})}},shimRemoteStreamsAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection&&(\"getRemoteStreams\"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!(\"onaddstream\"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,\"onaddstream\",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&this.removeEventListener(\"addstream\",this._onaddstream),this.addEventListener(\"addstream\",this._onaddstream=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener(\"track\",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event(\"addstream\");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},shimCallbacksAPI:function(e){if(\"object\"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var o=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=o,o=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=o,o=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=o}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],a=0;a<e.iceServers.length;a++){var s=e.iceServers[a];!s.hasOwnProperty(\"urls\")&&s.hasOwnProperty(\"url\")?(r.deprecated(\"RTCIceServer.url\",\"RTCIceServer.urls\"),(s=JSON.parse(JSON.stringify(s))).urls=s.url,delete s.url,i.push(s)):i.push(e.iceServers[a])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,\"generateCertificate\"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,\"generateCertificate\",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){\"object\"===typeof e&&e.RTCPeerConnection&&\"receiver\"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,\"transceiver\",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){\"undefined\"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=n.getTransceivers().find((function(e){return e.sender.track&&\"audio\"===e.sender.track.kind}));!1===e.offerToReceiveAudio&&r?\"sendrecv\"===r.direction?r.setDirection?r.setDirection(\"sendonly\"):r.direction=\"sendonly\":\"recvonly\"===r.direction&&(r.setDirection?r.setDirection(\"inactive\"):r.direction=\"inactive\"):!0!==e.offerToReceiveAudio||r||n.addTransceiver(\"audio\"),\"undefined\"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=n.getTransceivers().find((function(e){return e.sender.track&&\"video\"===e.sender.track.kind}));!1===e.offerToReceiveVideo&&i?\"sendrecv\"===i.direction?i.setDirection(\"sendonly\"):\"recvonly\"===i.direction&&i.setDirection(\"inactive\"):!0!==e.offerToReceiveVideo||i||n.addTransceiver(\"video\")}return t.apply(n,arguments)}}}},iBZa:function(e,t){e.exports.whenEntityLoaded=function(e,t){e.hasLoaded&&t(),e.addEventListener(\"loaded\",(function(){t()}))},e.exports.createHtmlNodeFromString=function(e){var t=document.createElement(\"div\");return t.innerHTML=e,t.firstChild},e.exports.getCreator=function(e){var t=e.components;return t.hasOwnProperty(\"networked\")?t.networked.data.creator:null},e.exports.getNetworkOwner=function(e){var t=e.components;return t.hasOwnProperty(\"networked\")?t.networked.data.owner:null},e.exports.getNetworkId=function(e){var t=e.components;return t.hasOwnProperty(\"networked\")?t.networked.data.networkId:null},e.exports.now=function(){return Date.now()},e.exports.createNetworkId=function(){return Math.random().toString(36).substring(2,9)},e.exports.getNetworkedEntity=function(e){return new Promise((t,n)=>{let r=e;for(;r&&r.components&&!r.components.networked;)r=r.parentNode;if(!r||!r.components||!r.components.networked)return n(\"Entity does not have and is not a child of an entity with the [networked] component \");r.hasLoaded?t(r):r.addEventListener(\"instantiated\",()=>{t(r)},{once:!0})})},e.exports.takeOwnership=function(e){let t=e;for(;t&&t.components&&!t.components.networked;)t=t.parentNode;if(!t||!t.components||!t.components.networked)throw new Error(\"Entity does not have and is not a child of an entity with the [networked] component \");return t.components.networked.takeOwnership()},e.exports.isMine=function(e){let t=e;for(;t&&t.components&&!t.components.networked;)t=t.parentNode;if(!t||!t.components||!t.components.networked)throw new Error(\"Entity does not have and is not a child of an entity with the [networked] component \");return t.components.networked.data.owner===NAF.clientId},e.exports.almostEqualVec3=function(e,t,n){return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n&&Math.abs(e.z-t.z)<n}},lVut:function(e,t,n){\"use strict\";var r=!0,i=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}e.exports={extractVersion:a,wrapPeerConnectionEvent:function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var a=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=a,i.apply(this,[e,a])};var a=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return a.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],a.apply(this,[e,r])},Object.defineProperty(r,\"on\"+t,{get:function(){return this[\"_on\"+t]},set:function(e){this[\"_on\"+t]&&(this.removeEventListener(t,this[\"_on\"+t]),delete this[\"_on\"+t]),e&&this.addEventListener(t,this[\"_on\"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return\"boolean\"!==typeof e?new Error(\"Argument type: \"+typeof e+\". Please use a boolean.\"):(r=e,e?\"adapter.js logging disabled\":\"adapter.js logging enabled\")},disableWarnings:function(e){return\"boolean\"!==typeof e?new Error(\"Argument type: \"+typeof e+\". Please use a boolean.\"):(i=!e,\"adapter.js deprecation warnings \"+(e?\"disabled\":\"enabled\"))},log:function(){if(\"object\"===typeof window){if(r)return;\"undefined\"!==typeof console&&\"function\"===typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){i&&console.warn(e+\" is deprecated, please use \"+t+\" instead.\")},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(\"undefined\"===typeof e||!e.navigator)return n.browser=\"Not a browser.\",n;if(t.mozGetUserMedia)n.browser=\"firefox\",n.version=a(t.userAgent,/Firefox\\/(\\d+)\\./,1);else if(t.webkitGetUserMedia)n.browser=\"chrome\",n.version=a(t.userAgent,/Chrom(e|ium)\\/(\\d+)\\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\\/(\\d+).(\\d+)$/))n.browser=\"edge\",n.version=a(t.userAgent,/Edge\\/(\\d+).(\\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\\/(\\d+)\\./))return n.browser=\"Not a supported browser.\",n;n.browser=\"safari\",n.version=a(t.userAgent,/AppleWebKit\\/(\\d+)\\./,1)}return n}}},m0Qv:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/scene\",function(){return n(\"5YFB\")}])},md7G:function(e,t,n){\"use strict\";function r(e){return(r=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}n.d(t,\"a\",(function(){return a}));var i=n(\"JX7q\");function a(e,t){return!t||\"object\"!==r(t)&&\"function\"!==typeof t?Object(i.a)(e):t}},mqsc:function(e,t){e.exports=class{constructor(){this.debug=!1}setDebug(e){this.debug=e}write(){this.debug&&console.log.apply(this,arguments)}warn(){console.warn.apply(this,arguments)}error(){console.error.apply(this,arguments)}}},mxTd:function(e,t,n){var r=n(\"EYIQ\");AFRAME.registerComponent(\"networked-audio-source\",{schema:{positional:{default:!0},distanceModel:{default:\"inverse\",oneOf:[\"linear\",\"inverse\",\"exponential\"]},maxDistance:{default:1e4},refDistance:{default:1},rolloffFactor:{default:1}},init:function(){this.listener=null,this.stream=null,this._setMediaStream=this._setMediaStream.bind(this),NAF.utils.getNetworkedEntity(this.el).then(e=>{const t=e.components.networked.data.owner;t&&NAF.connection.adapter.getMediaStream(t).then(this._setMediaStream).catch(e=>r.log.error(`Error getting media stream for ${t}`,e))})},update(){this._setPannerProperties()},_setMediaStream(e){if(this.sound||this.setupSound(),e!=this.stream){if(this.stream&&this.sound.disconnect(),e){/chrome/i.test(navigator.userAgent)&&(this.audioEl=new Audio,this.audioEl.setAttribute(\"autoplay\",\"autoplay\"),this.audioEl.setAttribute(\"playsinline\",\"playsinline\"),this.audioEl.srcObject=e,this.audioEl.volume=0);const t=this.sound.context.createMediaStreamSource(e);this.sound.setNodeSource(t),this.el.emit(\"sound-source-set\",{soundSource:t})}this.stream=e}},_setPannerProperties(){this.sound&&this.data.positional&&(this.sound.setDistanceModel(this.data.distanceModel),this.sound.setMaxDistance(this.data.maxDistance),this.sound.setRefDistance(this.data.refDistance),this.sound.setRolloffFactor(this.data.rolloffFactor))},remove:function(){this.sound&&(this.el.removeObject3D(this.attrName),this.stream&&this.sound.disconnect())},setupSound:function(){var e=this.el,t=e.sceneEl;this.sound&&e.removeObject3D(this.attrName),t.audioListener||(t.audioListener=new THREE.AudioListener,t.camera&&t.camera.add(t.audioListener),t.addEventListener(\"camera-set-active\",(function(e){e.detail.cameraEl.getObject3D(\"camera\").add(t.audioListener)}))),this.listener=t.audioListener,this.sound=this.data.positional?new THREE.PositionalAudio(this.listener):new THREE.Audio(this.listener),e.setObject3D(this.attrName,this.sound),this._setPannerProperties()}})},ojCt:function(e,t,n){\"use strict\";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=0,a=0,s=[],o=function(){var e=s.pop();return e||(e={position:new THREE.Vector3,velocity:new THREE.Vector3,scale:new THREE.Vector3,quaternion:new THREE.Quaternion,time:0}),e},c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.state=i,this.buffer=[],this.bufferTime=1e3*n,this.time=0,this.mode=t,this.originFrame=o(),this.position=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1)}return r(e,[{key:\"hermite\",value:function(e,t,n,r,i,a){var s=t*t,o=t*t*t,c=2*o-3*s+1,d=-2*o+3*s,p=o-2*s+t,u=o-s;e.copy(n.multiplyScalar(c)),e.add(r.multiplyScalar(d)),e.add(i.multiplyScalar(p)),e.add(a.multiplyScalar(u))}},{key:\"lerp\",value:function(e,t,n,r){e.lerpVectors(t,n,r)}},{key:\"slerp\",value:function(e,t,n,r){THREE.Quaternion.slerp(t,n,e,r)}},{key:\"updateOriginFrameToBufferTail\",value:function(){var e;e=this.originFrame,s.push(e),this.originFrame=this.buffer.shift()}},{key:\"appendBuffer\",value:function(e,t,n,r){var i=this.buffer.length>0?this.buffer[this.buffer.length-1]:null;if(i&&i.time===this.time)e&&i.position.copy(e),t&&i.velocity.copy(t),n&&i.quaternion.copy(n),r&&i.scale.copy(r);else{var a=i||this.originFrame,s=o();s.position.copy(e||a.position),s.velocity.copy(t||a.velocity),s.quaternion.copy(n||a.quaternion),s.scale.copy(r||a.scale),s.time=this.time,this.buffer.push(s)}}},{key:\"setTarget\",value:function(e,t,n,r){this.appendBuffer(e,t,n,r)}},{key:\"setPosition\",value:function(e,t){this.appendBuffer(e,t,null,null)}},{key:\"setQuaternion\",value:function(e){this.appendBuffer(null,null,e,null)}},{key:\"setScale\",value:function(e){this.appendBuffer(null,null,null,e)}},{key:\"update\",value:function(e){if(this.state===i&&this.buffer.length>0&&(this.updateOriginFrameToBufferTail(),this.position.copy(this.originFrame.position),this.quaternion.copy(this.originFrame.quaternion),this.scale.copy(this.originFrame.scale),this.state=1),1===this.state&&this.buffer.length>0&&this.time>this.bufferTime&&(this.state=2),2===this.state){for(var t=this.time-this.bufferTime;this.buffer.length>0&&t>this.buffer[0].time;)this.buffer.length>1?this.updateOriginFrameToBufferTail():(this.originFrame.position.copy(this.buffer[0].position),this.originFrame.velocity.copy(this.buffer[0].velocity),this.originFrame.quaternion.copy(this.buffer[0].quaternion),this.originFrame.scale.copy(this.buffer[0].scale),this.originFrame.time=this.buffer[0].time,this.buffer[0].time=this.time+e);if(this.buffer.length>0&&this.buffer[0].time>0){var n=this.buffer[0],r=n.time-this.originFrame.time,s=(t-this.originFrame.time)/r;this.mode===a?this.lerp(this.position,this.originFrame.position,n.position,s):1===this.mode&&this.hermite(this.position,s,this.originFrame.position,n.position,this.originFrame.velocity.multiplyScalar(r),n.velocity.multiplyScalar(r)),this.slerp(this.quaternion,this.originFrame.quaternion,n.quaternion,s),this.lerp(this.scale,this.originFrame.scale,n.scale,s)}}this.state!==i&&(this.time+=e)}},{key:\"getPosition\",value:function(){return this.position}},{key:\"getQuaternion\",value:function(){return this.quaternion}},{key:\"getScale\",value:function(){return this.scale}}]),e}();e.exports=c},ozXo:function(e,t){e.exports=class{constructor(){this.dict={}}addChild(e,t){this.hasParent(e)||(this.dict[e]=[]),this.dict[e].push(t)}getChildren(e){if(!this.hasParent(e))return[];var t=this.dict[e];return delete this.dict[e],t}hasParent(e){return this.dict.hasOwnProperty(e)}}},pXin:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;e.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,a=e&&e.MediaStreamTrack,s=function(e){return{name:{InternalError:\"NotReadableError\",NotSupportedError:\"TypeError\",PermissionDeniedError:\"NotAllowedError\",SecurityError:\"NotAllowedError\"}[e.name]||e.name,message:{\"The operation is insecure.\":\"The request is not allowed by the user agent or the platform in the current context.\"}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&\": \")+this.message}}},o=function(e,r,a){var o=function(e){if(\"object\"!==typeof e||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if(\"require\"!==n&&\"advanced\"!==n&&\"mediaSource\"!==n){var r=e[n]=\"object\"===typeof e[n]?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&(\"number\"===typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};\"number\"===typeof r.ideal?i[n]={min:r.ideal,max:r.ideal}:i[n]=r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(i(\"spec: \"+JSON.stringify(e)),e.audio&&(e.audio=o(e.audio)),e.video&&(e.video=o(e.video)),i(\"ff37: \"+JSON.stringify(e))),n.mozGetUserMedia(e,r,(function(e){a(s(e))}))};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(e){return new Promise((function(t,n){o(e,t,n)}))},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise((function(e){e([{kind:\"audioinput\",deviceId:\"default\",label:\"\",groupId:\"\"},{kind:\"videoinput\",deviceId:\"default\",label:\"\",groupId:\"\"}])}))},t.version<41){var c=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return c().then(void 0,(function(e){if(\"NotFoundError\"===e.name)return[];throw e}))}}if(t.version<49){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException(\"The object can not be found here.\",\"NotFoundError\");return t}),(function(e){return Promise.reject(s(e))}))}}if(!(t.version>55&&\"autoGainControl\"in n.mediaDevices.getSupportedConstraints())){var p=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return\"object\"===typeof e&&\"object\"===typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),p(e.audio,\"autoGainControl\",\"mozAutoGainControl\"),p(e.audio,\"noiseSuppression\",\"mozNoiseSuppression\")),u(e)},a&&a.prototype.getSettings){var l=a.prototype.getSettings;a.prototype.getSettings=function(){var e=l.apply(this,arguments);return p(e,\"mozAutoGainControl\",\"autoGainControl\"),p(e,\"mozNoiseSuppression\",\"noiseSuppression\"),e}}if(a&&a.prototype.applyConstraints){var h=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return\"audio\"===this.kind&&\"object\"===typeof e&&(e=JSON.parse(JSON.stringify(e)),p(e,\"autoGainControl\",\"mozAutoGainControl\"),p(e,\"noiseSuppression\",\"mozNoiseSuppression\")),h.apply(this,[e])}}}n.getUserMedia=function(e,i,a){if(t.version<44)return o(e,i,a);r.deprecated(\"navigator.getUserMedia\",\"navigator.mediaDevices.getUserMedia\"),n.mediaDevices.getUserMedia(e).then(i,a)}}},qDOb:function(e,t,n){const r=n(\"DSTq\");e.exports=class extends r{constructor(e){super(),this.easyrtc=e||window.easyrtc,this.app=\"default\",this.room=\"default\",this.connectedClients=[],this.serverTimeRequests=0,this.timeOffsets=[],this.avgTimeOffset=0}setServerUrl(e){this.serverUrl=e,this.easyrtc.setSocketUrl(e)}setApp(e){this.app=e}setRoom(e){this.room=e,this.easyrtc.joinRoom(e,null)}setWebRtcOptions(e){}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.easyrtc.setRoomOccupantListener((function(t,n,r){e(n)}))}setDataChannelListeners(e,t,n){this.openListener=e,this.closedListener=t,this.easyrtc.setPeerListener(n)}updateTimeOffset(){const e=Date.now()+this.avgTimeOffset;return fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}).then(t=>{var n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?setTimeout(()=>this.updateTimeOffset(),3e5):this.updateTimeOffset()})}connect(){Promise.all([this.updateTimeOffset(),new Promise((e,t)=>{this.easyrtc.connect(this.app,e,t)})]).then(([e,t])=>{this.connectSuccess(t)}).catch(this.connectFailure)}shouldStartConnectionTo(e){return!0}startStreamConnection(e){this.connectedClients.push(e),this.openListener(e)}closeStreamConnection(e){var t=this.connectedClients.indexOf(e);t>-1&&this.connectedClients.splice(t,1),this.closedListener(e)}sendData(e,t,n){this.easyrtc.sendDataWS(e,t,n)}sendDataGuaranteed(e,t,n){this.sendData(e,t,n)}broadcastData(e,t){var n={targetRoom:this.room};this.easyrtc.sendDataWS(n,e,t)}broadcastDataGuaranteed(e,t){this.broadcastData(e,t)}getConnectStatus(e){return-1!=this.connectedClients.indexOf(e)?NAF.adapters.IS_CONNECTED:NAF.adapters.NOT_CONNECTED}getServerTime(){return Date.now()+this.avgTimeOffset}disconnect(){this.easyrtc.disconnect()}}},ramI:function(e,t,n){const r=n(\"DSTq\");e.exports=class extends r{constructor(e){super(),this.easyrtc=e||window.easyrtc,this.app=\"default\",this.room=\"default\",this.audioStreams={},this.pendingAudioRequest={},this.serverTimeRequests=0,this.timeOffsets=[],this.avgTimeOffset=0}setServerUrl(e){this.easyrtc.setSocketUrl(e)}setApp(e){this.app=e}setRoom(e){this.room=e,this.easyrtc.joinRoom(e,null)}setWebRtcOptions(e){this.easyrtc.enableDataChannels(e.datachannel),this.easyrtc.enableVideo(!1),this.easyrtc.enableAudio(e.audio),this.easyrtc.enableVideoReceive(!1),this.easyrtc.enableAudioReceive(e.audio)}setServerConnectListeners(e,t){this.connectSuccess=e,this.connectFailure=t}setRoomOccupantListener(e){this.easyrtc.setRoomOccupantListener((function(t,n,r){e(n)}))}setDataChannelListeners(e,t,n){this.easyrtc.setDataChannelOpenListener(e),this.easyrtc.setDataChannelCloseListener(t),this.easyrtc.setPeerListener(n)}updateTimeOffset(){const e=Date.now()+this.avgTimeOffset;return fetch(document.location.href,{method:\"HEAD\",cache:\"no-cache\"}).then(t=>{var n=new Date(t.headers.get(\"Date\")).getTime()+500,r=Date.now(),i=n+(r-e)/2-r;this.serverTimeRequests++,this.serverTimeRequests<=10?this.timeOffsets.push(i):this.timeOffsets[this.serverTimeRequests%10]=i,this.avgTimeOffset=this.timeOffsets.reduce((e,t)=>e+=t,0)/this.timeOffsets.length,this.serverTimeRequests>10?setTimeout(()=>this.updateTimeOffset(),3e5):this.updateTimeOffset()})}connect(){Promise.all([this.updateTimeOffset(),new Promise((e,t)=>{this.easyrtc.audioEnabled?this._connectWithAudio(e,t):this.easyrtc.connect(this.app,e,t)})]).then(([e,t])=>{this._storeAudioStream(this.easyrtc.myEasyrtcid,this.easyrtc.getLocalStream()),this._myRoomJoinTime=this._getRoomJoinTime(t),this.connectSuccess(t)}).catch(this.connectFailure)}shouldStartConnectionTo(e){return this._myRoomJoinTime<=e.roomJoinTime}startStreamConnection(e){this.easyrtc.call(e,(function(e,t){\"datachannel\"===t&&NAF.log.write(\"Successfully started datachannel to \",e)}),(function(e,t){NAF.log.error(e,t)}),(function(e){}))}closeStreamConnection(e){}sendData(e,t,n){this.easyrtc.sendData(e,t,n)}sendDataGuaranteed(e,t,n){this.easyrtc.sendDataWS(e,t,n)}broadcastData(e,t){var n=this.easyrtc.getRoomOccupantsAsMap(this.room);for(var r in n)n.hasOwnProperty(r)&&r!==this.easyrtc.myEasyrtcid&&this.easyrtc.sendData(r,e,t)}broadcastDataGuaranteed(e,t){var n={targetRoom:this.room};this.easyrtc.sendDataWS(n,e,t)}getConnectStatus(e){var t=this.easyrtc.getConnectStatus(e);return t==this.easyrtc.IS_CONNECTED?NAF.adapters.IS_CONNECTED:t==this.easyrtc.NOT_CONNECTED?NAF.adapters.NOT_CONNECTED:NAF.adapters.CONNECTING}getMediaStream(e){var t=this;return this.audioStreams[e]?(NAF.log.write(\"Already had audio for \"+e),Promise.resolve(this.audioStreams[e])):(NAF.log.write(\"Waiting on audio for \"+e),new Promise((function(n){t.pendingAudioRequest[e]=n})))}disconnect(){this.easyrtc.disconnect()}_storeAudioStream(e,t){this.audioStreams[e]=t,this.pendingAudioRequest[e]&&(NAF.log.write(\"got pending audio for \"+e),this.pendingAudioRequest[e](t),this.pendingAudioRequest[e](t))}_connectWithAudio(e,t){var n=this;this.easyrtc.setStreamAcceptor(this._storeAudioStream.bind(this)),this.easyrtc.setOnStreamClosed((function(e){delete n.audioStreams[e]})),this.easyrtc.initMediaSource((function(){n.easyrtc.connect(n.app,e,t)}),(function(e,t){NAF.log.error(e,t)}))}_getRoomJoinTime(e){var t=NAF.room;return this.easyrtc.getRoomOccupantsAsMap(t)[e].roomJoinTime}getServerTime(){return Date.now()+this.avgTimeOffset}}},sJPo:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=n(\"ZTa3\"),a=n(\"8D0k\");e.exports={shimGetUserMedia:n(\"XmTq\"),shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,\"enabled\");Object.defineProperty(e.MediaStreamTrack.prototype,\"enabled\",{set:function(e){n.set.call(this,e);var t=new Event(\"enabled\");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||\"dtmf\"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,\"dtmf\",{get:function(){return void 0===this._dtmf&&(\"audio\"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):\"video\"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var s=a(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=i(e.iceServers)),new s(e)},e.RTCPeerConnection.prototype=s.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||\"replaceTrack\"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},shimGetDisplayMedia:function(e,t){if(\"getDisplayMedia\"in e.navigator&&e.navigator.mediaDevices&&!(\"getDisplayMedia\"in e.navigator.mediaDevices)){var n=e.navigator.getDisplayMedia;e.navigator.mediaDevices.getDisplayMedia=function(t){return n.call(e.navigator,t)},e.navigator.getDisplayMedia=function(t){return r.deprecated(\"navigator.getDisplayMedia\",\"navigator.mediaDevices.getDisplayMedia\"),n.call(e.navigator,t)}}}}},tvSW:function(e,t){e.exports={debug:!1,updateRate:15,useLerp:!0,firstSyncSource:null,syncSource:null}},umSQ:function(e,t){e.exports=class{constructor(){this.schemaDict={},this.templateCache={}}createDefaultSchema(e){return{template:e,components:[\"position\",\"rotation\"]}}add(e){if(this.validateSchema(e)){this.schemaDict[e.template]=e;var t=document.querySelector(e.template);if(!t)return void NAF.log.error(`Template el not found for ${e.template}, make sure NAF.schemas.add is called after <a-scene> is defined.`);if(!this.validateTemplate(e,t))return;this.templateCache[e.template]=document.importNode(t.content,!0)}else NAF.log.error(\"Schema not valid: \",e),NAF.log.error(\"See https://github.com/haydenjameslee/networked-aframe#syncing-custom-components\")}getCachedTemplate(e){return this.templateIsCached(e)||(this.templateExistsInScene(e)?this.add(this.createDefaultSchema(e)):NAF.log.error(`Template el for ${e} is not in the scene, add the template to <a-assets> and register with NAF.schemas.add.`)),this.templateCache[e].firstElementChild.cloneNode(!0)}templateIsCached(e){return this.templateCache.hasOwnProperty(e)}getComponents(e){var t=[\"position\",\"rotation\"];return this.hasTemplate(e)&&(t=this.schemaDict[e].components),t}hasTemplate(e){return this.schemaDict.hasOwnProperty(e)}templateExistsInScene(e){var t=document.querySelector(e);return t&&this.isTemplateTag(t)}validateSchema(e){return e.hasOwnProperty(\"template\")&&e.hasOwnProperty(\"components\")}validateTemplate(e,t){return this.isTemplateTag(t)?!!this.templateHasOneOrZeroChildren(t)||(NAF.log.error(`Template for ${e.template} has more than one child. Templates must have one direct child element, no more. Template found:`,t),!1):(NAF.log.error(`Template for ${e.template} is not a <template> tag. Instead found: ${t.tagName}`),!1)}isTemplateTag(e){return\"template\"===e.tagName.toLowerCase()}templateHasOneOrZeroChildren(e){return e.content.childElementCount<2}remove(e){delete this.schemaDict[e]}clear(){this.schemaDict={}}}},vPXE:function(e,t,n){\"use strict\";(function(r){function i(e){return(i=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}t.log=function(){var e;return\"object\"===(\"undefined\"===typeof console?\"undefined\":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?\"%c\":\"\")+this.namespace+(this.useColors?\" %c\":\" \")+t[0]+(this.useColors?\"%c \":\" \")+\"+\"+e.exports.humanize(this.diff),!this.useColors)return;var n=\"color: \"+this.color;t.splice(1,0,n,\"color: inherit\");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){\"%%\"!==e&&(r++,\"%c\"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem(\"debug\",e):t.storage.removeItem(\"debug\")}catch(n){}},t.load=function(){var e;try{e=t.storage.getItem(\"debug\")}catch(n){}!e&&\"undefined\"!==typeof r&&\"env\"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if(\"undefined\"!==typeof window&&window.process&&(\"renderer\"===window.process.type||window.process.__nwjs))return!0;if(\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/))return!1;return\"undefined\"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||\"undefined\"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)&&parseInt(RegExp.$1,10)>=31||\"undefined\"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=[\"#0000CC\",\"#0000FF\",\"#0033CC\",\"#0033FF\",\"#0066CC\",\"#0066FF\",\"#0099CC\",\"#0099FF\",\"#00CC00\",\"#00CC33\",\"#00CC66\",\"#00CC99\",\"#00CCCC\",\"#00CCFF\",\"#3300CC\",\"#3300FF\",\"#3333CC\",\"#3333FF\",\"#3366CC\",\"#3366FF\",\"#3399CC\",\"#3399FF\",\"#33CC00\",\"#33CC33\",\"#33CC66\",\"#33CC99\",\"#33CCCC\",\"#33CCFF\",\"#6600CC\",\"#6600FF\",\"#6633CC\",\"#6633FF\",\"#66CC00\",\"#66CC33\",\"#9900CC\",\"#9900FF\",\"#9933CC\",\"#9933FF\",\"#99CC00\",\"#99CC33\",\"#CC0000\",\"#CC0033\",\"#CC0066\",\"#CC0099\",\"#CC00CC\",\"#CC00FF\",\"#CC3300\",\"#CC3333\",\"#CC3366\",\"#CC3399\",\"#CC33CC\",\"#CC33FF\",\"#CC6600\",\"#CC6633\",\"#CC9900\",\"#CC9933\",\"#CCCC00\",\"#CCCC33\",\"#FF0000\",\"#FF0033\",\"#FF0066\",\"#FF0099\",\"#FF00CC\",\"#FF00FF\",\"#FF3300\",\"#FF3333\",\"#FF3366\",\"#FF3399\",\"#FF33CC\",\"#FF33FF\",\"#FF6600\",\"#FF6633\",\"#FF9900\",\"#FF9933\",\"#FFCC00\",\"#FFCC33\"],e.exports=n(\"7dnI\")(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return\"[UnexpectedJSONParseError]: \"+t.message}}}).call(this,n(\"8oxB\"))},vuIU:function(e,t,n){\"use strict\";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,\"a\",(function(){return i}))},vwHn:function(e,t,n){\"use strict\";var r=n(\"lVut\"),i=r.log;e.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,a=function(e){if(\"object\"!==typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if(\"require\"!==n&&\"advanced\"!==n&&\"mediaSource\"!==n){var r=\"object\"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&\"number\"===typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):\"deviceId\"===t?\"sourceId\":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};\"number\"===typeof r.ideal?(a[i(\"min\",n)]=r.ideal,t.optional.push(a),(a={})[i(\"max\",n)]=r.ideal,t.optional.push(a)):(a[i(\"\",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&\"number\"!==typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i(\"\",n)]=r.exact):[\"min\",\"max\"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&\"object\"===typeof e.audio){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,\"autoGainControl\",\"googAutoGainControl\"),s(e.audio,\"noiseSuppression\",\"googNoiseSuppression\"),e.audio=a(e.audio)}if(e&&\"object\"===typeof e.video){var o=e.video.facingMode;o=o&&(\"object\"===typeof o?o:{ideal:o});var c,d=t.version<66;if(o&&(\"user\"===o.exact||\"environment\"===o.exact||\"user\"===o.ideal||\"environment\"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||d))if(delete e.video.facingMode,\"environment\"===o.exact||\"environment\"===o.ideal?c=[\"back\",\"rear\"]:\"user\"!==o.exact&&\"user\"!==o.ideal||(c=[\"front\"]),c)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return\"videoinput\"===e.kind}))).find((function(e){return c.some((function(t){return-1!==e.label.toLowerCase().indexOf(t)}))}));return!n&&t.length&&-1!==c.indexOf(\"back\")&&(n=t[t.length-1]),n&&(e.video.deviceId=o.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),i(\"chrome: \"+JSON.stringify(e)),r(e)}));e.video=a(e.video)}return i(\"chrome: \"+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:\"NotAllowedError\",PermissionDismissedError:\"NotAllowedError\",InvalidStateError:\"NotAllowedError\",DevicesNotFoundError:\"NotFoundError\",ConstraintNotSatisfiedError:\"OverconstrainedError\",TrackStartError:\"NotReadableError\",MediaDeviceFailedDueToShutdown:\"NotAllowedError\",MediaDeviceKillSwitchOn:\"NotAllowedError\",TabCaptureError:\"AbortError\",ScreenCaptureError:\"AbortError\",DeviceCaptureError:\"AbortError\"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&\": \")+this.message}}};n.getUserMedia=function(e,t,r){s(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(o(e))}))}))};var c=function(e){return new Promise((function(t,r){n.getUserMedia(e,t,r)}))};if(n.mediaDevices||(n.mediaDevices={getUserMedia:c,enumerateDevices:function(){return new Promise((function(t){var n={audio:\"audioinput\",video:\"videoinput\"};return e.MediaStreamTrack.getSources((function(e){t(e.map((function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:\"\"}})))}))}))},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException(\"\",\"NotFoundError\");return t}),(function(e){return Promise.reject(o(e))}))}))}}else n.mediaDevices.getUserMedia=function(e){return c(e)};\"undefined\"===typeof n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){i(\"Dummy mediaDevices.addEventListener called.\")}),\"undefined\"===typeof n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){i(\"Dummy mediaDevices.removeEventListener called.\")})}},\"xK6/\":function(e,t,n){var r=n(\"zs+I\"),i=n(\"ojCt\"),a=THREE.Math.DEG2RAD,s=[\"position\",\"rotation\",\"scale\"];AFRAME.registerSystem(\"networked\",{init(){this.components=[],this.nextSyncTime=0},register(e){this.components.push(e)},deregister(e){const t=this.components.indexOf(e);t>-1&&this.components.splice(t,1)},tick:function(){if(!NAF.connection.adapter)return;if(this.el.clock.elapsedTime<this.nextSyncTime)return;const e={d:[]};for(let t=0,n=this.components.length;t<n;t++){const n=this.components[t];if(!n.isMine())continue;if(!n.el.parentElement)return void NAF.log.error(\"entity registered with system despite being removed\");const r=this.components[t].syncDirty();r&&e.d.push(r)}e.d.length>0&&NAF.connection.broadcastData(\"um\",e),this.updateNextSyncTime()},updateNextSyncTime(){this.nextSyncTime=this.el.clock.elapsedTime+1/NAF.options.updateRate}}),AFRAME.registerComponent(\"networked\",{schema:{template:{default:\"\"},attachTemplateToLocal:{default:!0},persistent:{default:!1},networkId:{default:\"\"},owner:{default:\"\"},creator:{default:\"\"}},init:function(){this.OWNERSHIP_GAINED=\"ownership-gained\",this.OWNERSHIP_CHANGED=\"ownership-changed\",this.OWNERSHIP_LOST=\"ownership-lost\",this.onOwnershipGainedEvent={el:this.el},this.onOwnershipChangedEvent={el:this.el},this.onOwnershipLostEvent={el:this.el},this.conversionEuler=new THREE.Euler,this.conversionEuler.order=\"YXZ\",this.bufferInfos=[],this.bufferPosition=new THREE.Vector3,this.bufferQuaternion=new THREE.Quaternion,this.bufferScale=new THREE.Vector3;var e=this.wasCreatedByNetwork();let t;this.onConnected=this.onConnected.bind(this),this.syncData={},this.componentSchemas=NAF.schemas.getComponents(this.data.template),this.cachedElements=new Array(this.componentSchemas.length),this.networkUpdatePredicates=this.componentSchemas.map(e=>e.requiresNetworkUpdate&&e.requiresNetworkUpdate()||function(){let e=null;return t=>(null===e||!r(e,t))&&(e=AFRAME.utils.clone(t),!0)}()),this.invalidateCachedElements(),this.initNetworkParent(),\"\"===this.data.networkId?(t=NAF.utils.createNetworkId(),this.el.setAttribute(this.name,{networkId:t})):t=this.data.networkId,this.el.id||this.el.setAttribute(\"id\",\"naf-\"+t),e?this.firstUpdate():(this.data.attachTemplateToLocal&&this.attachTemplateToLocal(),this.registerEntity(this.data.networkId)),this.lastOwnerTime=-1,NAF.clientId?this.onConnected():document.body.addEventListener(\"connected\",this.onConnected,!1),document.body.dispatchEvent(this.entityCreatedEvent()),this.el.dispatchEvent(new CustomEvent(\"instantiated\",{detail:{el:this.el}})),this.el.sceneEl.systems.networked.register(this)},attachTemplateToLocal:function(){const e=NAF.schemas.getCachedTemplate(this.data.template),t=e.attributes;for(let n=0;n<t.length;n++)this.el.setAttribute(t[n].name,t[n].value);for(;e.firstElementChild;)this.el.appendChild(e.firstElementChild)},takeOwnership:function(){const e=this.data.owner,t=this.lastOwnerTime,n=NAF.connection.getServerTime();return!!(e&&!this.isMine()&&t<n)&&(this.lastOwnerTime=n,this.removeLerp(),this.el.setAttribute(\"networked\",{owner:NAF.clientId}),this.syncAll(),this.onOwnershipGainedEvent.oldOwner=e,this.el.emit(this.OWNERSHIP_GAINED,this.onOwnershipGainedEvent),this.onOwnershipChangedEvent.oldOwner=e,this.onOwnershipChangedEvent.newOwner=NAF.clientId,this.el.emit(this.OWNERSHIP_CHANGED,this.onOwnershipChangedEvent),!0)},wasCreatedByNetwork:function(){return!!this.el.firstUpdateData},initNetworkParent:function(){var e=this.el.parentElement;e.hasOwnProperty(\"components\")&&e.components.hasOwnProperty(\"networked\")?this.parent=e:this.parent=null},registerEntity:function(e){NAF.entities.registerEntity(e,this.el)},applyPersistentFirstSync:function(){const{networkId:e}=this.data,t=NAF.entities.getPersistentFirstSync(e);t&&(this.networkUpdate(t),NAF.entities.forgetPersistentFirstSync(e))},firstUpdate:function(){var e=this.el.firstUpdateData;this.networkUpdate(e)},onConnected:function(){\"\"===this.data.owner&&(this.lastOwnerTime=NAF.connection.getServerTime(),this.el.setAttribute(this.name,{owner:NAF.clientId,creator:NAF.clientId}),setTimeout(()=>{this.el.parentNode?this.syncAll(void 0,!0):NAF.log.warn(\"Networked element was removed before ever getting the chance to syncAll\")},0)),document.body.removeEventListener(\"connected\",this.onConnected,!1)},isMine:function(){return this.data.owner===NAF.clientId},createdByMe:function(){return this.data.creator===NAF.clientId},tick:function(e,t){if(!this.isMine()&&NAF.options.useLerp)for(var n=0;n<this.bufferInfos.length;n++){var r=this.bufferInfos[n],i=r.buffer,a=r.object3D,s=r.componentNames;i.update(t),s.includes(\"position\")&&a.position.copy(i.getPosition()),s.includes(\"rotation\")&&a.quaternion.copy(i.getQuaternion()),s.includes(\"scale\")&&a.scale.copy(i.getScale())}},syncAll:function(e,t){if(this.canSync()){var n=this.gatherComponentsData(!0),r=this.createSyncData(n,t);e?NAF.connection.sendDataGuaranteed(e,\"u\",r):NAF.connection.broadcastDataGuaranteed(\"u\",r)}},syncDirty:function(){if(this.canSync()){var e=this.gatherComponentsData(!1);if(null!==e)return this.createSyncData(e)}},getCachedElement(e){var t=this.cachedElements[e];if(t)return t;var n=this.componentSchemas[e];return n.selector?this.cachedElements[e]=this.el.querySelector(n.selector):this.cachedElements[e]=this.el},invalidateCachedElements(){for(var e=0;e<this.cachedElements.length;e++)this.cachedElements[e]=null},gatherComponentsData:function(e){for(var t=null,n=0;n<this.componentSchemas.length;n++){var r=this.componentSchemas[n],i=this.getCachedElement(n);if(i){var a=r.component?r.component:r,s=i.getAttribute(a);if(null!==s){var o=r.property?s[r.property]:s;(this.networkUpdatePredicates[n](o)||e)&&((t=t||{})[n]=o)}else e&&((t=t||{})[n]=null)}else e&&((t=t||{})[n]=null)}return t},createSyncData:function(e,t){var{syncData:n,data:r}=this;return n.networkId=r.networkId,n.owner=r.owner,n.creator=r.creator,n.lastOwnerTime=this.lastOwnerTime,n.template=r.template,n.persistent=r.persistent,n.parent=this.getParentId(),n.components=e,n.isFirstSync=!!t,n},canSync:function(){if(this.data.owner&&this.isMine())return!0;if(!this.createdByMe())return!1;const e=NAF.connection.getConnectedClients();for(let t in e)if(t===this.data.owner)return!1;return!0},getParentId:function(){return this.initNetworkParent(),this.parent?this.parent.getAttribute(\"networked\").networkId:null},networkUpdate:function(e){if(!(e.lastOwnerTime<this.lastOwnerTime||this.lastOwnerTime===e.lastOwnerTime&&this.data.owner>e.owner)){if(this.data.owner!==e.owner){var t=this.isMine();this.lastOwnerTime=e.lastOwnerTime;const n=this.data.owner,r=e.owner;this.el.setAttribute(\"networked\",{owner:e.owner}),t&&(this.onOwnershipLostEvent.newOwner=r,this.el.emit(this.OWNERSHIP_LOST,this.onOwnershipLostEvent)),this.onOwnershipChangedEvent.oldOwner=n,this.onOwnershipChangedEvent.newOwner=r,this.el.emit(this.OWNERSHIP_CHANGED,this.onOwnershipChangedEvent)}this.data.persistent!==e.persistent&&this.el.setAttribute(\"networked\",{persistent:e.persistent}),this.updateNetworkedComponents(e.components)}},updateNetworkedComponents:function(e){for(var t=0,n=this.componentSchemas.length;t<n;t++){var r=e[t],i=this.componentSchemas[t],a=this.getCachedElement(t);null!==a&&null!==r&&void 0!==r&&(i.component?i.property?this.updateNetworkedComponent(a,i.component,i.property,r):this.updateNetworkedComponent(a,i.component,r):this.updateNetworkedComponent(a,i,r))}},updateNetworkedComponent:function(e,t,n,r){if(!NAF.options.useLerp||!s.includes(t))return void(void 0===r?e.setAttribute(t,n):e.setAttribute(t,n,r));let o;for(let i=0,a=this.bufferInfos.length;i<a;i++){const t=this.bufferInfos[i];if(t.object3D===e.object3D){o=t;break}}if(o){var c=o.componentNames;c.includes(t)||c.push(t)}else o={buffer:new i(i.MODE_LERP,.1),object3D:e.object3D,componentNames:[t]},this.bufferInfos.push(o);var d=o.buffer;switch(t){case\"position\":return void d.setPosition(this.bufferPosition.set(n.x,n.y,n.z));case\"rotation\":return this.conversionEuler.set(a*n.x,a*n.y,a*n.z),void d.setQuaternion(this.bufferQuaternion.setFromEuler(this.conversionEuler));case\"scale\":return void d.setScale(this.bufferScale.set(n.x,n.y,n.z))}NAF.log.error(\"Could not set value in interpolation buffer.\",e,t,n,o)},removeLerp:function(){this.bufferInfos=[]},remove:function(){if(this.isMine()&&NAF.connection.isConnected()){var e={networkId:this.data.networkId};NAF.entities.hasEntity(this.data.networkId)?NAF.connection.broadcastDataGuaranteed(\"r\",e):NAF.log.error(\"Removing networked entity that is not in entities array.\")}NAF.entities.forgetEntity(this.data.networkId),document.body.dispatchEvent(this.entityRemovedEvent(this.data.networkId)),this.el.sceneEl.systems.networked.deregister(this)},entityCreatedEvent(){return new CustomEvent(\"entityCreated\",{detail:{el:this.el}})},entityRemovedEvent:e=>new CustomEvent(\"entityRemoved\",{detail:{networkId:e}})})},yLpj:function(e,t){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(r){\"object\"===typeof window&&(n=window)}e.exports=n},\"zs+I\":function(e,t,n){\"use strict\";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&\"object\"==typeof t&&\"object\"==typeof n){var s,o,c,d=r(t),p=r(n);if(d&&p){if((o=t.length)!=n.length)return!1;for(s=o;0!==s--;)if(!e(t[s],n[s]))return!1;return!0}if(d!=p)return!1;var u=t instanceof Date,l=n instanceof Date;if(u!=l)return!1;if(u&&l)return t.getTime()==n.getTime();var h=t instanceof RegExp,f=n instanceof RegExp;if(h!=f)return!1;if(h&&f)return t.toString()==n.toString();var m=i(t);if((o=m.length)!==i(n).length)return!1;for(s=o;0!==s--;)if(!a.call(n,m[s]))return!1;for(s=o;0!==s--;)if(!e(t[c=m[s]],n[c]))return!1;return!0}return t!==t&&n!==n}}},[[\"m0Qv\",0,1]]]);"}