(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5365],{21840:function(e,t,n){"use strict";n.d(t,{R6:function(){return i},Tw:function(){return c},S:function(){return s},Kl:function(){return u},uZ:function(){return l},Zd:function(){return f},oX:function(){return p},RD:function(){return h}});var r=n(33221);function o(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return new Map(Object.entries(e))}function c(e,t){var n=new Set,r=[],a=t;"undefined"===typeof a?a=function(e){return e}:"string"===typeof a&&(a=function(e){return e[t]});var i,c=o(e);try{for(c.s();!(i=c.n()).done;){var s=i.value,u=a(s);n.has(u)||(r.push(s),n.add(u))}}catch(l){c.e(l)}finally{c.f()}return r}var s=/(Mac|iPhone|iPod|iPad)/i.test((null!==r&&void 0!==r?navigator:void 0)?navigator.platform:"")?"\u2318":"ctrl";function u(e,t,n,r){return e.altKey?t:e.shiftKey?r:n}function l(e,t,n){return e<t?t:e>n?n:e}function f(e,t){var n=1/t;return Math.round(e*n)/n}function p(e){return e.replace(/([A-Z]+)([A-Z][a-z])/g," $1 $2").replace(/([a-z\d])([A-Z])/g,"$1 $2").replace(/([a-zA-Z])(\d)/g,"$1 $2").replace(/^./,(function(e){return e.toUpperCase()})).trim()}function h(e){if(0==e)return"0 Byte";var t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t))+" "+["Bytes","KB","MB","GB","TB"][t]}},416:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,r,a,i){if("function"!==typeof r)throw new TypeError("The listener must be a function");var c=new o(r,a||e,i),s=n?n+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],c]:e._events[s].push(c):(e._events[s]=c,e._eventsCount++),e}function i(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function c(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),c.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},c.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,a=r.length,i=new Array(a);o<a;o++)i[o]=r[o].fn;return i},c.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,t,r,o,a,i){var c=n?n+e:e;if(!this._events[c])return!1;var s,u,l=this._events[c],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,a),!0;case 6:return l.fn.call(l.context,t,r,o,a,i),!0}for(u=1,s=new Array(f-1);u<f;u++)s[u-1]=arguments[u];l.fn.apply(l.context,s)}else{var p,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),f){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,o);break;default:if(!s)for(p=1,s=new Array(f-1);p<f;p++)s[p-1]=arguments[p];l[u].fn.apply(l[u].context,s)}}return!0},c.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,r,o){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return i(this,a),this;var c=this._events[a];if(c.fn)c.fn!==t||o&&!c.once||r&&c.context!==r||i(this,a);else{for(var s=0,u=[],l=c.length;s<l;s++)(c[s].fn!==t||o&&!c[s].once||r&&c[s].context!==r)&&u.push(c[s]);u.length?this._events[a]=1===u.length?u[0]:u:i(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,e.exports=c},92073:function(e){function t(e){this.message=e}t.prototype=new Error,t.prototype.name="InvalidCharacterError",e.exports="undefined"!==typeof window&&window.atob&&window.atob.bind(window)||function(e){var n=String(e).replace(/=+$/,"");if(n.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,a=0,i=0,c="";o=n.charAt(i++);~o&&(r=a%4?64*r+o:o,a++%4)?c+=String.fromCharCode(255&r>>(-2*a&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return c}},94198:function(e,t,n){var r=n(92073);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(n){return r(t)}}},51529:function(e,t,n){"use strict";var r=n(94198);function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!==typeof e)throw new o("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(r(e.split(".")[n]))}catch(a){throw new o("Invalid token specified: "+a.message)}},e.exports.InvalidTokenError=o},30573:function(e,t,n){e.exports=n(12717)},70873:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},41510:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(n)}e.exports=t},31790:function(e,t,n){var r=n(44837);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},19678:function(e,t,n){var r=n(43108),o=n(70873);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?o(e):t}},96612:function(e){!function(t){var n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,r=/^([^\/?#]*)(.*)$/,o=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,i={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var o=i.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return o.path=i.normalizePath(o.path),i.buildURLFromParts(o)}var a=i.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=i.normalizePath(a.path),i.buildURLFromParts(a)):t;var c=i.parseURL(e);if(!c)throw new Error("Error trying to parse base URL.");if(!c.netLoc&&c.path&&"/"!==c.path[0]){var s=r.exec(c.path);c.netLoc=s[1],c.path=s[2]}c.netLoc&&!c.path&&(c.path="/");var u={scheme:c.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=c.netLoc,"/"!==a.path[0]))if(a.path){var l=c.path,f=l.substring(0,l.lastIndexOf("/")+1)+a.path;u.path=i.normalizePath(f)}else u.path=c.path,a.params||(u.params=c.params,a.query||(u.query=c.query));return null===u.path&&(u.path=n.alwaysNormalize?i.normalizePath(a.path):a.path),i.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(o,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=i}()},94989:function(e,t,n){"use strict";var r;t.__esModule=!0,t.AmpStateContext=void 0;var o=((r=n(27878))&&r.__esModule?r:{default:r}).default.createContext({});t.AmpStateContext=o},59735:function(e,t,n){"use strict";t.__esModule=!0,t.isInAmpMode=i,t.useAmp=function(){return i(o.default.useContext(a.AmpStateContext))};var r,o=(r=n(27878))&&r.__esModule?r:{default:r},a=n(94989);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ampFirst,n=void 0!==t&&t,r=e.hybrid,o=void 0!==r&&r,a=e.hasQuery,i=void 0!==a&&a;return n||o&&i}},40052:function(e,t,n){"use strict";var r;t.__esModule=!0,t.HeadManagerContext=void 0;var o=((r=n(27878))&&r.__esModule?r:{default:r}).default.createContext({});t.HeadManagerContext=o},12717:function(e,t,n){"use strict";n(8756);t.default=void 0;var r,o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(27878)),a=(r=n(3411))&&r.__esModule?r:{default:r},i=n(94989),c=n(40052),s=n(59735);function u(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[o.default.createElement("meta",{charSet:"utf-8"})];return e||t.push(o.default.createElement("meta",{name:"viewport",content:"width=device-width"})),t}function f(e,t){return"string"===typeof t||"number"===typeof t?e:t.type===o.default.Fragment?e.concat(o.default.Children.toArray(t.props.children).reduce((function(e,t){return"string"===typeof t||"number"===typeof t?e:e.concat(t)}),[])):e.concat(t)}var p=["name","httpEquiv","charSet","itemProp"];function h(e,t){return e.reduce((function(e,t){var n=o.default.Children.toArray(t.props.children);return e.concat(n)}),[]).reduce(f,[]).reverse().concat(l(t.inAmpMode)).filter(function(){var e=new Set,t=new Set,n=new Set,r={};return function(o){var a=!0,i=!1;if(o.key&&"number"!==typeof o.key&&o.key.indexOf("$")>0){i=!0;var c=o.key.slice(o.key.indexOf("$")+1);e.has(c)?a=!1:e.add(c)}switch(o.type){case"title":case"base":t.has(o.type)?a=!1:t.add(o.type);break;case"meta":for(var s=0,u=p.length;s<u;s++){var l=p[s];if(o.props.hasOwnProperty(l))if("charSet"===l)n.has(l)?a=!1:n.add(l);else{var f=o.props[l],h=r[l]||new Set;"name"===l&&i||!h.has(f)?(h.add(f),r[l]=h):a=!1}}}return a}}()).reverse().map((function(e,t){var n=e.key||t;return o.default.cloneElement(e,{key:n})}))}function d(e){var t=e.children,n=(0,o.useContext)(i.AmpStateContext),r=(0,o.useContext)(c.HeadManagerContext);return o.default.createElement(a.default,{reduceComponentsToState:h,headManager:r,inAmpMode:(0,s.isInAmpMode)(n)},t)}d.rewind=function(){};var m=d;t.default=m},3411:function(e,t,n){"use strict";var r=n(64181),o=n(49804),a=n(4821),i=(n(70873),n(31790)),c=n(19678),s=n(41510);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}t.__esModule=!0,t.default=void 0;var l=n(27878),f=function(e){i(n,e);var t=u(n);function n(e){var a;return o(this,n),(a=t.call(this,e))._hasHeadManager=void 0,a.emitChange=function(){a._hasHeadManager&&a.props.headManager.updateHead(a.props.reduceComponentsToState(r(a.props.headManager.mountedInstances),a.props))},a._hasHeadManager=a.props.headManager&&a.props.headManager.mountedInstances,a}return a(n,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),n}(l.Component);t.default=f},34314:function(e,t,n){"use strict";n.d(t,{ZP:function(){return ie},xy:function(){return ne}});var r=n(48533),o=n.n(r),a=n(58700),i=n(49182),c=n(39337),s=n(13987),u=n(29569),l=n(89306),f=n(416),p=n.n(f),h=n(51529),d=n.n(h),m=n(96612),v=n(71362),b=n(90588),g=n(12761),x=n(11742),y=n(44807),w=n(27878),k=n(98538),_=n(36707),j=n(21840),C=w.createElement;function S(){var e=(0,y.Z)(["\n  display: flex;\n  min-height: 100px;\n  background-color: ",";\n  border: 1px solid ",";\n  border-radius: 4px;\n  margin: 4px;\n  color: white;\n  max-width: 560px;\n\n  & > :first-child {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    width: 100px;\n  }\n\n  & > :last-child {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    padding: 12px;\n    border-left: 1px solid ",";\n  }\n\n  h5 {\n    font-size: 20px;\n  }\n\n  h6 {\n    font-size: 16px;\n  }\n\n  a {\n    white-space: nowrap;\n    color: ",";\n  }\n\n  p {\n    margin: 0;\n  }\n"]);return S=function(){return e},e}function P(){var e=(0,y.Z)(["\n  color: ",";\n"]);return P=function(){return e},e}var E=k.ZP.span(P(),(function(e){return e.color})),A=k.ZP.li(S(),(function(e){return e.theme.toolbar}),(function(e){return e.theme.panel}),(function(e){return e.theme.panel2}),(function(e){return e.theme.blue}));function Z(e){var t=e.score,n=e.scoreColor,r=e.title,o=e.description,a=e.learnMoreUrl,i=e.children;return C(A,null,C("div",null,C(E,{as:"h5",color:n},t)),C("div",null,C("h6",null,r,": ",i),C("p",null,o," ",C("a",{rel:"noopener noreferrer",target:"_blank",href:a},"Learn More"))))}var R={Low:0,Medium:1,High:2};function U(e){var t=e.scores,n=(0,x.Z)(e,["scores"]),r=(0,w.useContext)(k.Ni),o={Low:r.green,Medium:r.yellow,High:r.red},a=R[t.textures.largeTexturesScore]>R[t.textures.score]?t.textures.largeTexturesScore:t.textures.score;return C(_.Z,n,C("ul",null,C(Z,{title:"Polygon Count",description:"We recommend your scene use no more than 50,000 triangles for mobile devices.",learnMoreUrl:"htts://xr3ngine.dev/docs/editor-optimization.html",score:t.polygons.score,scoreColor:o[t.polygons.score]},C(E,{color:o[t.polygons.score]},t.polygons.value.toLocaleString()," Triangles")),C(Z,{title:"Materials",description:"We recommend using no more than 25 unique materials in your scene to reduce draw calls on mobile devices.",learnMoreUrl:"htts://xr3ngine.dev/docs/editor-optimization.html",score:t.materials.score,scoreColor:o[t.materials.score]},C(E,{color:o[t.materials.score]},t.materials.value," Unique Materials")),C(Z,{title:"Textures",description:"We recommend your textures use no more than 256MB of video RAM for mobile devices. We also recommend against using textures larger than 2048 x 2048.",learnMoreUrl:"htts://xr3ngine.dev/docs/editor-optimization.html",score:a,scoreColor:o[a]},C(E,{color:o[t.textures.score]},"~",(0,j.RD)(t.textures.value)," Video RAM"),","," ",C(E,{color:o[t.textures.largeTexturesScore]},t.textures.largeTexturesValue," Large Textures")),C(Z,{title:"Lights",description:"While dynamic lights are not enabled on mobile devices, we recommend using no more than 3 lights in your scene (excluding ambient and hemisphere lights) for your scene to run on low end PCs.",learnMoreUrl:"htts://xr3ngine.dev/docs/editor-optimization.html",score:t.lights.score,scoreColor:o[t.lights.score]},C(E,{color:o[t.lights.score]},t.lights.value," Lights")),C(Z,{title:"File Size",description:"We recommend a final file size of no more than 16MB for low bandwidth connections. Reducing the file size will reduce the time it takes to download your scene.",learnMoreUrl:"htts://xr3ngine.dev/docs/editor-optimization.html",score:t.fileSize.score,scoreColor:o[t.fileSize.score]},C(E,{color:o[t.fileSize.score]},(0,j.RD)(t.fileSize.value)))))}U.defaultProps={tag:"div",title:"Performance Check",confirmLabel:"Publish Scene"};var O=n(39956),L=n(15194),M=n(4314),T=n(22400),z=n(78158),F=n(69867),N=w.createElement;function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,L.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var q=function(e){(0,s.Z)(n,e);var t=D(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).onChangeName=function(e){return r.setState({name:e})},r.onChangeCreatorAttribution=function(e){return r.setState({creatorAttribution:e})},r.onChangeAllowRemixing=function(e){return r.setState({allowRemixing:e})},r.onChangeAllowPromotion=function(e){return r.setState({allowPromotion:e})},r.onConfirm=function(){var e=I(I({},r.state),{},{contentAttributions:r.props.contentAttributions});e.name=e.name.trim(),e.creatorAttribution=e.creatorAttribution.trim(),r.props.onPublish(e)},r.state=I({name:"",creatorAttribution:"",allowRemixing:!1,allowPromotion:!1},e.initialSceneParams),r}return(0,c.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.onCancel,n=e.screenshotUrl,r=e.contentAttributions,o=this.state,a=o.creatorAttribution,i=o.name,c=o.allowRemixing,s=o.allowPromotion;return N(M.Z,{imageSrc:n,title:"Publish Scene",onConfirm:this.onConfirm,onCancel:t,confirmLabel:"Save and Publish"},N(F.Z,null,N("label",{htmlFor:"sceneName"},"Scene Name"),N(T.Z,{id:"sceneName",required:!0,pattern:"[A-Za-z0-9-':\"!@#$%^&*(),.?~ ]{4,64}",title:"Name must be between 4 and 64 characters and cannot contain underscores",value:i,onChange:this.onChangeName})),N(F.Z,null,N("label",{htmlFor:"creatorAttribution"},"Your Attribution (optional):"),N(T.Z,{id:"creatorAttribution",value:a,onChange:this.onChangeCreatorAttribution})),N(F.Z,{inline:!0},N("label",{htmlFor:"allowRemixing"},"Allow other users to remix your scene with",N("br",null),"Creative Commons\xa0",N("a",{href:"https://creativecommons.org/licenses/by/3.0/",target:"_blank",rel:"noopener noreferrer"},"CC-BY 3.0")),N(z.Z,{id:"allowRemixing",value:c,onChange:this.onChangeAllowRemixing})),N(F.Z,{inline:!0},N("label",{htmlFor:"allowPromotion"},"Allow scene to appear on front page"),N(z.Z,{id:"allowPromotion",value:s,onChange:this.onChangeAllowPromotion})),r&&N(F.Z,null,N("label",null,"Model Attribution:"),N("p",null,r.map((function(e){return"".concat(e.name," by ").concat(e.author,"\n")})))))}}]),n}(w.Component),H=n(20193),W=n(55956),$=w.createElement;function J(e){e.onCancel;var t=e.sceneName,n=e.sceneUrl,r=e.screenshotUrl,o=(0,x.Z)(e,["onCancel","sceneName","sceneUrl","screenshotUrl"]);return $(M.Z,(0,H.Z)({imageSrc:r,title:"Scene Published"},o),$("h1",null,t),$("p",null,"Your scene has been published."),$(W.zx,{as:"a",href:n,target:"_blank"},"View Your Scene"))}function Y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var o=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var K=new Map,G=new Map,V=g.Z.SERVER_URL,Q=g.Z.APP_URL,X=g.Z.FEATHERS_STORE_KEY;var ee=function(e){return(t=e,btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))).replace(/=+$/g,"").replace(/\+/g,"-").replace(/\//g,"_");var t},te=(V||"").split(",");te.push(V);var ne=function(e){return e},re=function(e,t,n){return"".concat(V,"/thumbnail/").concat(ee(e),"?w=").concat(t,"&h=").concat(n)},oe={gltf:"model/gltf",glb:"model/gltf-binary",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",pdf:"application/pdf",mp4:"video/mp4",mp3:"audio/mpeg"};function ae(e){var t=new URL(e).pathname.split(".").pop();return oe[t]}var ie=function(e){(0,s.Z)(n,e);var t=Y(n);function n(){var e;(0,i.Z)(this,n),(e=t.call(this)).lastUploadAssetRequest=0;var r=new URL(window.location.href);r.protocol,r.host;return e.serverURL=V,e.apiURL="".concat(V),e.projectDirectoryPath="/api/files/",e.maxUploadSize=128,e.handleAuthorization(),e}return(0,c.Z)(n,[{key:"isAuthenticated",value:function(){var e=localStorage.getItem(X);return null!=e&&e.length>0}},{key:"getToken",value:function(){var e=localStorage.getItem(X);if(null==e||0===e.length)throw new Error("Not authenticated");return e}},{key:"getAccountId",value:function(){var e=this.getToken();return d()(e).sub}},{key:"getProjects",value:function(){var e=(0,a.Z)(o().mark((function e(){var t,n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getToken(),n={"content-type":"application/json",authorization:"Bearer ".concat(t)},e.next=4,this.fetchUrl("".concat(V,"/project"),{headers:n});case 4:return r=e.sent,e.next=7,r.json().catch((function(e){console.log("Error fetching JSON"),console.log(e)}));case 7:if(a=e.sent,Array.isArray(a.projects)&&null!=a.projects){e.next=10;break}throw new Error("Error fetching projects: ".concat(a.error||"Unknown error."));case 10:return e.abrupt("return",a.projects);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProject",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getToken(),r={"content-type":"application/json",authorization:"Bearer ".concat(n)},e.next=4,this.fetchUrl("".concat(V,"/project/").concat(t),{headers:r});case 4:return a=e.sent,e.next=7,a.json();case 7:return i=e.sent,console.log("Response: "+Object.values(a)),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveUrl",value:function(){var e=(0,a.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{origin:t});case 4:return r=this.fetchUrl("".concat(V,"/resolve-media"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({media:{url:t,index:n}})}).then(function(){var e=(0,a.Z)(o().mark((function e(n){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.ok){e.next=12;break}return r='Error resolving url "'.concat(t,'":\n  '),e.prev=2,e.next=5,n.text();case 5:throw a=e.sent,new Error(r+a.replace(/\n/g,"\n  "));case 9:throw e.prev=9,e.t0=e.catch(2),new Error(r+n.statusText.replace(/\n/g,"\n  "));case 12:return console.log("Response: "+Object.values(n)),e.abrupt("return",n.json());case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.warn(e)})),K.set(undefined,r),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchContentType",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchUrl(t,{method:"HEAD"}).then((function(e){return e.headers.get("content-type")}));case 2:return n=e.sent,console.log("Response: "+Object.values(n)),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getContentType",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveUrl(t);case 2:if(n=e.sent,console.log("CONTEXT TYPE IS",n),r=n.origin,a=ne(r),e.t0=n.meta&&n.meta.expected_content_type||ae(r),e.t0){e.next=11;break}return e.next=10,this.fetchContentType(a);case 10:e.t0=e.sent;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveMedia",value:function(){var e=(0,a.Z)(o().mark((function e(t,n){var r,i,c,s=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=new URL(t,window.location).href).startsWith(this.serverURL)){e.next=3;break}return e.abrupt("return",{accessibleUrl:r});case 3:if(i="".concat(r,"|").concat(n),!G.has(i)){e.next=6;break}return e.abrupt("return",G.get(i));case 6:return c=(0,a.Z)(o().mark((function e(){var t,n,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.resolveUrl(r);case 3:if(i=e.sent,n=i.origin,a=ne(n),e.t0=i.meta&&i.meta.expected_content_type||ae(n),e.t0){e.next=11;break}return e.next=10,s.fetchContentType(a);case 10:e.t0=e.sent;case 11:t=e.t0,e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(0),new v.mQ('Error resolving media "'.concat(r,'"'),e.t1);case 17:return e.abrupt("return",{canonicalUrl:n,accessibleUrl:a,contentType:t});case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))(),G.set(i,c),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"proxyUrl",value:function(e){return ne(e)}},{key:"unproxyUrl",value:function(e,t){var n="".concat(V,"/");return e.startsWith(n)&&(e=e.substring(n.length)),t.startsWith(n)&&(t=t.substring(n.length)),t.startsWith("http")||(t=(0,m.buildAbsoluteURL)(e,t.startsWith("/")?t:"/".concat(t))),ne(t)}},{key:"searchMedia",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a){var i,c,s,u,l,f,p,h,d,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new URL("".concat(V,"/media-search")),s={"content-type":"application/json"},(u=c.searchParams).set("source",t),"assets"===t&&(u.set("user",this.getAccountId()),l=this.getToken(),s.authorization="Bearer ".concat(l)),n.type&&u.set("type",n.type),n.query,n.filter&&u.set("filter",n.filter),n.collection&&u.set("collection",n.collection),r&&u.set("cursor",r),console.log("Fetching..."),e.next=13,this.fetchUrl(c,{headers:s,signal:a});case 13:if(f=e.sent,console.log("Response: "+Object.values(f)),!a.aborted){e.next=19;break}throw(p=new Error("Media search aborted")).aborted=!0,p;case 19:return e.next=21,f.json();case 21:if(h=e.sent,!a.aborted){e.next=26;break}throw(d=new Error("Media search aborted")).aborted=!0,d;case 26:return m=h&&h.entries&&h.entries.length>0&&h.entries.map((function(e){return e.images&&e.images.preview&&e.images.preview.url&&("mp4"===e.images.preview.type?e.images.preview.url=ne(e.images.preview.url):e.images.preview.url=re(e.images.preview.url,200,200)),e})),e.abrupt("return",{results:m||[],suggestions:h.suggestions,nextCursor:null===(i=h.meta)||void 0===i?void 0:i.next_cursor});case 28:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"searchTermFilteringBlacklist",value:function(e){throw new Error("Method not implemented.")}},{key:"createProject",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a,i,c){var s,u,l,f,p,h,d,m,v,b,g,x,y,w,k;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit("project-saving"),!a.aborted){e.next=3;break}throw new Error("Save project aborted");case 3:return e.next=5,this.upload(r,void 0,a);case 5:if(s=e.sent,u=s.file_id,l=s.meta.access_token,!a.aborted){e.next=10;break}throw new Error("Save project aborted");case 10:return f=t.serialize(),p=new Blob([JSON.stringify(f)],{type:"application/json"}),e.next=14,this.upload(p,void 0,a);case 14:if(h=e.sent,d=h.file_id,m=h.meta.access_token,!a.aborted){e.next=19;break}throw new Error("Save project aborted");case 19:return v=this.getToken(),b={"content-type":"application/json",authorization:"Bearer ".concat(v)},g={name:t.name,thumbnail_file_id:u,thumbnail_file_token:l,project_file_id:d,project_file_token:m},n&&(g.parent_scene_id=n),x=JSON.stringify({project:g}),y="".concat(V,"/project"),e.next=27,this.fetchUrl(y,{method:"POST",headers:b,body:x,signal:a});case 27:if(w=e.sent,console.log("Response: "+Object.values(w)),!a.aborted){e.next=31;break}throw new Error("Save project aborted");case 31:if(200===w.status){e.next=39;break}return e.t0=Error,e.t1="Project creation failed. ",e.next=36,w.text();case 36:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 39:return e.next=41,w.json();case 41:return k=e.sent,this.emit("project-saved"),e.abrupt("return",k);case 44:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,a,i){return e.apply(this,arguments)}}()},{key:"deleteProject",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getToken(),r={"content-type":"application/json",authorization:"Bearer ".concat(n)},a="".concat(V,"/project/").concat(t),e.next=5,this.fetchUrl(a,{method:"DELETE",headers:r});case 5:if(i=e.sent,console.log("Response: "+Object.values(i)),401!==i.status){e.next=9;break}throw new Error("Not authenticated");case 9:if(200===i.status){e.next=17;break}return e.t0=Error,e.t1="Project deletion failed. ",e.next=14,i.text();case 14:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveProject",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a,i){var c,s,u,l,f,p,h,d,m,v,b,g,x,y,w,k,_;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit("project-saving"),!r.aborted){e.next=3;break}throw new Error("Save project aborted");case 3:return e.next=5,n.takeScreenshot(512,320);case 5:if(c=e.sent,!r.aborted){e.next=8;break}throw new Error("Save project aborted");case 8:return e.next=10,this.upload(c,void 0,r,t);case 10:if(s=e.sent,u=s.file_id,l=s.meta.access_token,!r.aborted){e.next=15;break}throw new Error("Save project aborted");case 15:return f=n.scene.serialize(),p=new Blob([JSON.stringify(f)],{type:"application/json"}),e.next=19,this.upload(p,void 0,r);case 19:if(h=e.sent,d=h.file_id,m=h.meta.access_token,!r.aborted){e.next=24;break}throw new Error("Save project aborted");case 24:return v=this.getToken(),b={"content-type":"application/json",authorization:"Bearer ".concat(v)},g={name:n.scene.name,thumbnail_file_id:u,thumbnail_file_token:l,project_file_id:d,project_file_token:m},(x=n.scene.metadata&&n.scene.metadata.sceneId?n.scene.metadata.sceneId:null)&&(g.scene_id=x),y=JSON.stringify({project:g}),w="".concat(V,"/project/").concat(t),e.next=33,this.fetchUrl(w,{method:"PATCH",headers:b,body:y,signal:r});case 33:return k=e.sent,console.log("Response: "+Object.values(k)),e.next=37,k.json();case 37:if(_=e.sent,!r.aborted){e.next=40;break}throw new Error("Save project aborted");case 40:if(200===k.status){e.next=48;break}return e.t0=Error,e.t1="Saving project failed. ",e.next=45,k.text();case 45:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 48:return this.emit("project-saved"),e.abrupt("return",_);case 50:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,a){return e.apply(this,arguments)}}()},{key:"getProjectFile",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.api.getScene(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScene",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={"content-type":"application/json"},e.next=3,this.fetchUrl("".concat(V,"/project/").concat(t),{headers:n});case 3:return r=e.sent,console.log("Response: "+Object.values(r)),e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a.scenes[0]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSceneUrl",value:function(e){return"".concat(Q,"/scenes/").concat(e)}},{key:"publishProject",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a){var i,c,s,u,l,f,p,h,d,m,v,b,g,x,y,w,k,_,j,C,S,P,E,A,Z,R,L,M,T,z,F,N,B,I,D,H,W,$,Y,K,G,Q,X,ee,te,ne=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=n.scene,s=new AbortController,u=s.signal,!n.sceneModified){e.next=13;break}return r(O.i,{title:"Saving Project",message:"Saving project...",cancelable:!0,onCancel:function(){s.abort()}}),e.next=8,this.saveProject(t.project_id,n,u,r,a);case 8:if(t=e.sent,!u.aborted){e.next=13;break}throw(l=new Error("Publish project aborted")).aborted=!0,l;case 13:return r(O.i,{title:"Generating Project Screenshot",message:"Generating project screenshot..."}),e.next=16,new Promise((function(e){return setTimeout(e,5)}));case 16:return e.next=18,n.takeScreenshot();case 18:if(f=e.sent,console.log("Screenshot is"),console.log(f),p=f.blob,h=f.cameraTransform,console.log("screenshotBlob is"),console.log(p),i=URL.createObjectURL(p),console.log("Screenshot url is",i),!u.aborted){e.next=30;break}throw(d=new Error("Publish project aborted")).aborted=!0,d;case 30:return m=this.getUserInfo(),v=c.metadata,b=v.name,g=v.creatorAttribution,x=v.allowRemixing,y=v.allowPromotion,b=t.scene&&t.scene.name||b||n.scene.name,t.scene?(y=t.scene.allow_promotion,x=t.scene.allow_remixing,g=t.scene.attributions.creator||""):g&&0!==g.length||!m||!m.creatorAttribution||(g=m.creatorAttribution),w=c.getContentAttributions(),e.next=37,new Promise((function(e){r(q,{screenshotUrl:i,contentAttributions:w,initialSceneParams:{name:b,creatorAttribution:g||"",allowRemixing:"undefined"!==typeof x&&x,allowPromotion:"undefined"!==typeof y&&y},onCancel:function(){return e(null)},onPublish:e})}));case 37:if(k=e.sent){e.next=44;break}throw URL.revokeObjectURL(i),a(),(_=new Error("Publish project aborted")).aborted=!0,_;case 44:return c.setMetadata({name:k.name,creatorAttribution:k.creatorAttribution,allowRemixing:k.allowRemixing,allowPromotion:k.allowPromotion,previewCameraTransform:h}),this.setUserInfo({creatorAttribution:k.creatorAttribution}),r(O.i,{title:"Publishing Scene",message:"Exporting scene...",cancelable:!0,onCancel:function(){s.abort()}}),e.next=49,n.exportScene(s.signal,{scores:!0});case 49:if(j=e.sent,C=j.glbBlob,S=j.scores,!u.aborted){e.next=56;break}throw(P=new Error("Publish project aborted")).aborted=!0,P;case 56:return e.next=58,new Promise((function(e){r(U,{scores:S,onCancel:function(){return e(!1)},onConfirm:function(){return e(!0)}})}));case 58:if(e.sent){e.next=63;break}throw(E=new Error("Publish project canceled")).aborted=!0,E;case 63:if(A=n.scene.serialize(),Z=new Blob([JSON.stringify(A)],{type:"application/json"}),r(O.i,{title:"Publishing Scene",message:"Publishing scene",cancelable:!0,onCancel:function(){s.abort()}}),R=C.size/1024/1024,L=this.maxUploadSize,!(R>L)){e.next=70;break}throw new Error("Scene is too large (".concat(R.toFixed(2),"MB) to publish. Maximum size is ").concat(L,"MB."));case 70:return r(O.i,{title:"Publishing Scene",message:"Uploading thumbnail...",cancelable:!0,onCancel:function(){s.abort()}}),e.next=73,this.upload(p,void 0,s.signal);case 73:if(M=e.sent,T=M.file_id,z=M.meta.access_token,!u.aborted){e.next=80;break}throw(F=new Error("Publish project aborted")).aborted=!0,F;case 80:return e.next=82,this.upload(C,(function(e){r(O.i,{title:"Publishing Scene",message:"Uploading scene: ".concat(Math.floor(100*e),"%"),onCancel:function(){s.abort()}},s.signal)}));case 82:if(N=e.sent,B=N.file_id,I=N.meta.access_token,!u.aborted){e.next=89;break}throw(D=new Error("Publish project aborted")).aborted=!0,D;case 89:return e.next=91,this.upload(Z,void 0,s.signal);case 91:if(H=e.sent,W=H.file_id,$=H.meta.access_token,!u.aborted){e.next=98;break}throw(Y=new Error("Publish project aborted")).aborted=!0,Y;case 98:return K={screenshot_file_id:T,screenshot_file_token:z,model_file_id:B,model_file_token:I,scene_file_id:W,scene_file_token:$,allow_remixing:k.allowRemixing,allow_promotion:k.allowPromotion,name:k.name,attributions:{creator:k.creatorAttribution,content:k.contentAttributions}},G=this.getToken(),Q={"content-type":"application/json",authorization:"Bearer ".concat(G)},X=JSON.stringify({scene:K}),e.next=104,this.fetchUrl("".concat(V,"/publish-project/").concat(t.project_id),{method:"POST",headers:Q,body:X});case 104:if(ee=e.sent,console.log("Response: "+Object.values(ee)),!u.aborted){e.next=110;break}throw(te=new Error("Publish project aborted")).aborted=!0,te;case 110:if(200===ee.status){e.next=118;break}return e.t0=Error,e.t1="Scene creation failed. ",e.next=115,ee.text();case 115:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 118:return e.next=120,ee.json();case 120:t=e.sent,r(J,{sceneName:K.name,screenshotUrl:i,sceneUrl:this.getSceneUrl(t.scene.scene_id),onConfirm:function(){ne.emit("project-published"),a()}});case 122:return e.prev=122,i&&URL.revokeObjectURL(i),e.finish(122);case 125:return e.abrupt("return",t);case 126:case"end":return e.stop()}}),e,this,[[0,,122,125]])})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.getToken(),e.next=3,new Promise((function(e,o){var c=new XMLHttpRequest,s=function(){c.abort();var e=new Error("Upload aborted");e.name="AbortError",e.aborted=!0,o(e)};r&&r.addEventListener("abort",s),console.log("Posting to: ","".concat(V,"/media")),c.open("post","".concat(V,"/media"),!0),c.upload.addEventListener("progress",(function(e){n&&n(e.loaded/e.total)})),c.addEventListener("error",(function(e){r&&r.removeEventListener("abort",s),o(new v.mQ("Upload failed",e))})),c.addEventListener("load",(function(){if(r&&r.removeEventListener("abort",s),c.status<300){var t=JSON.parse(c.responseText);e(t)}else o(new Error("Upload failed ".concat(c.statusText)))}));var u=new FormData;a&&u.set("projectId",a),u.set("media",t),c.setRequestHeader("Authorization","Bearer ".concat(i)),c.send(u)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"uploadAssets",value:function(e,t,n,r){return this._uploadAssets("".concat(V,"/static-resource"),e,t,n,r)}},{key:"_uploadAssets",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a,i){var c,s,u,l,f=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],s=o().mark((function e(){var s,p,h,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=l[u],!i.aborted){e.next=3;break}return e.abrupt("return","break");case 3:return p=new AbortController,h=function(){return p.abort()},i.addEventListener("abort",h),e.next=8,f._uploadAsset(t,n,s,(function(e){return a(c.length+1,r.length,e)}),p.signal);case 8:if(d=e.sent,c.push(d),i.removeEventListener("abort",h),!i.aborted){e.next=13;break}return e.abrupt("return","break");case 13:case"end":return e.stop()}}),e)})),u=0,l=Array.from(r);case 3:if(!(u<l.length)){e.next=11;break}return e.delegateYield(s(),"t0",5);case 5:if("break"!==e.t0){e.next=8;break}return e.abrupt("break",11);case 8:u++,e.next=3;break;case 11:return e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,o,a){return e.apply(this,arguments)}}()},{key:"uploadAsset",value:function(e,t,n,r){return this._uploadAsset("".concat(V,"/static-resource"),e,t,n,r)}},{key:"uploadProjectAsset",value:function(e,t,n,r,o){return this._uploadAsset("".concat(V,"/project/").concat(t,"/assets"),e,n,r,o)}},{key:"_uploadAsset",value:function(){var e=(0,a.Z)(o().mark((function e(t,n,r,a,i){var c,s,u,l,f,p,h,d,m,v,g;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null,s=null,(0,b.k7)(r,b.Yj)){e.next=11;break}return e.next=5,n.generateFileThumbnail(r);case 5:return u=e.sent,e.next=8,this.upload(u,void 0,i);case 8:l=e.sent,c=l.file_id,s=l.meta.access_token;case 11:return e.next=13,this.upload(r,a,i);case 13:if(f=e.sent,p=f.file_id,h=f.meta,d=h.access_token,h.expected_content_type,m=f.origin,!((v=Date.now()-this.lastUploadAssetRequest)<1100)){e.next=23;break}return e.next=23,new Promise((function(e){return setTimeout(e,1100-v)}));case 23:return g=this.getToken(),{"content-type":"application/json",authorization:"Bearer ".concat(g)},JSON.stringify({asset:{name:r.name,file_id:p,access_token:d,thumbnail_file_id:c,thumbnail_access_token:s}}),this.lastUploadAssetRequest=Date.now(),e.abrupt("return",{id:p,name:r.name,url:m,type:"application/octet-stream",attributions:{},images:{preview:{url:r.thumbnail_url}}});case 28:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,a){return e.apply(this,arguments)}}()},{key:"deleteAsset",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getToken(),r={"content-type":"application/json",authorization:"Bearer ".concat(n)},a="".concat(V,"/static-resource/").concat(t),e.next=5,this.fetchUrl(a,{method:"DELETE",headers:r});case 5:if(i=e.sent,console.log("Response: "+Object.values(i)),401!==i.status){e.next=9;break}throw new Error("Not authenticated");case 9:if(200===i.status){e.next=17;break}return e.t0=Error,e.t1="Asset deletion failed. ",e.next=14,i.text();case 14:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteProjectAsset",value:function(){var e=(0,a.Z)(o().mark((function e(t,n){var r,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getToken(),a={"content-type":"application/json",authorization:"Bearer ".concat(r)},i="".concat(V,"/project/").concat(t,"/assets/").concat(n),e.next=5,this.fetchUrl(i,{method:"DELETE",headers:a});case 5:if(c=e.sent,console.log("Response: "+Object.values(c)),401!==c.status){e.next=9;break}throw new Error("Not authenticated");case 9:if(200===c.status){e.next=17;break}return e.t0=Error,e.t1="Project Asset deletion failed. ",e.next=14,c.text();case 14:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),new e.t0(e.t3);case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserInfo",value:function(e){localStorage.setItem("editor-user-info",JSON.stringify(e))}},{key:"getUserInfo",value:function(){return JSON.parse(localStorage.getItem("editor-user-info"))}},{key:"saveCredentials",value:function(e,t){}},{key:"fetchUrl",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,a,i,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},r=this.getToken(),null==n.headers&&(n.headers={}),n.headers.authorization="Bearer ".concat(r),console.log("Post to: ",t),console.log("Options"),console.log(n),e.next=9,fetch(t,n).catch((function(e){throw console.log(e),"Failed to fetch"===e.message&&(e.message+=" (Possibly a CORS error)"),new v.mQ('Failed to fetch "'.concat(t,'"'),e)}));case 9:if(a=e.sent,console.log(a),!a.ok){e.next=13;break}return e.abrupt("return",a);case 13:throw(i=new Error("Network Error: ".concat(a.status||"Unknown Status."," ").concat(a.statusText||"Unknown Error. Possibly a CORS error."))).response=a,i;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAuthorization",value:function(){var e=localStorage.getItem(X),t="test@test.com";(e||this.isAuthenticated())&&this.saveCredentials(t,e)}}]),n}(p())},90588:function(e,t,n){"use strict";function r(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Yj:function(){return a},mY:function(){return i},dK:function(){return c},sR:function(){return s},XM:function(){return u},E3:function(){return l},k7:function(){return f}});var a=[".mp3","audio/mpeg"],i=[".mp4","video/mp4"],c=[".png",".jpeg",".jpg",".gif","image/png","image/jpeg","image/gif"],s=[".glb","model/gltf-binary"],u=[].concat(a,i,c,s),l=u.join(",");function f(e,t){var n,o=r(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.startsWith(".")){if(e.name.toLowerCase().endsWith(a))return!0}else if(e.type.startsWith(a))return!0}}catch(i){o.e(i)}finally{o.f()}return!1}},12761:function(e,t,n){"use strict";var r=n(50931),o=n(33221),a=(0,r.default)().publicRuntimeConfig,i={},c=function(e,t,n){if(null!==o&&void 0!==o||void 0){var r=document.querySelector("meta[name='env:".concat(t.toLowerCase(),"']"));e[t]=r?r.getAttribute("content"):n}};c(i,"GA_TRACKING_ID",o.env.GA_TRACKING_ID),c(i,"SENTRY_DSN",o.env.SENTRY_DSN),i.name=function(){return"Scene Editor"},i.longName=function(){return"Scene Editor"},i.SERVER_URL=a.apiServer,i.APP_URL=a.appServer,i.FEATHERS_STORE_KEY=a.feathersStoreKey,t.Z=i},36707:function(e,t,n){"use strict";n.d(t,{c:function(){return v},Z:function(){return g}});var r=n(20193),o=n(11742),a=n(44807),i=n(27878),c=n(55956),s=n(98538),u=i.createElement;function l(){var e=(0,a.Z)(["\n  display: flex;\n  height: 64px;\n  flex-direction: row;\n  justify-content: flex-end;\n  align-items: center;\n  background-color: black;\n  border-bottom-left-radius: inherit;\n  border-bottom-right-radius: inherit;\n  padding: 8px;\n\n  a {\n    color: ",";\n  }\n\n  button {\n    min-width: 84px;\n  }\n\n  & > * {\n    margin: 0 8px;\n  }\n"]);return l=function(){return e},e}function f(){var e=(0,a.Z)(["\n  color: ",";\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  /* This forces firefox to give the contents a proper height. */\n  overflow: hidden;\n  padding: 8px;\n  min-height: 100px;\n\n  h1 {\n    font-size: 2em;\n    color: ",";\n    margin-bottom: 16px;\n  }\n\n  p {\n    margin-bottom: 12px;\n    line-height: 1.5em;\n  }\n"]);return f=function(){return e},e}function p(){var e=(0,a.Z)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  padding: 0 8px;\n  font-size: 12px;\n  overflow: hidden;\n  height: 32px;\n  background: black;\n  border-top-left-radius: inherit;\n  border-top-right-radius: inherit;\n\n  > * {\n    display: flex;\n    align-items: center;\n  }\n"]);return p=function(){return e},e}function h(){var e=(0,a.Z)(["\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  border-radius: 4px;\n  background-color: #282c31;\n  max-width: 800px;\n  min-width: 400px;\n  min-height: 150px;\n  max-height: 80vh;\n"]);return h=function(){return e},e}var d=s.ZP.form(h()),m=s.ZP.div(p()),v=s.ZP.div(f(),(function(e){return e.theme.text2}),(function(e){return e.theme.text})),b=s.ZP.div(l(),(function(e){return e.theme.text2}));function g(e){var t=e.tag,n=e.title,a=e.onCancel,s=e.cancelLabel,l=e.onConfirm,f=e.confirmLabel,p=e.bottomNav,h=e.children,g=(0,o.Z)(e,["tag","title","onCancel","cancelLabel","onConfirm","confirmLabel","bottomNav","children"]),x=(0,i.useCallback)((function(e){e.preventDefault(),l&&l(e)}),[l]),y=u(c.zx,{type:"submit",onClick:"form"===t?null:l},f);return u(d,(0,r.Z)({as:t,onSubmit:x},g),u(m,null,u("span",null,n)),u(v,null,h),(l||a||p)&&u(b,null,p,a&&u(c.kq,{onClick:a},s),l&&y))}g.defaultProps={tag:"form",title:"Editor",confirmLabel:"Ok",cancelLabel:"Cancel"}},4314:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(11742),o=n(44807),a=n(27878),i=n(36707),c=n(98538),s=a.createElement;function u(){var e=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  padding: 30px 30px;\n"]);return u=function(){return e},e}function l(){var e=(0,o.Z)(["\n  display: flex;\n  width: 360px;\n  border-top-left-radius: inherit;\n  align-items: center;\n  padding: 30px;\n\n  img {\n    border-radius: 6px;\n  }\n"]);return l=function(){return e},e}var f=c.ZP.div(l()),p=c.ZP.div(u());function h(e){var t=e.imageSrc,n=e.children,o=(0,r.Z)(e,["imageSrc","children"]);return s(i.Z,o,s(f,null,s("img",{src:t})),s(p,null,n))}},39956:function(e,t,n){"use strict";n.d(t,{i:function(){return g}});var r=n(20193),o=n(11742),a=n(44807),i=n(27878),c=n(36707),s=n(98538),u=i.createElement;function l(){var e=(0,a.Z)(["\n  height: 20px;\n  position: relative;\n  background: ",";\n  border-radius: 4px;\n\n  & > span {\n    display: block;\n    height: 100%;\n    border-radius: 4px;\n    background-color: ",';\n    position: relative;\n    overflow: hidden;\n\n    &:after {\n      content: "";\n      position: absolute;\n      top: 0;\n      left: 0;\n      bottom: 0;\n      right: 0;\n      background-image: linear-gradient(\n        -45deg,\n        rgba(255, 255, 255, 0.2) 25%,\n        transparent 25%,\n        transparent 50%,\n        rgba(255, 255, 255, 0.2) 50%,\n        rgba(255, 255, 255, 0.2) 75%,\n        transparent 75%,\n        transparent\n      );\n      z-index: 1;\n      background-size: 50px 50px;\n      animation: move 2s linear infinite;\n      border-radius: 4px;\n      overflow: hidden;\n    }\n  }\n\n  & > span > span {\n    content: "";\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background-image: linear-gradient(\n      -45deg,\n      rgba(255, 255, 255, 0.2) 25%,\n      transparent 25%,\n      transparent 50%,\n      rgba(255, 255, 255, 0.2) 50%,\n      rgba(255, 255, 255, 0.2) 75%,\n      transparent 75%,\n      transparent\n    );\n    z-index: 1;\n    background-size: 50px 50px;\n    animation: move 2s linear infinite;\n    border-radius: 4px;\n    overflow: hidden;\n  }\n\n  @keyframes move {\n    0% {\n      background-position: 0 0;\n    }\n    100% {\n      background-position: 50px 50px;\n    }\n  }\n']);return l=function(){return e},e}var f=s.ZP.div(l(),(function(e){return e.theme.panel2}),(function(e){return e.theme.blue}));function p(){return u(f,null,u("span",null,u("span",null)))}var h=i.createElement;function d(){var e=(0,a.Z)(["\n  padding-bottom: 24px;\n  white-space: pre;\n"]);return d=function(){return e},e}function m(){var e=(0,a.Z)(["\n  color: ",";\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  /* This forces firefox to give the contents a proper height. */\n  overflow: hidden;\n  padding: 8px;\n"]);return m=function(){return e},e}var v=s.ZP.div(m(),(function(e){return e.theme.text2})),b=s.ZP.div(d());function g(e){var t=e.message,n=(e.onConfirm,e.cancelable),a=e.onCancel,i=(0,o.Z)(e,["message","onConfirm","cancelable","onCancel"]);return h(c.Z,(0,r.Z)({onCancel:n?a:null},i),h(v,null,h(b,null,t),h(p,null)))}g.defaultProps={title:"Loading...",message:"Loading...",cancelable:!1,cancelLabel:"Cancel"}},78158:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(20193),o=n(11742),a=n(49182),i=n(39337),c=n(13987),s=n(29569),u=n(89306),l=n(44807),f=n(27878),p=n(9424),h=n(98538),d=n(50422),m=n.n(d),v=n(5391),b=f.forwardRef((function(e,t){return f.createElement(v.r,m()({iconAttrs:{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},iconVerticalAlign:"middle",iconViewBox:"0 0 512 512"},e,{ref:t}),f.createElement("path",{fill:"currentColor",d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"}))}));b.displayName="Check";var g=f.createElement;function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var o=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}function y(){var e=(0,l.Z)(["\n  position: absolute;\n  top: 3px;\n  left: 2px;\n  color: ",";\n"]);return y=function(){return e},e}function w(){var e=(0,l.Z)(["\n  width: 18px;\n  height: 18px;\n  margin: 4px;\n  cursor: pointer;\n  display: block;\n  position: relative;\n"]);return w=function(){return e},e}function k(){var e=(0,l.Z)(["\n  display: none;\n\n  :disabled ~ label {\n    background-color: ",";\n    color: ",";\n  }\n"]);return k=function(){return e},e}var _=0,j=h.ZP.input(k(),(function(e){return e.theme.disabled}),(function(e){return e.theme.disabledText})),C=(0,h.ZP)(p.Z).attrs((function(){return{as:"label"}}))(w()),S=(0,h.ZP)(b)(y(),(function(e){return e.theme.blue})),P=function(e){(0,c.Z)(n,e);var t=x(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).onChange=function(e){r.props.onChange(e.target.checked)},r.checkboxId="boolean-input-".concat(_++),r}return(0,i.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.value,n=(e.onChange,(0,o.Z)(e,["value","onChange"]));return g("div",null,g(j,(0,r.Z)({},n,{id:this.checkboxId,type:"checkbox",checked:t,onChange:this.onChange})),g(C,{htmlFor:this.checkboxId},t&&g(S,{size:12})))}}]),n}(f.Component);P.defaultProps={value:!1,onChange:function(){}}},69867:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(11742),o=n(44807),a=n(27878),i=n(98538),c=a.createElement;function s(){var e=(0,o.Z)(["\n  display: flex;\n  justify-content: space-between;\n\n  & > * {\n    margin-left: 30px;\n    align-self: center;\n  }\n\n  & > :first-child {\n    margin-left: 0;\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,o.Z)(["\n  margin-bottom: 16px;\n\n  label {\n    display: block;\n    margin-bottom: 8px;\n  }\n"]);return u=function(){return e},e}var l=i.ZP.div(u()),f=i.ZP.div(s());function p(e){var t=e.inline,n=e.children,o=(0,r.Z)(e,["inline","children"]);return c(t?f:l,o,n)}},31542:function(e,t,n){"use strict";n.d(t,{N:function(){return a}});var r=n(27878),o={a:"",lato:"'Lato', sans-serif",zilla:"'Zilla Slab', sans-serif",background:"#15171B",inputBackground:"#070809",border:"#5D646C",panel:"#282C31",panel2:"#3A4048",selected:"#006EFF",selectedText:"#fff",hover:"#4B5562",hover2:"#636F80",text:"#FFFFFF",text2:"#9FA4B5",dropdown:"#000000",red:"#F44336",pink:"#E91E63",purple:"#9C27B0",deepPurple:"#673AB7",indigo:"#3F51B5",blue:"#006EFF",lightBlue:"#03A9F4",cyan:"#00BCD4",teal:"#009688",green:"#4CAF50",lightGreen:"#8BC34A",lime:"#CDDC39",yellow:"#FFEB3B",amber:"#FFC107",orange:"#FF9800",deepOrange:"#FF5722",brown:"#795548",blueHover:"#4D93F1",bluePressed:"#0554BC",disabled:"#222222",disabledText:"grey",deemphasized:"grey",toolbar:"#4D535B",toolbar2:"#43484F",header:"#1b1b1b",white:"#fff",shadow15:"0px 4px 4px  rgba(0, 0, 0, 0.15)",shadow30:"0px 4px 4px  rgba(0, 0, 0, 0.3)",borderStyle:"1px solid #5D646C"};o.chartColors=[o.red,o.pink,o.purple,o.deepPurple,o.indigo,o.blue,o.lightBlue,o.cyan,o.teal,o.green,o.lightGreen,o.lime,o.yellow,o.amber,o.orange,o.deepOrange,o.brown];var a=r.createContext(o);t.Z=o}}]);