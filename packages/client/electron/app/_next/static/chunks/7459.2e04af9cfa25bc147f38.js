(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7459],{60645:function(e,t,n){"use strict";n.d(t,{nZ:function(){return p},aG:function(){return m}});var r=n(48533),i=n.n(r),o=n(64414),a=n(58700),s=n(36595),u=n(47396),c=n(664),l=n(80620),d=n(91365),f=new l.E,h=null;function p(){return f}u.C?(h=new c._).setDecoderPath("/loader_decoders/"):((h=new d.Z).getDecoderModule=function(){},h.preload=function(){}),f.setDRACOLoader(h);var m=function(e){v(e.parser),y(e)},v=function(e){for(var t=function(){var t=(0,a.Z)(i().mark((function t(n){var r,a,s,u,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.json.materials[n].extensions.MOZ_lightmap,t.next=3,Promise.all([e.getDependency("material",n),e.getDependency("texture",r.index)]);case 3:return a=t.sent,s=(0,o.Z)(a,2),u=s[0],c=s[1],u.lightMap=c,u.lightMapIntensity=void 0!==r.intensity?r.intensity:1,u.needsUpdate=!0,t.abrupt("return",c);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),n=0;n<e.json.materials.length;n++){var r=e.json.materials[n];r.extensions&&(r.extensions.MOZ_lightmap&&t(n))}},y=function(e){var t,n,r,i;if(3===(null===(i=null===(r=null===(n=null===(t=e.parser.json)||void 0===t?void 0:t.extensions)||void 0===n?void 0:n.MOZ_hubs_components)||void 0===r?void 0:r.MOZ_hubs_components)||void 0===i?void 0:i.version)){var o=[];e.scene.traverse((function(e){if(e.userData.gltfExtensions&&e.userData.gltfExtensions.MOZ_hubs_components){var t;switch(Object.keys(e.userData.gltfExtensions.MOZ_hubs_components)[0]){case"point-light":t=E(e);break;case"ambient-light":t=w(e)}t&&(t.position.copy(e.position),t.quaternion.copy(e.quaternion),e.parent.add(t),o.push(e),console.log(t))}}));for(var a=0,s=o;a<s.length;a++){var u=s[a];u.parent.remove(u)}}},g=function(e,t){"undefined"!==typeof t.castShadow&&(e.castShadow=t.castShadow),"undefined"!==typeof t.shadowResolution&&e.shadow.mapSize.set(t.shadowResolution[0],t.shadowResolution[1]),"undefined"!==typeof t.shadowBias&&(e.shadow.bias=t.shadowBias),"undefined"!==typeof t.shadowRadius&&(e.shadow.radius=t.shadowRadius)},E=function(e){var t=e.userData.gltfExtensions.MOZ_hubs_components["point-light"],n=new s.cek(t.color,t.intensity,t.distance,t.decay);return g(n,t),n},w=function(e){var t=e.userData.gltfExtensions.MOZ_hubs_components["ambient-light"];return new s.Mig(t.color,t.intensity)}},68920:function(e,t,n){"use strict";n(36595)},44978:function(e,t,n){"use strict";n.d(t,{n2:function(){return i}});var r=n(33221),i=("undefined"!==typeof window&&window.document,"object"===typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name);"undefined"!==typeof r&&null!=r.versions&&r.versions.node},49903:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=!1;if("undefined"!==typeof navigator&&"undefined"!==typeof window){var i=(null===navigator||void 0===navigator?void 0:navigator.userAgent)||(null===navigator||void 0===navigator?void 0:navigator.vendor)||(null===window||void 0===window?void 0:window.opera);r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))}var o=function(){var e,t;return(null===(t=null===(e=globalThis)||void 0===e?void 0:e.__messageQueue)||void 0===t?void 0:t.isMobile)||r}},46365:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r="undefined"!==typeof window&&"undefined"!==typeof window.performance?performance.now.bind(performance):Date.now.bind(Date)},483:function(e,t,n){"use strict";n.d(t,{Bb:function(){return k},SJ:function(){return b},D4:function(){return A},VY:function(){return S},fO:function(){return D}});var r=n(49182),i=n(36595),o=n(73601),a=n(87227),s=n(85602),u=n(80375),c=n(44978),l=n(57227),d=n(13987),f=n(29569),h=n(89306),p=n(39337),m=n(76207);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}var y=function(){function e(){(0,r.Z)(this,e),this.gain={value:0}}return(0,p.Z)(e,[{key:"connect",value:function(){}},{key:"disconnect",value:function(){}}]),e}(),g=function(){function e(){(0,r.Z)(this,e),this.panningModel="HRTF",this.gain={value:0}}return(0,p.Z)(e,[{key:"connect",value:function(){}},{key:"disconnect",value:function(){}}]),e}(),E=function(e){(0,d.Z)(n,e);var t=v(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this)).type="Audio",i.listener=e,i.context=e.context,i.gain=new y,i.autoplay=!1,i.detune=0,i.loop=!1,i.loopStart=0,i.loopEnd=0,i.offset=0,i.duration=void 0,i.playbackRate=1,i.isPlaying=!1,i.hasPlaybackControl=!0,i.source=null,i.sourceType="empty",i.filters=[],i}return(0,p.Z)(n,[{key:"getOutput",value:function(){}},{key:"setNodeSource",value:function(e){return this.__callFunc("setNodeSource",e),this}},{key:"setMediaElementSource",value:function(e){return this.messageQueue.queue.push({messageType:m.Cs.AUDIO_SOURCE_ELEMENT_SET,message:{sourceID:e.uuid,proxyID:this.proxyID}}),this}},{key:"setMediaStreamSource",value:function(e){return this.messageQueue.queue.push({messageType:m.Cs.AUDIO_SOURCE_STREAM_SET,message:{sourceID:e,proxyID:this.proxyID}}),this}},{key:"setBuffer",value:function(e){return this.messageQueue.queue.push({messageType:m.Cs.AUDIO_BUFFER_SET,message:{bufferID:e,proxyID:this.proxyID}}),this}},{key:"play",value:function(){return this.__callFunc("play"),this}},{key:"pause",value:function(){return this.__callFunc("pause"),this}},{key:"stop",value:function(){return this.__callFunc("stop"),this}},{key:"connect",value:function(){return this.__callFunc("connect"),this}},{key:"disconnect",value:function(){return this.__callFunc("disconnect"),this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return this.filters=e,this.__callFunc("setFilters",e),this}},{key:"setDetune",value:function(e){return this.detune=e,this.__callFunc("setDetune",e),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){return this.playbackRate=e,this.__callFunc("setPlaybackRate",e),this}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return this.loop}},{key:"setLoop",value:function(e){return this.__callFunc("setLoop",e),this.loop=e,this}},{key:"setVolume",value:function(e){return this.__callFunc("setVolume",e),this.gain.gain.value=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}}]),n}(m.ps),w=function(e){(0,d.Z)(n,e);var t=v(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).type="PositionalAudio",i.panner=new g,i}return(0,p.Z)(n,[{key:"getOutput",value:function(){}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.__callFunc("setRefDistance",e),this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.__callFunc("setRolloffFactor",e),this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.__callFunc("setDistanceModel",e),this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.__callFunc("setMaxDistance",e),this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.__callFunc("setMaxDistance",e,t,n),this}}]),n}(E),_=new(function(){function e(){(0,r.Z)(this,e),this.messageQueue=globalThis.__messageQueue}return(0,p.Z)(e,[{key:"createMediaElementSource",value:function(e){return document.createElement("mediaElementSource",{elementID:e.uuid})}}]),e}()),T=function(e){(0,d.Z)(n,e);var t=v(n);function n(){var e;return(0,r.Z)(this,n),(e=t.call(this,{type:"AudioListener"})).gain=new y,e.filter=null,e.context=_,e}return(0,p.Z)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return this.filter}},{key:"getFilter",value:function(){return this.__callFunc("getFilter"),this}},{key:"setFilter",value:function(e){return this.__callFunc("setFilter",e),this.filter=e,this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.__callFunc("setMasterVolume",e),this.gain.gain.value=e,this}}]),n}(m.ps),k=c.n2?E:i.BbS,b=c.n2?T:i.SJI,S=c.n2?w:i.VYz,D=c.n2?l.Q:i.fO1,A=function e(){(0,r.Z)(this,e)};A.engineTimer=null,A.engineIKTimer=null,A.isExecuting=!1,A.physicsFrameRate=60,A.networkFramerate=20,A.timeScaleTarget=1,A.clock=new i.SUY,A.renderer=null,A.csm=null,A.xrSession=null,A.context=null,A.scene=null,A.camera=null,A.cameraTransform=null,A.audioListener=null,A.eventDispatcher=new s.H,A.options={entityPoolSize:0},A.enabled=!0,A.deferredRemovalEnabled=!0,A.systems=[],A.entities=[],A.entityMap=new Map,A.queries=[],A.components=[],A.nextEntityId=0,A.nextComponentId=0,A.entityPool=new a.n(o.J),A.componentsMap={},A.componentPool={},A.numComponents={},A.entitiesWithComponentsToRemove=[],A.entitiesToRemove=[],A.systemsToExecute=[],A.tick=0,A.createElement=u.a,A.hasUserEngaged=!1,A.useAudioSystem=!1,A.inputState=new Map,A.prevInputState=new Map,A.gamepadConnected=!1,A.gamepadThreshold=.1,A.gamepadButtons=[],A.gamepadInput=[],A.xrSupported=!1},34452:function(e,t,n){"use strict";n.d(t,{NL:function(){return E},On:function(){return w},cD:function(){return b}});var r=n(39337),i=n(42828),o=n(49182),a=n(94780),s=n(13987),u=n(29569),c=n(89306),l=n(79559),d=(n(61467),n(46192)),f=n(41912),h=n(65622),p=n(95812),m=n(5297),v=n(16090),y=n(483);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.Z)(e);if(t){var i=(0,c.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var E=function(e){(0,s.Z)(n,e);var t=g(n);function n(){var e;return(0,o.Z)(this,n),e=t.call(this),n.instance=(0,a.Z)(e),e}return n}(l.p);E.EVENTS={CONNECT_TO_WORLD:"CORE_CONNECT_TO_WORLD",CONNECT_TO_WORLD_TIMEOUT:"CORE_CONNECT_TO_WORLD_TIMEOUT",JOINED_WORLD:"CORE_JOINED_WORLD",LEAVE_WORLD:"CORE_LEAVE_WORLD",LOAD_SCENE:"CORE_LOAD_SCENE",SCENE_LOADED:"CORE_SCENE_LOADED",ENTITY_LOADED:"CORE_ENTITY_LOADED",ENABLE_SCENE:"CORE_ENABLE_SCENE",LOAD_AVATAR:"CORE_LOAD_AVATAR",CLIENT_ENTITY_LOAD:"CORE_CLIENT_ENTITY_LOAD",USER_ENGAGE:"CORE_USER_ENGAGE",ENTITY_DEBUG_DATA:"CORE_ENTITY_DEBUG_DATA"};var w=function(){E.instance.addEventListener(E.EVENTS.LOAD_SCENE,(function e(t){(0,h.e)(t.result),E.instance.removeEventListener(E.EVENTS.LOAD_SCENE,e)}));E.instance.addEventListener(E.EVENTS.JOINED_WORLD,(function e(t){(0,d.C)(t.worldState),E.instance.removeEventListener(E.EVENTS.JOINED_WORLD,e)})),E.instance.addEventListener(f.T.EVENTS.RECEIVE_DATA,(function(e){(0,d.C)(e.unbufferedState,e.delta)})),E.instance.addEventListener(E.EVENTS.LOAD_AVATAR,(function(e){var t=(0,v.rV)(e.entityID),n=(0,v.Ei)(t,p.rl);null!=n&&(n.avatarId=e.avatarId),(0,m.Of)(t)}));E.instance.addEventListener(E.EVENTS.USER_ENGAGE,(function e(){y.D4.hasUserEngaged=!0,E.instance.removeEventListener(E.EVENTS.USER_ENGAGE,e)}))},_="ENGINE_EVENTS_PROXY_EVENT",T="ENGINE_EVENTS_PROXY_EVENT_ADD",k="ENGINE_EVENTS_PROXY_EVENT_REMOVE",b=function(e){(0,s.Z)(n,e);var t=g(n);function n(e){var r;(0,o.Z)(this,n),(r=t.call(this)).messageQueue=e;var i=function(e){r.messageQueue.sendEvent(_,{event:e})};return r.messageQueue.addEventListener(T,(function(e){var t=e.detail.type;r.addEventListener(t,i,!0)})),r.messageQueue.addEventListener(k,(function(e){var t=e.detail.type;r.removeEventListener(t,i,!0)})),r.messageQueue.addEventListener(_,(function(e){var t=e.detail.event;r.dispatchEvent(t,!0)})),r}return(0,r.Z)(n,[{key:"addEventListener",value:function(e,t,r){r||this.messageQueue.sendEvent(T,{type:e}),(0,i.Z)((0,c.Z)(n.prototype),"addEventListener",this).call(this,e,t)}},{key:"removeEventListener",value:function(e,t,r){r||this.messageQueue.sendEvent(k,{type:e}),(0,i.Z)((0,c.Z)(n.prototype),"removeEventListener",this).call(this,e,t)}},{key:"dispatchEvent",value:function(e,t,r){t||this.messageQueue.sendEvent(_,{event:e},r),(0,i.Z)((0,c.Z)(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(E)},16090:function(e,t,n){"use strict";n.d(t,{Ei:function(){return u},Tk:function(){return c},aT:function(){return l},tu:function(){return d},Qe:function(){return f},af:function(){return h},JP:function(){return p},Sx:function(){return m},Xr:function(){return v},rV:function(){return y}});var r=n(483),i=n(86463),o=n(57473),a=n(8603),s=n(73731);function u(e,t){var n=e.components[t._typeId];if(n){for(var r=0;r<e.queries.length;r++){var i=e.queries[r];i.reactive&&-1!==i.components.indexOf(t)&&i.eventDispatcher.dispatchEvent(s.eE,e,n)}return n}}function c(e,t,n){if("undefined"!==typeof t._typeId||r.D4.componentsMap[t._typeId]||(0,i.RM)(t),!~e.componentTypes.indexOf(t)){e.componentTypes.push(t),void 0!==t.isSystemStateComponent&&e.numStateComponents++;var a=new o.L(t),u=a?a.acquire():new t(n);for(var c in u.entity=e,u._typeId=t._typeId,a&&n&&u.copy(n),e.components[t._typeId]=u,r.D4.queries){var l=r.D4.queries[c];~l.notComponents.indexOf(t)&&~l.entities.indexOf(e)?l.removeEntity(e):~l.components.indexOf(t)&&l.match(e)&&!~l.entities.indexOf(e)&&l.addEntity(e)}return r.D4.numComponents[u._typeId]++,r.D4.eventDispatcher.dispatchEvent(s.NR,e,t),u}}function l(e,t,n){var i=e.componentTypes.indexOf(t);if(~i){var o=e.components[t._typeId];if(r.D4.eventDispatcher.dispatchEvent(s.ub,e,o),n){e.componentTypes.splice(i,1);var u=e.components[o._typeId];delete e.components[o._typeId],u.dispose(),r.D4.numComponents[o._typeId]--}else 0===e.componentTypesToRemove.length&&r.D4.entitiesWithComponentsToRemove.push(e),e.componentTypes.splice(i,1),e.componentTypesToRemove.push(o),e.componentsToRemove[o._typeId]=e.components[o._typeId],delete e.components[o._typeId];for(var c in r.D4.queries){var l=r.D4.queries[c];~l.notComponents.indexOf(t)&&!~l.entities.indexOf(e)&&l.match(e)?l.addEntity(e):~l.components.indexOf(t)&&~l.entities.indexOf(e)&&!l.match(e)&&l.removeEntity(e)}return t.__proto__===a.h&&(e.numStateComponents--,0===e.componentTypes.length&&m(e)),o}}function d(e,t,n){return e.componentTypes.length>0&&!!~e.componentTypes.indexOf(t)||void 0!==n&&n&&function(e,t){return!!~e.componentTypesToRemove.indexOf(t)}(e,t)}function f(e,t){for(var n=0;n<t.length;n++)if(!d(e,t[n]))return!1;return!0}function h(e,t){for(var n=0;n<t.length;n++)if(d(e,t[n]))return!0;return!1}function p(){var e=r.D4.entityPool.acquire();return r.D4.entities.push(e),r.D4.entityMap.set(String(e.id),e),r.D4.eventDispatcher.dispatchEvent(s.yP,e),e}function m(e,t){var n=r.D4.entities.indexOf(e);if(~n){if(0===e.numStateComponents){for(var i in r.D4.eventDispatcher.dispatchEvent(s.tm,e),r.D4.queries){var o=r.D4.queries[i];-1!==e.queries.indexOf(o)&&o.removeEntity(e)}t?(r.D4.entities.splice(n,1),r.D4.entityMap.delete(String(e.id)),r.D4.entityPool.release(e)):r.D4.entitiesToRemove.push(e)}!function(e,t){for(var n=e.componentTypes,r=n.length-1;r>=0;r--)n[r].__proto__!==a.h&&l(e,n[r],t)}(e,t)}else console.error("Tried to remove entity not in list")}function v(e,t,n){var r=e.components[t._typeId];return!r&&n&&(r=e.componentsToRemove[t._typeId]),r}function y(e){return r.D4.entityMap.get(String(e))}},17356:function(e,t,n){"use strict";var r;n.d(t,{V:function(){return r}}),function(e){e[e.Free=0]="Free",e[e.Fixed=1]="Fixed",e[e.Network=2]="Network"}(r||(r={}))},71362:function(e,t,n){"use strict";n.d(t,{mQ:function(){return l}});var r=n(49182),i=n(94780),o=n(13987),a=n(29569),s=n(89306);function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var c=function(e){(0,o.Z)(n,e);var t=u(n);function n(e){var o;return(0,r.Z)(this,n),(o=t.call(this,e)).name=o.constructor.name,o.message=e,"function"===typeof Error.captureStackTrace?Error.captureStackTrace((0,i.Z)(o),o.constructor):o.stack=new Error(e).stack,o}return n}((0,n(49135).Z)(Error)),l=function(e){(0,o.Z)(n,e);var t=u(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,"".concat(e,":\n  Cause:\n    ").concat(function(e){if(!e)return"";if(e.message)return e.message;var t=e.target;return t?e.target.error&&e.target.error.message?t.error.message:e.target.src?'Failed to load "'.concat(t.src,'"'):t instanceof XMLHttpRequest?"Network Error: ".concat(t.status||"Unknown Status."," ").concat(t.statusText||"Unknown Error. Possibly a CORS error."):"Unknown error on ".concat(t,"."):'Unknown error: "'.concat(JSON.stringify(e),'"')}(i).replace(/\n/g,"\n    ")))).originalError=i,o.stack+="\n"+i.stack,o}return n}(c)},25802:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(36595),i=n(71362);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.dpR;return new Promise((function(n,r){t.load(e,n,null,(function(t){return r(new i.mQ('Error loading texture "'.concat(e,'"'),t))}))}))}},92226:function(e,t,n){"use strict";n.d(t,{FJ:function(){return N},$6:function(){return L},ju:function(){return M}});var r=n(48533),i=n.n(r),o=n(58700),a=(n(83052),n(16090)),s=n(7331),u=n(45744),c=n(5418),l=n(64414),d=n(15194),f=n(63290),h=n(77866);function p(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),g=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.thrown"),w=function(e){return"object"===typeof e&&null!==e||"function"===typeof e},_=new Map([["proxy",{canHandle:function(e){return w(e)&&e[v]},serialize:function(e){var t=new MessageChannel,n=t.port1,r=t.port2;return T(e,n),[r,[r]]},deserialize:function(e){return e.start(),S(e,[],t);var t}}],["throw",{canHandle:function(e){return w(e)&&E in e},serialize:function(e){var t=e.value;return[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;t.addEventListener("message",(function n(r){if(r&&r.data){var i,o=Object.assign({path:[]},r.data),a=o.id,s=o.type,u=o.path,c=(r.data.argumentList||[]).map(R);try{var p=u.slice(0,-1).reduce((function(e,t){return e[t]}),e),m=u.reduce((function(e,t){return e[t]}),e);switch(s){case 0:i=m;break;case 1:p[u.slice(-1)[0]]=R(r.data.value),i=!0;break;case 2:i=m.apply(p,c);break;case 3:var v;i=O((0,f.Z)(m,(0,h.Z)(c)));break;case 4:var y=new MessageChannel,g=y.port1,w=y.port2;T(e,w),i=C(g,[g]);break;case 5:i=void 0}}catch(v){i=(0,d.Z)({value:v},E,0)}Promise.resolve(i).catch((function(e){return(0,d.Z)({value:e},E,0)})).then((function(e){var r=P(e),i=(0,l.Z)(r,2),o=i[0],u=i[1];t.postMessage(Object.assign(Object.assign({},o),{id:a}),u),5===s&&(t.removeEventListener("message",n),k(t))}))}})),t.start&&t.start()}function k(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function b(e){if(e)throw new Error("Proxy has been released and is not useable")}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=!1,i=new Proxy(n,{get:function(n,o){if(b(r),o===g)return function(){return x(e,{type:5,path:t.map((function(e){return e.toString()}))}).then((function(){k(e),r=!0}))};if("then"===o){if(0===t.length)return{then:function(){return i}};var a=x(e,{type:0,path:t.map((function(e){return e.toString()}))}).then(R);return a.then.bind(a)}return S(e,[].concat((0,h.Z)(t),[o]))},set:function(n,i,o){b(r);var a=P(o),s=(0,l.Z)(a,2),u=s[0],c=s[1];return x(e,{type:1,path:[].concat((0,h.Z)(t),[i]).map((function(e){return e.toString()})),value:u},c).then(R)},apply:function(n,i,o){b(r);var a=t[t.length-1];if(a===y)return x(e,{type:4}).then(R);if("bind"===a)return S(e,t.slice(0,-1));var s=D(o),u=(0,l.Z)(s,2),c=u[0],d=u[1];return x(e,{type:2,path:t.map((function(e){return e.toString()})),argumentList:c},d).then(R)},construct:function(n,i){b(r);var o=D(i),a=(0,l.Z)(o,2),s=a[0],u=a[1];return x(e,{type:3,path:t.map((function(e){return e.toString()})),argumentList:s},u).then(R)}});return i}function D(e){var t,n=e.map(P);return[n.map((function(e){return e[0]})),(t=n.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var A=new WeakMap;function C(e,t){return A.set(e,t),e}function O(e){return Object.assign(e,(0,d.Z)({},v,!0))}function P(e){var t,n=p(_);try{for(n.s();!(t=n.n()).done;){var r=(0,l.Z)(t.value,2),i=r[0],o=r[1];if(o.canHandle(e)){var a=o.serialize(e),s=(0,l.Z)(a,2);return[{type:3,name:i,value:s[0]},s[1]]}}}catch(u){n.e(u)}finally{n.f()}return[{type:0,value:e},A.get(e)||[]]}function R(e){switch(e.type){case 3:return _.get(e.name).deserialize(e.value);case 0:return e.value}}function x(e,t,n){return new Promise((function(r){var i=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}n(34452);var N={FACE_INPUT:"WEBCAM_INPUT_EVENTS_FACE_INPUT",LIP_INPUT:"WEBCAM_INPUT_EVENTS_LIP_INPUT"},Z={angry:u.fw.Angry,disgusted:u.fw.Disgusted,fearful:u.fw.Fearful,happy:u.fw.Happy,neutral:u.fw.Neutral,sad:u.fw.Sad,surprised:u.fw.Surprised};function L(e,t){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)(i().mark((function e(t,n){var r,o,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n||void 0===n.expressions){e.next=12;break}r=(0,a.Ei)(t,s.I),e.t0=i().keys(n.expressions);case 3:if((e.t1=e.t0()).done){e.next=12;break}if(o=e.t1.value,u=Z[o],l=r.schema.inputMap.get(u)){e.next=9;break}return e.abrupt("continue",3);case 9:r.data.set(l,{type:c.n.ONEDIM,value:n.expressions[o]<.1?0:n.expressions[o]}),e.next=3;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(e,t,n,r){var i=(0,a.Ei)(e,s.I);t>.2?i.data.set(Z.pucker,{type:c.n.ONEDIM,value:t}):i.data.has(Z.pucker)&&i.data.delete(Z.pucker),n>.2?i.data.set(Z.widen,{type:c.n.ONEDIM,value:n}):i.data.has(Z.widen)&&i.data.delete(Z.widen),r>.2?i.data.set(Z.open,{type:c.n.ONEDIM,value:r}):i.data.has(Z.open)&&i.data.delete(Z.open)}},84711:function(e,t,n){"use strict";n.d(t,{H6:function(){return i}});var r={qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}}},i={audio:!0,video:{width:r.qvga.width,height:r.qvga.height,frameRate:{max:30}}}},46192:function(e,t,n){"use strict";n.d(t,{C:function(){return g}});var r=n(36595),i=n(483),o=n(16090),a=n(93228),s=n(61467),u=n(77301),c=n(5957),l=n(49026),d=n(95812),f=n(98847),h=n(88334),p=n(12665),m=n(95070),v=n(30307);function y(e){for(var t=0;t<i.D4.entities.length;t++){var n=i.D4.entities[t];if((0,o.tu)(n,h.g)&&(0,o.Xr)(n,h.g).entityIdFromScenaLoader&&(0,o.tu)(n,u.H))(0,o.Xr)(n,h.g).entityIdFromScenaLoader.entityId===e.uniqueId&&(0,o.Xr)(n,u.H).networkId!==e.networkId&&((0,o.Ei)(n,u.H).networkId=e.networkId,e.networkId)}for(var r=0;r<i.D4.entities.length;r++){var a=i.D4.entities[r];if((0,o.tu)(a,h.g)&&(0,o.tu)(a,u.H)){var c=(0,o.Xr)(a,u.H).networkId;s.Z.instance.networkObjects[c]||"server"==e.ownerId&&(s.Z.instance.networkObjects[e.networkId]={ownerId:"server",prefabType:f.s0.worldObject,component:(0,o.Xr)(a,u.H),uniqueId:e.uniqueId})}}}function g(e){var t;for(var n in s.Z.tick,e.tick,e.transforms.length&&(s.Z.tick=e.tick,s.Z.instance.worldState=e),e.clientsConnected)s.Z.instance.clients[e.clientsConnected[n].userId]={userId:e.clientsConnected[n].userId};for(var i in e.clientsDisconnected)void 0!==e.clientsConnected[i]?(console.log(e.clientsConnected[i].userId," disconnected"),delete s.Z.instance.clients[e.clientsConnected[i].userId]):console.warn("Client disconnected but was not found in our client list");for(var u in e.createObjects)if(void 0!==s.Z.instance.networkObjects[e.createObjects[u].networkId])console.warn("Not creating object because it already exists");else{var h=e.createObjects[u],g=null,E=null;if("number"!==typeof h.x&&"number"!==typeof h.y&&"number"!==typeof h.z||(g=new r.Pa4(h.x,h.y,h.z)),"number"!==typeof h.qX&&"number"!==typeof h.qY&&"number"!==typeof h.qZ&&"number"!==typeof h.qW||(E=new r._fP(h.qX,h.qY,h.qZ,h.qW)),h.prefabType===f.s0.worldObject)y(h);else{var w=(0,l.K)(String(h.ownerId),h.networkId,h.prefabType,g,E);h.ownerId===s.Z.instance.userId?(console.warn("Give Player Id by Server "+h.networkId,h.ownerId,s.Z.instance.userId),console.warn(s.Z.instance.networkObjects),s.Z.instance.localAvatarNetworkId=h.networkId,(0,o.Tk)(w.entity,v.e)):(0,o.Tk)(w.entity,v.e)}}if(e.transforms.length){var _=e.transforms.find((function(e){return e.networkId==s.Z.instance.localAvatarNetworkId})),T=(0,c.Ox)(e.transforms);T.timeCorrection=_?_.snapShotTime+s.Z.instance.timeSnaphotCorrection:0,T.time=e.time,s.Z.instance.snapshot=T,(0,c.eW)(T)}for(var k in e.editObjects){var b=e.editObjects[k].networkId,S=e.editObjects[k].whoIsItFor;if(s.Z.instance.localAvatarNetworkId!=b||"all"==S){if(void 0===s.Z.instance.networkObjects[b])return console.warn("Can't Edit object, as it doesn't appear to exist");e.editObjects[k].component;var D=e.editObjects[k].state,A=e.editObjects[k].currentId,C=e.editObjects[k].value,O=s.Z.instance.networkObjects[b].component.entity;"onAddedEnding"==D&&("all"==S&&s.Z.instance.localAvatarNetworkId==b&&((0,o.aT)(O,a.$),(0,o.aT)(O,m.F)),(0,o.tu)(O,p.I)||(0,o.Tk)(O,p.I,{state:D,networkCarId:A,currentFocusedPart:C})),"onStartRemove"==D&&((0,o.tu)(O,p.I)?(0,o.Ei)(O,p.I).state=D:console.warn(s.Z.instance.localAvatarNetworkId+" "+b+" hasNot PlayerInCar component"))}}for(var P in e.destroyObjects){var R=e.destroyObjects[P].networkId;if(console.log("Destroying ",R),void 0===s.Z.instance.networkObjects[R])return console.warn("Can't destroy object as it doesn't appear to exist");console.log("Destroying network object ",s.Z.instance.networkObjects[R].component.networkId);var x=s.Z.instance.networkObjects[R].component.entity;(0,o.Sx)(x),console.warn("Entity is removed, but character imight not be"),delete s.Z.instance.networkObjects[R]}null===(t=e.inputs)||void 0===t||t.forEach((function(e){if(null!=s.Z.instance.localAvatarNetworkId&&s.Z.instance.localAvatarNetworkId!=e.networkId&&void 0!==s.Z.instance.networkObjects[e.networkId]&&"server"!==s.Z.instance.networkObjects[e.networkId].ownerId){var t=s.Z.instance.networkObjects[e.networkId].component;(0,o.Ei)(t.entity,d.rl).viewVector.set(e.viewVector.x,e.viewVector.y,e.viewVector.z)}}))}},41912:function(e,t,n){"use strict";n.d(t,{T:function(){return g}});var r=n(49182),i=n(13987),o=n(29569),a=n(89306),s=n(34452),u=n(88203),c=n(86463),l=n(17356),d=n(7331),f=n(93228),h=n(61467),p=n(77301),m=n(64922),v=n(33221);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.Z)(e);if(t){var i=(0,a.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,o.Z)(this,n)}}var g=function(e){(0,i.Z)(n,e);var t=y(n);function n(e){var i;(0,r.Z)(this,n),(i=t.call(this,e)).updateType=l.V.Fixed,i.execute=function(e){for(var t=h.Z.instance.incomingMessageQueue;t.getBufferLength()>0;){var r=t.pop(),i=m.C.fromBuffer(r);i||console.warn("Couldn't deserialize buffer, probably still reading the wrong one"),s.NL.instance.dispatchEvent({type:n.EVENTS.RECEIVE_DATA,unbufferedState:i,delta:e})}};var o=e.schema,a=e.app;return h.Z.instance.schema=o,h.Z.instance.transport=new o.transport(a),void 0===v.env.SERVER_MODE||"realtime"!==v.env.SERVER_MODE&&"local"!==v.env.SERVER_MODE||(h.Z.instance.transport.initialize(),h.Z.instance.isInitialized=!0),i}return n}(u.x);g.EVENTS={CONNECT:"CLIENT_NETWORK_SYSTEM_CONNECT",INITIALIZE:"CLIENT_NETWORK_SYSTEM_INITIALIZE",SEND_DATA:"CLIENT_NETWORK_SYSTEM_SEND_DATA",RECEIVE_DATA:"CLIENT_NETWORK_SYSTEM_RECEIVE_DATA"},g.queries={clientNetworkInputReceivers:{components:[p.H,d.I,(0,c.yo)(f.$)]}}},83052:function(e,t,n){"use strict";var r=n(48533),i=n.n(r),o=n(58700),a=n(49182),s=n(39337),u=n(94780),c=n(13987),l=n(29569),d=n(89306),f=n(88203),h=n(84711);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}(function(e){(0,c.Z)(n,e);var t=p(n);function n(){var e;return(0,a.Z)(this,n),(e=t.call(this)).videoPaused=!1,e.audioPaused=!1,e.faceTracking=!1,e.mediaStream=null,e.audioGainNode=null,e.localScreen=null,e.camVideoProducer=null,e.camAudioProducer=null,e.screenVideoProducer=null,e.screenAudioProducer=null,e.producers=[],e.consumers=[],e.screenShareVideoPaused=!1,e.screenShareAudioPaused=!1,e.initialized=!1,e.execute=null,n.instance=(0,u.Z)(e),e}return(0,s.Z)(n,[{key:"setFaceTracking",value:function(e){return this.faceTracking=e,this.faceTracking}},{key:"setVideoPaused",value:function(e){return console.log("setVideoPaused"),this.videoPaused=e,this.videoPaused}},{key:"setAudioPaused",value:function(e){return this.audioPaused=e,this.audioPaused}},{key:"setScreenShareVideoPaused",value:function(e){return this.screenShareVideoPaused=e,this.screenShareVideoPaused}},{key:"setScreenShareAudioPaused",value:function(e){return this.screenShareAudioPaused=e,this.screenShareAudioPaused}},{key:"toggleVideoPaused",value:function(){return console.log("toggleVideoPaused"),console.log(this.videoPaused),this.videoPaused=!this.videoPaused,this.videoPaused}},{key:"toggleAudioPaused",value:function(){return this.audioPaused=!this.audioPaused,this.audioPaused}},{key:"toggleScreenShareVideoPaused",value:function(){return this.screenShareVideoPaused=!this.screenShareVideoPaused,this.screenShareVideoPaused}},{key:"toggleScreenShareAudioPaused",value:function(){return this.screenShareAudioPaused=!this.screenShareAudioPaused,this.screenShareAudioPaused}},{key:"startCamera",value:function(){var e=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("start camera"),!this.mediaStream){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,this.getMediaStream();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cycleCamera",value:function(){var e=(0,o.Z)(i().mark((function e(){var t,n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.camVideoProducer&&this.camVideoProducer.track){e.next=3;break}return console.log("cannot cycle camera - no current camera track"),e.abrupt("return",!1);case 3:return console.log("cycle camera"),e.next=6,this.getCurrentDeviceId();case 6:return t=e.sent,e.next=9,navigator.mediaDevices.enumerateDevices();case 9:if(n=e.sent,(r=n.filter((function(e){return"videoinput"===e.kind}))).length>1){e.next=14;break}return console.log("cannot cycle camera - only one camera"),e.abrupt("return",!1);case 14:return(o=r.findIndex((function(e){return e.deviceId===t})))===r.length-1?o=0:o+=1,console.log("getting a video stream from new device",r[o].label),e.next=19,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:r[o].deviceId}},audio:!0});case 19:return this.mediaStream=e.sent,e.next=22,this.camVideoProducer.replaceTrack({track:this.mediaStream.getVideoTracks()[0]});case 22:return e.next=24,this.camAudioProducer.replaceTrack({track:this.mediaStream.getAudioTracks()[0]});case 24:return e.abrupt("return",!0);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getScreenPausedState",value:function(){return this.screenShareVideoPaused}},{key:"getScreenAudioPausedState",value:function(){return this.screenShareAudioPaused}},{key:"getCurrentDeviceId",value:function(){var e=(0,o.Z)(i().mark((function e(){var t,n,r,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.camVideoProducer){e.next=2;break}return e.abrupt("return",null);case 2:if(t=this.camVideoProducer.track.getSettings(),!(n=t.deviceId)){e.next=5;break}return e.abrupt("return",n);case 5:if(r=this.mediaStream&&this.mediaStream.getVideoTracks()[0]){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,navigator.mediaDevices.enumerateDevices();case 10:return o=e.sent,a=o.find((function(e){return e.label.startsWith(r.label)})),e.abrupt("return",a.deviceId);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMediaStream",value:function(){var e=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Getting media stream"),console.log(h.H6),e.next=5,navigator.mediaDevices.getUserMedia(h.H6);case 5:if(this.mediaStream=e.sent,console.log(this.mediaStream),!this.mediaStream.active){e.next=11;break}return this.audioPaused=!1,this.videoPaused=!1,e.abrupt("return",!0);case 11:return this.audioPaused=!0,this.videoPaused=!0,e.abrupt("return",!1);case 16:e.prev=16,e.t0=e.catch(0),console.log("failed to get media stream"),console.log(e.t0);case 20:case"end":return e.stop()}}),e,this,[[0,16]])})));return function(){return e.apply(this,arguments)}}()}],[{key:"removeVideoAudio",value:function(e){document.querySelectorAll(e.id).forEach((function(t){t.consumer===e&&(null===t||void 0===t||t.parentNode.removeChild(t))}))}},{key:"addVideoAudio",value:function(e,t){if(e&&e.track){var n="".concat(t,"_").concat(e.kind),r=document.getElementById(n);if("video"===e.kind){null===r&&((r=document.createElement("video")).id="".concat(t,"_").concat(e.kind),r.autoplay=!0,document.body.appendChild(r),r.setAttribute("playsinline","true")),r.srcObject=new MediaStream([e.track.clone()]),r.mediaStream=e;try{r.play().then((function(){return console.log("Playing video")})).catch((function(e){console.log("Play video error: ".concat(e)),console.error(e)}))}catch(i){console.log("video play error"),console.log(i)}}else null===r&&((r=document.createElement("audio")).id="".concat(t,"_").concat(e.kind),document.body.appendChild(r),r.setAttribute("playsinline","true"),r.setAttribute("autoplay","true")),r.srcObject=new MediaStream([e.track.clone()]),r.mediaStream=e,r.volume=0,r.play().catch((function(e){console.log("Play audio error: ".concat(e)),console.error(e)}))}}}]),n}(f.x)).instance=null},64838:function(e,t,n){"use strict";n.d(t,{V:function(){return f}});var r=n(15194),i=n(49182),o=n(13987),a=n(29569),s=n(89306),u=n(52288);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.Z)(e);if(t){var i=(0,s.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var f=function(e){(0,o.Z)(n,e);var t=d(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return n}(n(65648).w);f._schema=l(l({},f._schema),{},{particleEmitterMesh:{type:u.Yk.Ref,default:null}})},41340:function(e,t,n){"use strict";n.d(t,{P:function(){return m}});var r=n(49182),i=n(39337),o=n(42828),a=n(13987),s=n(29569),u=n(89306),c=n(36595),l=n(25730),d=n(25802),f=n(56633),h=n(10651);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}var m=function(e){(0,a.Z)(n,e);var t=p(n);function n(e,i){var o;(0,r.Z)(this,n);var a=new c.BKK(1,1,1,1),s=new c.L5s;s.index=a.index,s.attributes=a.attributes;var u=new c.jyz({uniforms:c.rDY.merge([{map:{value:e},emitterMatrix:{value:new c.yGw}},c.rBU.fog]),vertexShader:h.C7,fragmentShader:h.zH,transparent:!0,depthWrite:!1,fog:!0,blendEquation:c.bGH,side:c.ehD});if(u.uniforms.map.value=e,u.uniforms.emitterMatrix.value=new c.yGw,(o=t.call(this,s,u)).frustumCulled=!1,o.initialPositions=[],o.lifetimes=[],o.particleSizeRandomness=[],o.initialAges=[],o.ages=[],o.colors=[],o.inverseWorldScale=new c.Pa4,o.worldScale=new c.Pa4,i)for(var l=0,d=Object.keys(i);l<d.length;l++){var f=d[l];o[f]=i[f]}else o.startSize=.25,o.endSize=.25,o.sizeRandomness=0,o.startVelocity=new c.Pa4(0,0,.5),o.endVelocity=new c.Pa4(0,0,.5),o.angularVelocity=0,o.particleCount=100,o.lifetime=5,o.lifetimeRandomness=5,o.ageRandomness=10,o.endColor=new c.Ilk,o.middleColor=new c.Ilk,o.startColor=new c.Ilk,o.startOpacity=1,o.middleOpacity=1,o.endOpacity=1,o.colorCurve="linear",o.velocityCurve="linear",o.sizeCurve="linear";return o.updateParticles(),o}return(0,i.Z)(n,[{key:"updateParticles",value:function(){this.material.uniforms.map.value;var e=new c.BKK(1,1,1,1),t=new c.L5s;t.index=e.index,t.attributes=e.attributes;var n=[],r=[],i=[],o=[],a=[],s=[],u=[],l=[];this.getWorldScale(this.worldScale);for(var d=0;d<this.particleCount;d++)a[d]=Math.random()*this.ageRandomness-this.ageRandomness,i[d]=this.lifetime+2*Math.random()*this.lifetimeRandomness,o[d]=a[d],s[3*d]=2*Math.random()-1,s[3*d+1]=2*Math.random()-1,s[3*d+2]=0,u[d]=Math.random()*this.sizeRandomness,n.push(s[3*d]*this.worldScale.x),n.push(s[3*d+1]*this.worldScale.y),n.push(s[3*d+2]),n.push(this.startSize+u[d]),l.push(0),r.push(this.startColor.r,this.startColor.g,this.startColor.b,0);t.setAttribute("particlePosition",new c.lb7(new Float32Array(n),4).setUsage(c.dj0)),t.setAttribute("particleColor",new c.lb7(new Float32Array(r),4).setUsage(c.dj0)),t.setAttribute("particleAngle",new c.lb7(new Float32Array(l),1).setUsage(c.dj0)),this.geometry=t,this.initialPositions=s,this.particleSizeRandomness=u,this.ages=o,this.initialAges=a,this.lifetimes=i,this.colors=r}},{key:"update",value:function(e){var t=this.geometry,n=t.attributes.particlePosition.array,r=t.attributes.particleColor.array,i=t.attributes.particleAngle.array;this.getWorldScale(this.worldScale),this.inverseWorldScale.set(1/this.worldScale.x,1/this.worldScale.y,1/this.worldScale.z);var o=this.material.uniforms.emitterMatrix.value;o.copy(this.matrixWorld),o.scale(this.inverseWorldScale);for(var a=0;a<this.particleCount;a++){var s=this.ages[a],u=this.ages[a]+=e;if(!(u<0))if(u>0&&s<=0)r[4*a+3]=this.startOpacity,n[4*a]=this.initialPositions[3*a]*this.worldScale.x,n[4*a+1]=this.initialPositions[3*a+1]*this.worldScale.y,n[4*a+2]=0,n[4*a+3]=this.startSize+this.particleSizeRandomness[a],r[4*a]=this.startColor.r,r[4*a+1]=this.startColor.g,r[4*a+2]=this.startColor.b;else if(u>this.lifetimes[a])this.ages[a]=this.initialAges[a],r[4*a+3]=0;else{var c=(0,f.uZ)(this.ages[a]/this.lifetimes[a],0,1),d=l;d[this.velocityCurve]||(console.warn("Unknown velocity curve type ".concat(this.velocityCurve," in particle emitter. Falling back to linear.")),this.velocityCurve="linear"),d[this.sizeCurve]||(console.warn("Unknown size curve type ".concat(this.sizeCurve," in particle emitter. Falling back to linear.")),this.sizeCurve="linear"),d[this.colorCurve]||(console.warn("Unknown color curve type ".concat(this.colorCurve," in particle emitter. Falling back to linear.")),this.colorCurve="linear");var p=d[this.velocityCurve](c),m=d[this.sizeCurve](c),v=d[this.colorCurve](c);if(n[4*a]+=(0,f.t7)(this.startVelocity.x,this.endVelocity.x,p)*e,n[4*a+1]+=(0,f.t7)(this.startVelocity.y,this.endVelocity.y,p)*e,n[4*a+2]+=(0,f.t7)(this.startVelocity.z,this.endVelocity.z,p)*e,n[4*a+3]=(0,f.t7)(this.startSize+this.particleSizeRandomness[a],this.endSize+this.particleSizeRandomness[a],m),i[a]+=this.angularVelocity*h.qW*e,v<=.5){var y=v/.5;r[4*a]=(0,f.t7)(this.startColor.r,this.middleColor.r,y),r[4*a+1]=(0,f.t7)(this.startColor.g,this.middleColor.g,y),r[4*a+2]=(0,f.t7)(this.startColor.b,this.middleColor.b,y),r[4*a+3]=(0,f.t7)(this.startOpacity,this.middleOpacity,y)}else if(v>.5){var g=(v-.5)/.5;r[4*a]=(0,f.t7)(this.middleColor.r,this.endColor.r,g),r[4*a+1]=(0,f.t7)(this.middleColor.g,this.endColor.g,g),r[4*a+2]=(0,f.t7)(this.middleColor.b,this.endColor.b,g),r[4*a+3]=(0,f.t7)(this.middleOpacity,this.endOpacity,g)}}}t.attributes.particlePosition.needsUpdate=!0,t.attributes.particleColor.needsUpdate=!0,t.attributes.particleAngle.needsUpdate=!0}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,o.Z)((0,u.Z)(n.prototype),"copy",this).call(this,e,t);var r=this.material,i=e.material;return r.uniforms.map.value=i.uniforms.map.value,this.startColor.copy(e.startColor),this.middleColor.copy(e.middleColor),this.endColor.copy(e.endColor),this.startOpacity=e.startOpacity,this.middleOpacity=e.middleOpacity,this.endOpacity=e.endOpacity,this.colorCurve=e.colorCurve,this.sizeCurve=e.sizeCurve,this.startSize=e.startSize,this.endSize=e.endSize,this.sizeRandomness=e.sizeRandomness,this.ageRandomness=e.ageRandomness,this.lifetime=e.lifetime,this.lifetimeRandomness=e.lifetimeRandomness,this.particleCount=e.particleCount,this.startVelocity.copy(e.startVelocity),this.endVelocity.copy(e.endVelocity),this.velocityCurve=e.velocityCurve,this.angularVelocity=e.angularVelocity,this}}],[{key:"fromArgs",value:function(e){return e.startColor=new c.Ilk(e.startColor),e.middleColor=new c.Ilk(e.middleColor),e.endColor=new c.Ilk(e.endColor),e.startVelocity=new c.Pa4(e.startVelocity.x,e.startVelocity.y,e.startVelocity.z),e.endVelocity=new c.Pa4(e.endVelocity.x,e.endVelocity.y,e.endVelocity.z),new Promise((function(t){(0,d.Z)(e.src).then((function(r){r.flipY=!1,t(new n(r,e))}))}))}}]),n}(c.Kj0)},10651:function(e,t,n){"use strict";n.d(t,{qW:function(){return c},C7:function(){return l},zH:function(){return d},Et:function(){return f},Ne:function(){return h}});var r=n(64838),i=n(16090),o=n(82552),a=n(47396),s=n(41340),u=n(483),c=.0174533,l="\n  #include <common>\n  attribute vec4 particlePosition;\n  attribute vec4 particleColor;\n  attribute float particleAngle;\n  varying vec4 vColor;\n  varying vec2 vUV;\n  uniform mat4 emitterMatrix;\n  #include <fog_pars_vertex>\n  void main() {\n    vUV = uv;\n    vColor = particleColor;\n    float particleScale = particlePosition.w;\n    vec4 mvPosition = viewMatrix * emitterMatrix * vec4(particlePosition.xyz, 1.0);\n    \n    vec3 rotatedPosition = position;\n    rotatedPosition.x = cos( particleAngle ) * position.x - sin( particleAngle ) * position.y;\n    rotatedPosition.y = sin( particleAngle ) * position.x + cos( particleAngle ) * position.y;\n    mvPosition.xyz += rotatedPosition * particleScale;\n    gl_Position = projectionMatrix * mvPosition;\n    #include <fog_vertex>\n  }\n",d="\n  #include <common>\n  #include <fog_pars_fragment>\n  uniform sampler2D map;\n  varying vec2 vUV;\n  varying vec4 vColor;\n  void main() {\n    gl_FragColor = texture2D(map,  vUV) * vColor;\n    #include <fog_fragment>\n  }\n",f=function(e,t){a.C&&s.P.fromArgs(t.objArgs).then((function(t){(0,i.Tk)(e,r.V,{particleEmitterMesh:t}),u.D4.scene.add(t)}))},h=function(e,t){if(a.C){var n=t.particleEmitterMesh;if(n){var r=(0,i.Xr)(e,o.U);n.position.set(r.position.x,r.position.y,r.position.z),n.quaternion.set(r.rotation.x,r.rotation.y,r.rotation.z,r.rotation.w),n.scale.set(r.scale.x,r.scale.y,r.scale.z),n.updateMatrix()}}}},31345:function(e,t,n){"use strict";n.d(t,{ZP:function(){return g}});var r=n(48533),i=n.n(r),o=n(58700),a=n(49182),s=n(39337),u=n(94780),c=n(42828),l=n(13987),d=n(29569),f=n(89306),h=n(36595),p=n(483),m=n(71362);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var y={Stereo:"stereo",PannerNode:"pannernode"},g=(Object.values(y).map((function(e){return{label:e,value:e}})),Object.values({Linear:"linear",Inverse:"inverse",Exponential:"exponential"}).map((function(e){return{label:e,value:e}})),function(e){(0,l.Z)(n,e);var t=v(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"audio";(0,a.Z)(this,n),r=t.call(this);var o=p.D4.createElement(i,{crossorigin:"anonymous",loop:!0,playsinline:"","webkit-playsinline":""});return r.el=o,r._src="",r.audioListener=e,r.controls=!0,r.audioType=y.PannerNode,r.volume=.5,console.log("audiosource create",(0,u.Z)(r)),r}return(0,s.Z)(n,[{key:"loadMedia",value:function(e){var t=this;return new Promise((function(n,r){t.el.src=e;var i=null,o=function(){i(),n()},a=function(e){i(),r(new m.mQ('Error loading video "'.concat(t.el.src,'"'),e))};i=function(){t.el.removeEventListener("loadeddata",o),t.el.removeEventListener("error",a)},t.el.addEventListener("loadeddata",o),t.el.addEventListener("error",a)}))}},{key:"load",value:function(){var e=(0,o.Z)(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadMedia(t);case 2:if(p.D4.useAudioSystem){e.next=4;break}return e.abrupt("return",this);case 4:return this.audioSource=this.audioListener.context.createMediaElementSource(this.el),this.audio.setNodeSource(this.audioSource),e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((0,c.Z)((0,f.Z)(n.prototype),"copy",this).call(this,e,!1),t)for(var r=0;r<e.children.length;r++){var i=e.children[r];i!==e.audio&&this.add(i.clone())}return this.controls=e.controls,this.autoPlay=e.autoPlay,this.loop=e.loop,this.audioType=e.audioType,this.volume=e.volume,this.distanceModel=e.distanceModel,this.rolloffFactor=e.rolloffFactor,this.refDistance=e.refDistance,this.maxDistance=e.maxDistance,this.coneInnerAngle=e.coneInnerAngle,this.coneOuterAngle=e.coneOuterAngle,this.coneOuterGain=e.coneOuterGain,this.src=e.src,this}},{key:"play",value:function(){this.el.play()}},{key:"pause",value:function(){this.el.pause()}},{key:"duration",get:function(){return this.el.duration}},{key:"src",get:function(){return this.el.src},set:function(e){this.load(e).catch(console.error)}},{key:"autoPlay",get:function(){return this.el.autoplay},set:function(e){this.el.autoplay=e}},{key:"loop",get:function(){return this.el.loop},set:function(e){this.el.loop=e}},{key:"audioType",get:function(){return this._audioType},set:function(e){if(e!==this._audioType&&p.D4.useAudioSystem){var t,n=this.audio;t=e===y.PannerNode?new p.VY(this.audioListener):new p.Bb(this.audioListener),n&&(t.gain.gain.value=n.getVolume(),this.audioSource&&n.disconnect(),this.remove(n)),this.audioSource&&t.setNodeSource(this.audioSource),this.audio=t,this.add(t),this._audioType=e}}},{key:"volume",get:function(){return p.D4.useAudioSystem?this.audio.getVolume():1},set:function(e){p.D4.useAudioSystem&&(this.audio.gain.gain.value=e)}},{key:"distanceModel",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.getDistanceModel():null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&this.audio.setDistanceModel(e)}},{key:"rolloffFactor",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.getRolloffFactor():null},set:function(e){p.D4.useAudioSystem&&(this.audioType!==y.PannerNode||this.audio.setRolloffFactor(e))}},{key:"refDistance",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.getRefDistance():null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&this.audio.setRefDistance(e)}},{key:"maxDistance",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.getMaxDistance():null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&this.audio.setMaxDistance(e)}},{key:"coneInnerAngle",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.panner.coneInnerAngle:null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&(this.audio.panner.coneInnerAngle=e)}},{key:"coneOuterAngle",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.panner.coneOuterAngle:null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&(this.audio.panner.coneOuterAngle=e)}},{key:"coneOuterGain",get:function(){if(p.D4.useAudioSystem)return this.audioType===y.PannerNode?this.audio.panner.coneOuterGain:null},set:function(e){p.D4.useAudioSystem&&this.audioType===y.PannerNode&&(this.audio.panner.coneOuterGain=e)}}]),n}(h.Tme))},99887:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(48533),i=n.n(r),o=n(58700),a=n(49182),s=n(39337),u=n(42828),c=n(13987),l=n(29569),d=n(89306),f=n(36595),h=n(71362),p=n(77977),m=n.n(p),v=n(46597),y=n(31345),g=n(483);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.Z)(this,n)}}var w="flat",_=function(e){(0,c.Z)(n,e);var t=E(n);function n(e){var r;(0,a.Z)(this,n),(r=t.call(this,e,"video"))._videoTexture=new g.fO(r.el),r._videoTexture.minFilter=f.wem,r._videoTexture.encoding=f.knz,r._texture=r._videoTexture;var i=new f.BKK,o=new f.vBJ;return o.map=r._texture,o.side=f.ehD,r._mesh=new f.Kj0(i,o),r._mesh.name="VideoMesh",r.add(r._mesh),r._projection="flat",r.hls=null,r}return(0,s.Z)(n,[{key:"loadVideo",value:function(e,t){var n=this;return new Promise((function(r,i){var o=(0,v.Z)(e,t);o?(n.hls||(n.hls=new(m())),n.hls.loadSource(e),n.hls.attachMedia(n.el),n.hls.on(m().Events.MANIFEST_PARSED,(function(){n.hls.startLoad(-1)}))):n.el.src=e;var a=null,s=function(){a(),a(),r(n._videoTexture)},u=function(e){a(),i(new h.mQ('Error loading video "'.concat(n.el.src,'"'),e))};a=function(){n.el.removeEventListener("loadeddata",s),n.el.removeEventListener("error",u)},o&&n.hls.on(m().Events.ERROR,u),n.el.addEventListener("loadeddata",s),n.el.addEventListener("error",u)}))}},{key:"load",value:function(){var e=(0,o.Z)(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._mesh.visible=!1,e.next=3,this.loadVideo(t,n);case 3:return this._texture=e.sent,this.onResize(),g.D4.useAudioSystem&&(this.audioSource=this.audioListener.context.createMediaElementSource(this.el),this.audio.setNodeSource(this.audioSource)),this._texture.format===f.wk1&&(this._mesh.material.transparent=!0),this._mesh.material.map=this._texture,this._mesh.material.needsUpdate=!0,this._mesh.visible=!0,e.abrupt("return",this);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onResize",value:function(){if(this.projection===w){var e=(this.el.videoHeight||1)/(this.el.videoWidth||1),t=Math.min(1,1/e),n=Math.min(1,e);this._mesh.scale.set(t,n,1)}}},{key:"clone",value:function(e){return new this.constructor(this.audioListener).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((0,u.Z)((0,d.Z)(n.prototype),"copy",this).call(this,e,!1),t)for(var r=0;r<e.children.length;r++){var i=e.children[r];i!==e.audio&&i!==e._mesh&&this.add(i.clone())}return this.projection=e.projection,this}},{key:"projection",get:function(){return this._projection},set:function(e){if(e!==this._projection){var t,n=new f.vBJ;"360-equirectangular"===e?(t=new f.Aip(1,64,32)).scale(-1,1,1):(t=new f.BKK,n.side=f.ehD),n.map=this._texture,this._projection=e;var r=new f.Kj0(t,n);r.name="VideoMesh";var i=this.children.indexOf(this._mesh);-1===i?this.add(r):(this.children.splice(i,1,r),r.parent=this),this._mesh=r,this.onResize()}}},{key:"src",get:function(){return this.el.src},set:function(e){this.load(e).catch(console.error)}}]),n}(y.ZP)},65622:function(e,t,n){"use strict";n.d(t,{e:function(){return c}});var r=n(88334),i=n(47396),o=n(34452),a=n(16090),s=n(17209),u=n(39614);function c(e){var t=[],n=0;i.C&&o.NL.instance.dispatchEvent({type:o.NL.EVENTS.ENTITY_LOADED,left:t.length}),Object.keys(e.entities).forEach((function(c){var l=e.entities[c],d=(0,a.JP)();(0,a.Tk)(d,s.j0),l.components.forEach((function(e){if(function(e,t){var n,r,i=t.name.replace(/-\d+/,"").replace(" ","");if(void 0===u.Xn[i])return console.warn("Couldn't load ",i);var o=u.Xn[i];null===(n=o.behaviors)||void 0===n||n.forEach((function(n){var r,i,o={};null===(r=n.values)||void 0===r||r.forEach((function(e){void 0!==e.from?o[e.to]=t.data[e.from]:o[e]=t.data[e]})),n.onLoaded&&(o.onLoaded=n.onLoaded),n.behavior(e,Object.assign(Object.assign({},n.args),{objArgs:Object.assign(Object.assign({},null===(i=n.args)||void 0===i?void 0:i.objArgs),o)}))})),null===(r=o.components)||void 0===r||r.forEach((function(n){var r=n.values?n.values.map((function(e){return t.data[e]})):{};(0,a.Tk)(e,n.type,r)}))}(d,e),i.C&&"gltf-model"===e.name){var s=(0,a.Ei)(d,r.g);s.entityIdFromScenaLoader=l,t.push(new Promise((function(e,r){null===s.onLoaded||s.onLoaded,s.onLoaded.push((function(){n++,e(),o.NL.instance.dispatchEvent({type:o.NL.EVENTS.ENTITY_LOADED,left:t.length-n})}))})))}else if(!i.C&&"gltf-model"===e.name){(0,a.Ei)(d,r.g).entityIdFromScenaLoader=l}}))})),i.C&&Promise.all(t).then((function(){o.NL.instance.dispatchEvent({type:o.NL.EVENTS.SCENE_LOADED,loaded:!0})}))}},95812:function(e,t,n){"use strict";n.d(t,{W:function(){return p},CT:function(){return m},rl:function(){return v}});var r=n(49182),i=n(39337),o=n(42828),a=n(13987),s=n(29569),u=n(89306),c=n(52288),l=n(65648),d=n(36595),f=n(47509);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}var p=1.2,m=2.4,v=function(e){(0,a.Z)(n,e);var t=h(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).initialized=!1,e.currentAnimationAction=[],e.currentAnimationLength=0,e.timer=0,e.animationsTimeScale=.5,e.height=0,e.materials=[],e.visible=!0,e.animations=[],e.physicsEnabled=!0,e.localMovementDirection=new d.Pa4,e.acceleration=new d.Pa4,e.velocity=new d.Pa4,e.arcadeVelocityInfluence=new d.Pa4,e.velocityTarget=new d.Pa4,e.currentInputHash="",e.defaultVelocitySimulatorDamping=.8,e.defaultVelocitySimulatorMass=50,e.moveSpeed=m,e.otherPlayerMaxSpeedCount=0,e.angularVelocity=0,e.orientation=new d.Pa4(0,0,1),e.orientationTarget=new d.Pa4(0,0,1),e.defaultRotationSimulatorDamping=.5,e.defaultRotationSimulatorMass=10,e.changedViewAngle=0,e.actorMass=1,e.actorHeight=1,e.capsuleRadius=.25,e.capsuleSegments=8,e.capsuleFriction=0,e.capsulePosition=new f.AO,e.rayResult=new f.Fv,e.rayDontStuckX=new f.Fv,e.rayDontStuckZ=new f.Fv,e.rayDontStuckXm=new f.Fv,e.rayDontStuckZm=new f.Fv,e.rayHasHit=!1,e.rayGroundHit=!1,e.rayGroundY=null,e.rayCastLength=.85,e.raySafeOffset=.03,e.wantsToJump=!1,e.initJumpSpeed=-1,e.playerStuck=0,e.playerInPortal=0,e.animationVelocity=new d.Pa4,e.groundImpactVelocity=new d.Pa4,e}return(0,i.Z)(n,[{key:"dispose",value:function(){(0,o.Z)((0,u.Z)(n.prototype),"dispose",this).call(this),this.modelContainer.parent.remove(this.modelContainer),this.tiltContainer=null}}]),n}(l.w);v._schema={tiltContainer:{type:c.Yk.Ref,default:null}}},5297:function(e,t,n){"use strict";n.d(t,{Of:function(){return G},NK:function(){return Y}});var r=n(63290),i=n(48533),o=n.n(i),a=n(77866),s=n(58700),u=n(49182),c=n(39337),l=n(97762),d=n(47396),f=n(67200),h=n(47509),p=n(36595),m=n(88334),v=n(60773),y=n(38936),g=n(95070),E=n(74203),w=n(16090),_=n(7331),T=n(93228),k=n(913),b=n(31110),S=n(43396),D=n(62589),A=n(30307),C=n(73505),O=n(94223),P=n(41091),R=n(53516),x=n(99010),N=n(55881),Z=n(82552),L=n(9819),I=n(97680),M=n(17751),V=n(58365),F=n(77020),j=n(32053),U=n(81537),q=n(5969),Q=n(61306),B=n(95812),z=n(40654),W=n(60645),H=function(){function e(){(0,u.Z)(this,e),this.initialized=!1,this._animations=[],this.getAnimations()}return(0,c.Z)(e,[{key:"getAnimations",value:function(){var e=this;return new Promise((function(t){d.C?(0,W.nZ)().load("/models/avatars/Animation.glb",(function(n){var r;e._animations=n.animations,null===(r=e._animations)||void 0===r||r.forEach((function(e){e.tracks=e.tracks.filter((function(e){return!e.name.match(/^CC_Base_/)}))})),t(e._animations)})):t([])}))}}]),e}();H.instance=new H;var G=function(e){var t,n,r=null===(t=(0,w.Xr)(e,B.rl))||void 0===t?void 0:t.avatarId,i=null===(n=j.jB.find((function(e){return e.id===r})))||void 0===n?void 0:n.src;(0,w.tu)(e,m.g)&&(0,w.aT)(e,m.g,!0),(0,w.tu)(e,v.e)&&(0,w.aT)(e,v.e,!0);var u=new p.ZAu;(0,w.Tk)(e,m.g,{url:i,receiveShadow:!0,castShadow:!0,parent:u}),(0,P.Q)(e,{objArgs:{castShadow:!0,receiveShadow:!0}}),(0,w.Xr)(e,m.g).onLoaded.push(function(){var e=(0,s.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Actor Avatar loaded"),(r=(0,w.Ei)(t,B.rl)).mixer&&r.mixer.stopAllAction(),r.currentAnimationAction=[],(0,a.Z)(r.modelContainer.children).forEach((function(e){return r.modelContainer.remove(e)})),u.children.forEach((function(e){return r.modelContainer.add(e)})),r.mixer=new p.Xcj(r.modelContainer.children[0]),J(t,n.asset.children[0]),(0,w.Xr)(t,N.Z).data.forEach((function(e){return e.lifecycleState=l.q.STARTED}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())};function J(e,t){var n=(0,w.Ei)(e,B.rl),r={fingers:!0,hair:!0,visemes:!0};n.model=function(){var e=t;if(e&&!e.isMesh&&(e=e.scene),!e){var n=new p.xsS,r=new p.TUv;r.skeleton=null,r.bind=function(e){this.skeleton=e},r.bind((0,I.MX)(L.Z)),n.add(r),console.log(r);var i=(0,I.fU)(r.skeleton),o=(0,I.hN)(i);n.add(o),e=n}return e}(),n.options=r,n.model.updateMatrixWorld(!0);var i=[];n.model.traverse((function(e){e.isSkinnedMesh&&i.push(e)})),i.sort((function(e,t){return t.skeleton.bones.length-e.skeleton.bones.length})),n.skinnedMeshes=i;var a=i.find((function(e){return e.skeleton.bones[0].parent}))||null,u=a&&a.skeleton,c=u?i.find((function(e){return e.skeleton!==u&&e.skeleton.bones.length>=u.bones.length})):null,l=c&&c.skeleton;l&&((0,I.Fp)(l,u),c.bind(u)),n.tailBones=(0,I.Eq)(u),n.skeleton=u,n.Eye_L=(0,I.Dm)(n.tailBones,!0),n.Eye_R=(0,I.Dm)(n.tailBones,!1),n.Head=(0,I.GN)(n.tailBones),n.Neck=n.Head.parent,n.Chest=n.Neck.parent,n.Hips=(0,I.fU)(u),n.Spine=(0,I.vt)(n.Chest,n.Hips),n.Left_shoulder=(0,I.s_)(n.tailBones,!0),n.Left_wrist=(0,I.ll)(n.Left_shoulder),n.Left_elbow=n.Left_wrist.parent,n.Left_arm=n.Left_elbow.parent,n.Right_shoulder=(0,I.s_)(n.tailBones,!1),n.Right_wrist=(0,I.ll)(n.Right_shoulder),n.Right_elbow=n.Right_wrist.parent,n.Right_arm=n.Right_elbow.parent,n.modelBones={Spine:n.Spine,Chest:n.Chest,Neck:n.Neck,Head:n.Head,Left_shoulder:n.Left_shoulder,Left_arm:n.Left_arm,Left_elbow:n.Left_elbow,Left_wrist:n.Left_wrist,Right_shoulder:n.Right_shoulder,Right_arm:n.Right_arm,Right_elbow:n.Right_elbow,Right_wrist:n.Right_wrist},n.armature=(0,I.hN)(n.Hips);var d=n.Left_wrist.getWorldPosition(new p.Pa4).sub(n.Head.getWorldPosition(new p.Pa4)).x<0,f=new p.Pa4(0,1,0).applyQuaternion(n.armature.quaternion).z<-.5,h=n.armature.quaternion.clone(),m=(new p.yGw).getInverse(n.armature.matrixWorld);n.armature.position.set(0,0,0),n.armature.quaternion.set(0,0,0,1),n.armature.scale.set(1,1,1),n.armature.updateMatrix(),n.Head.traverse((function(e){e.savedPosition=e.position.clone(),e.savedMatrixWorld=e.matrixWorld.clone()}));var v=[];!function e(t){for(var n=0;n<t.length;n++){var r=t[n];/hair/i.test(r.name)&&v.push(r),e(r.children)}}(u.bones);var y=n.tailBones.filter((function(e){return/hair/i.test(e.name)})).map((function(e){for(;e;e=e.parent)if(e.parent===n.Head)return e;return null})).filter((function(e){return e}));n.allHairBones=v,n.hairBones=y,r.hair&&new Promise((function(e,r){t||(t={}),t.parser||(t.parser={json:{extensions:{}}}),t.parser.json.extensions||(t.parser.json.extensions={}),t.parser.json.extensions.VRM||(t.parser.json.extensions.VRM={secondaryAnimation:{boneGroups:n.hairBones.map((function(e){var t=[];return function e(r){t.push(n.allHairBones.indexOf(r)),r.children.length>0&&e(r.children[0])}(e),{comment:e.name,stiffiness:.5,gravityPower:.2,gravityDir:{x:0,y:-1,z:0},dragForce:.3,center:-1,hitRadius:.02,bones:t,colliderGroups:[]}}))}},t.parser.getDependency=function(){var e=(0,s.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("node"!==t){e.next=4;break}return e.abrupt("return",n.allHairBones[r]);case 4:throw new Error("unsupported type");case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}));var g=function(e,t){var r=n.tailBones.filter((function(t){return e.test(t.name)&&(0,I.oM)(t,(function(e){return e===n.modelBones.Left_wrist||e===n.modelBones.Right_wrist}))})).sort((function(n,r){var i=n.name.replace(e,""),o=(0,I.jh)(i,/l/i)-(0,I.jh)(i,/r/i),a=r.name.replace(e,""),s=(0,I.jh)(a,/l/i)-(0,I.jh)(a,/r/i);return t?s-o:o-s}));return r.length>0?(0,I.tV)(r[0],(function(t){return e.test(t.name)})):null},E={left:{thumb:g(/thumb/gi,!0),index:g(/index/gi,!0),middle:g(/middle/gi,!0),ring:g(/ring/gi,!0),little:g(/little/gi,!0)||g(/pinky/gi,!0)},right:{thumb:g(/thumb/gi,!1),index:g(/index/gi,!1),middle:g(/middle/gi,!1),ring:g(/ring/gi,!1),little:g(/little/gi,!1)||g(/pinky/gi,!1)}};n.fingerBones=E;var _={},T=function(e){var t=n.modelBones[e].name;return _[t]||(_[t]=new p._fP),_[t]};f&&n.Hips.forEach((function(e){T(e).premultiply((new p._fP).setFromAxisAngle(new p.Pa4(1,0,0),-Math.PI/2))})),d&&n.Hips.forEach((function(e){T(e).premultiply((new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),Math.PI))}));var k=d?n.Left_arm:n.Right_arm,b=d?n.Left_elbow:n.Right_elbow,S=d?n.Left_wrist:n.Right_wrist,D=(new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),-Math.PI/2).premultiply((new p._fP).setFromRotationMatrix((new p.yGw).lookAt(new p.Pa4(0,0,0),b.getWorldPosition(new p.Pa4).applyMatrix4(m).sub(k.getWorldPosition(new p.Pa4).applyMatrix4(m)).applyQuaternion(h),new p.Pa4(0,1,0)))),A=(new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),-Math.PI/2).premultiply((new p._fP).setFromRotationMatrix((new p.yGw).lookAt(new p.Pa4(0,0,0),S.getWorldPosition(new p.Pa4).applyMatrix4(m).sub(b.getWorldPosition(new p.Pa4).applyMatrix4(m)).applyQuaternion(h),new p.Pa4(0,1,0)))),C=d?n.Right_arm:n.Left_arm,O=d?n.Right_elbow:n.Left_elbow,P=d?n.Right_wrist:n.Left_wrist,R=(new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),Math.PI/2).premultiply((new p._fP).setFromRotationMatrix((new p.yGw).lookAt(new p.Pa4(0,0,0),O.getWorldPosition(new p.Pa4).applyMatrix4(m).sub(C.getWorldPosition(new p.Pa4).applyMatrix4(m)).applyQuaternion(h),new p.Pa4(0,1,0)))),x=(new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),Math.PI/2).premultiply((new p._fP).setFromRotationMatrix((new p.yGw).lookAt(new p.Pa4(0,0,0),P.getWorldPosition(new p.Pa4).applyMatrix4(m).sub(O.getWorldPosition(new p.Pa4).applyMatrix4(m)).applyQuaternion(h),new p.Pa4(0,1,0))));for(var N in T("Right_arm").multiply(D.clone().invert()),T("Right_elbow").multiply(D.clone()).premultiply(A.clone().invert()),T("Left_arm").multiply(R.clone().invert()),T("Left_elbow").multiply(R.clone()).premultiply(x.clone().invert()),_)_[N].invert();(0,F.E)(n.armature.children[0],{preRotations:_}),n.model.traverse((function(e){e.isSkinnedMesh&&e.bind(e.skeleton.bones.length===u.bones.length&&e.skeleton.bones.every((function(e,t){return e===u.bones[t]}))?u:e.skeleton)})),f&&n.modelBones.Hips.quaternion.premultiply((new p._fP).setFromAxisAngle(new p.Pa4(1,0,0),-Math.PI/2)),d&&n.modelBones.Hips.quaternion.premultiply((new p._fP).setFromAxisAngle(new p.Pa4(0,1,0),Math.PI)),n.modelBones.Right_arm.quaternion.premultiply(D.clone().invert()),n.modelBones.Right_elbow.quaternion.premultiply(D).premultiply(A.clone().invert()),n.modelBones.Left_arm.quaternion.premultiply(R.clone().invert()),n.modelBones.Left_elbow.quaternion.premultiply(R).premultiply(x.clone().invert()),n.model.updateMatrixWorld(!0),n.Hips.traverse((function(e){e.initialQuaternion=e.quaternion.clone()}));var Z=function(){if(n.Eye_L&&n.Eye_R)return n.Eye_L.getWorldPosition(new p.Pa4).add(n.Eye_R.getWorldPosition(new p.Pa4)).divideScalar(2);var e=n.Head.getWorldPosition(new p.Pa4).sub(n.Neck.getWorldPosition(new p.Pa4));return e.z<0&&(e.z*=-1),n.Head.getWorldPosition(new p.Pa4).add(e)}();n.poseManager=new M.Z,n.shoulderTransforms=new V.Z(n);var j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.parent;return e.getWorldPosition(new p.Pa4).sub(t.getWorldPosition(new p.Pa4))};!function(e,t){e.shoulderTransforms.spine.position.copy(t.spine),e.shoulderTransforms.transform.position.copy(t.chest),e.shoulderTransforms.neck.position.copy(t.neck),e.shoulderTransforms.head.position.copy(t.head),e.shoulderTransforms.eyes.position.copy(t.eyes),e.shoulderTransforms.leftShoulderAnchor.position.copy(t.leftShoulder),e.shoulderTransforms.leftArm.upperArm.position.copy(t.leftUpperArm),e.shoulderTransforms.leftArm.lowerArm.position.copy(t.leftLowerArm),e.shoulderTransforms.leftArm.hand.position.copy(t.leftHand),e.shoulderTransforms.rightShoulderAnchor.position.copy(t.rightShoulder),e.shoulderTransforms.rightArm.upperArm.position.copy(t.rightUpperArm),e.shoulderTransforms.rightArm.lowerArm.position.copy(t.rightLowerArm),e.shoulderTransforms.rightArm.hand.position.copy(t.rightHand),e.shoulderTransforms.hips.updateMatrixWorld()}(n,{spine:j(n.modelBones.Spine),chest:j(n.modelBones.Chest,n.modelBones.Spine),neck:j(n.modelBones.Neck),head:j(n.modelBones.Head),eyes:Z.clone().sub(n.Head.getWorldPosition(new p.Pa4)),leftShoulder:j(n.modelBones.Right_shoulder),leftUpperArm:j(n.modelBones.Right_arm),leftLowerArm:j(n.modelBones.Right_elbow),leftHand:j(n.modelBones.Right_wrist),rightShoulder:j(n.modelBones.Left_shoulder),rightUpperArm:j(n.modelBones.Left_arm),rightLowerArm:j(n.modelBones.Left_elbow),rightHand:j(n.modelBones.Left_wrist)}),n.shoulderWidth=n.modelBones.Left_arm.getWorldPosition(new p.Pa4).distanceTo(n.modelBones.Right_arm.getWorldPosition(new p.Pa4)),n.leftArmLength=n.shoulderTransforms.leftArm.armLength,n.rightArmLength=n.shoulderTransforms.rightArm.armLength,n.inputs={hmd:n.poseManager.vrTransforms.head,leftGamepad:n.poseManager.vrTransforms.leftHand,rightGamepad:n.poseManager.vrTransforms.rightHand},console.log("load actor status",n.inputs),n.inputs.hmd.scaleFactor=1,n.lastModelScaleFactor=1,n.outputs={eyes:n.shoulderTransforms.eyes,head:n.shoulderTransforms.head,spine:n.shoulderTransforms.spine,chest:n.shoulderTransforms.transform,neck:n.shoulderTransforms.neck,leftShoulder:n.shoulderTransforms.leftShoulderAnchor,leftUpperArm:n.shoulderTransforms.leftArm.upperArm,leftLowerArm:n.shoulderTransforms.leftArm.lowerArm,leftHand:n.shoulderTransforms.leftArm.hand,rightShoulder:n.shoulderTransforms.rightShoulderAnchor,rightUpperArm:n.shoulderTransforms.rightArm.upperArm,rightLowerArm:n.shoulderTransforms.rightArm.lowerArm,rightHand:n.shoulderTransforms.rightArm.hand},n.modelBoneOutputs={Hips:n.outputs.hips,Spine:n.outputs.spine,Chest:n.outputs.chest,Neck:n.outputs.neck,Head:n.outputs.head,Left_shoulder:n.outputs.rightShoulder,Left_arm:n.outputs.rightUpperArm,Left_elbow:n.outputs.rightLowerArm,Left_wrist:n.outputs.rightHand,Right_shoulder:n.outputs.leftShoulder,Right_arm:n.outputs.leftUpperArm,Right_elbow:n.outputs.leftLowerArm,Right_wrist:n.outputs.leftHand},n.lastTimestamp=Date.now(),n.shoulderTransforms.Start()}var Y={networkComponents:[{type:B.rl,data:{avatarId:j._h}},{type:Z.U},{type:_.I,data:{schema:U.M}},{type:N.Z,data:{schema:q.s}},{type:z.M},{type:y.t}],localClientComponents:[{type:T.$},{type:g.F,data:{distance:3,mode:E.r.ThirdPerson}},{type:k.Q},{type:A.e}],serverComponents:[{type:R.Z}],onAfterCreate:[{behavior:function(e){var t;(0,w.tu)(e,B.rl)||(console.warn("Character does not have a character component, adding"),(0,w.Tk)(e,B.rl));var n=(0,w.Ei)(e,B.rl);null===(t=n.mixer)||void 0===t||t.stopAllAction(),n.currentAnimationAction=[],void 0!==n.modelContainer&&(0,a.Z)(n.modelContainer.children).forEach((function(e){return n.modelContainer.remove(e)})),(0,w.Xr)(e,N.Z).data.forEach((function(e){return e.lifecycleState=l.q.STARTED})),n.tiltContainer=new p.ZAu,n.tiltContainer.name="Actor (tiltContainer)"+e.id,n.modelContainer=new p.ZAu,n.modelContainer.name="Actor (modelContainer)"+e.id,n.modelContainer.position.y=-n.rayCastLength,n.tiltContainer.add(n.modelContainer),(0,f.o)(e,{obj3d:n.tiltContainer}),d.C&&H.instance.getAnimations().then((function(e){n.animations=e})),n.velocitySimulator=new S.z(60,n.defaultVelocitySimulatorMass,n.defaultVelocitySimulatorDamping),n.moveVectorSmooth=new S.z(60,n.defaultVelocitySimulatorMass,n.defaultVelocitySimulatorDamping),n.vactorAnimSimulator=new S.z(60,n.defaultVelocitySimulatorMass,n.defaultVelocitySimulatorDamping),n.rotationSimulator=new b.L(60,n.defaultRotationSimulatorMass,n.defaultRotationSimulatorDamping),null==n.viewVector&&(n.viewVector=new p.Pa4);var i=(0,w.Xr)(e,Z.U);(0,w.Tk)(e,D.z,{mass:n.actorMass,position:(0,r.Z)(h.AO,(0,a.Z)(i.position.toArray())),height:n.actorHeight,radius:n.capsuleRadius,segments:n.capsuleSegments,friction:n.capsuleFriction}),n.actorCapsule=(0,w.Ei)(e,D.z),n.actorCapsule.body.shapes.forEach((function(e){e.collisionFilterMask=~C.p.TrimeshColliders})),n.actorCapsule.body.allowSleep=!1,n.actorCapsule.body.collisionFilterGroup=2,n.actorCapsule.body.fixedRotation=!0,n.actorCapsule.body.updateMassProperties();var o=new p.DvJ(.1,.1,.1),s=new p.YBo({color:16711680});n.raycastBox=new p.Kj0(o,s),O.F.physicsWorld.addBody(n.actorCapsule.body),(0,x.I)(e,{state:Q.F.DEFAULT}),n.initialized=!0},networked:!0},{behavior:G,networked:!0}],onBeforeDestroy:[]}},76207:function(e,t,n){"use strict";n.d(t,{Cs:function(){return E},ps:function(){return A},rR:function(){return O},$L:function(){return L}});var r=n(64414),i=n(48533),o=n.n(i),a=n(58700),s=n(94780),u=n(77866),c=n(42828),l=n(13987),d=n(29569),f=n(89306),h=n(49182),p=n(39337),m=n(36595);n(49903);function v(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.Z)(e);if(t){var i=(0,f.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,d.Z)(this,n)}}var E,w=m.M8C.generateUUID;!function(e){e[e.OFFSCREEN_CANVAS=0]="OFFSCREEN_CANVAS",e[e.CANVAS_CREATED=1]="CANVAS_CREATED",e[e.ADD_EVENT=2]="ADD_EVENT",e[e.REMOVE_EVENT=3]="REMOVE_EVENT",e[e.EVENT=4]="EVENT",e[e.TRANSFER=5]="TRANSFER",e[e.DOCUMENT_ELEMENT_CREATE=6]="DOCUMENT_ELEMENT_CREATE",e[e.DOCUMENT_ELEMENT_FUNCTION_CALL=7]="DOCUMENT_ELEMENT_FUNCTION_CALL",e[e.DOCUMENT_ELEMENT_PARAM_SET=8]="DOCUMENT_ELEMENT_PARAM_SET",e[e.DOCUMENT_ELEMENT_ADD_EVENT=9]="DOCUMENT_ELEMENT_ADD_EVENT",e[e.DOCUMENT_ELEMENT_REMOVE_EVENT=10]="DOCUMENT_ELEMENT_REMOVE_EVENT",e[e.DOCUMENT_ELEMENT_EVENT=11]="DOCUMENT_ELEMENT_EVENT",e[e.DOCUMENT_ELEMENT_PROP_UPDATE=12]="DOCUMENT_ELEMENT_PROP_UPDATE",e[e.VIDEO_ELEMENT_CREATE=13]="VIDEO_ELEMENT_CREATE",e[e.VIDEO_ELEMENT_FRAME=14]="VIDEO_ELEMENT_FRAME",e[e.OBJECT3D_CREATE=15]="OBJECT3D_CREATE",e[e.OBJECT3D_DESTROY=16]="OBJECT3D_DESTROY",e[e.OBJECT3D_MATRIX=17]="OBJECT3D_MATRIX",e[e.OBJECT3D_PARAM_SET=18]="OBJECT3D_PARAM_SET",e[e.OBJECT3D_FUNCTION_CALL=19]="OBJECT3D_FUNCTION_CALL",e[e.AUDIO_BUFFER_LOAD=20]="AUDIO_BUFFER_LOAD",e[e.AUDIO_BUFFER_SET=21]="AUDIO_BUFFER_SET",e[e.AUDIO_SOURCE_STREAM_SET=22]="AUDIO_SOURCE_STREAM_SET",e[e.AUDIO_SOURCE_ELEMENT_SET=23]="AUDIO_SOURCE_ELEMENT_SET"}(E||(E={}));function _(e){var t={};for(var n in e)"function"!==typeof e[n]&&(t[n]=e[n]);return t}var T=function(){function e(t){var n=this,r=t.eventTarget,i=t.eventListener;(0,h.Z)(this,e),this._listeners={},this.eventTarget=r,this.eventListener=i,this.messageTypeFunctions=new Map,this.messageTypeFunctions.set(E.EVENT,(function(e){e.preventDefault=function(){},e.stopPropagation=function(){},delete e.target,n.dispatchEvent(e,!0)})),this.messageTypeFunctions.set(E.ADD_EVENT,(function(e){var t=e.type;n.eventTarget.addEventListener(t,i)})),this.messageTypeFunctions.set(E.REMOVE_EVENT,(function(e){var t=e.type;n.eventTarget.removeEventListener(t,i)}))}return(0,p.Z)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners[e]&&(this._listeners[e]=[]),-1===this._listeners[e].indexOf(t)&&this._listeners[e].push(t)}},{key:"hasEventListener",value:function(e,t){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},{key:"dispatchEvent",value:function(e,t){var n=this._listeners[e.type];if(void 0!==n){e.target=this;for(var r=n.slice(0),i=0,o=r.length;i<o;i++)r[i].call(this,e)}}}]),e}(),k=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.messagePort,o=e.eventTarget,a=e.eventListener;return(0,h.Z)(this,n),(r=t.call(this,{eventTarget:o,eventListener:a})).object3dProxies=[],r.messagePort=i,r.eventTarget=o,r.queue=[],r.remoteDocumentObjects=new Map,r.messagePort.onmessage=function(e){r.receiveQueue(e.data)},r.interval=setInterval((function(){r.sendQueue()}),1e3/60),r}return(0,p.Z)(n,[{key:"sendEvent",value:function(e,t,n){this.queue.push({messageType:E.EVENT,message:{type:e,detail:t},transferables:n})}},{key:"transfer",value:function(e){this.queue.push({messageType:E.TRANSFER,message:{},transferables:e})}},{key:"sendQueue",value:function(){var e;if(this.dispatchEvent({type:"MESSAGE_QUEUE_EVENT_BEFORE_SEND_QUEUE"},!0),null===(e=this.queue)||void 0===e?void 0:e.length){var t=[];this.queue.forEach((function(e){t.push({messageType:e.messageType,message:e.message})}));var n=[];this.queue.forEach((function(e){e.transferables&&n.push.apply(n,(0,u.Z)(e.transferables))}));try{this.messagePort.postMessage(t,n)}catch(r){console.log(r,t,this)}this.queue=[]}}},{key:"receiveQueue",value:function(e){var t=this;e.forEach((function(e){var n,r=e.messageType,i=e.message;i.returnID&&""!==i.returnID?t.remoteDocumentObjects.get(i.returnID)&&(null===(n=t.remoteDocumentObjects.get(i.returnID))||void 0===n||n.messageTypeFunctions.get(r)(i)):t.messageTypeFunctions.has(r)&&t.messageTypeFunctions.get(r)(i)}))}},{key:"addEventListener",value:function(e,t){this.queue.push({messageType:E.ADD_EVENT,message:{type:e}}),(0,c.Z)((0,f.Z)(n.prototype),"addEventListener",this).call(this,e,t)}},{key:"removeEventListener",value:function(e,t){this.queue.push({messageType:E.REMOVE_EVENT,message:{type:e}}),(0,c.Z)((0,f.Z)(n.prototype),"removeEventListener",this).call(this,e,t)}},{key:"dispatchEvent",value:function(e,t){t||this.queue.push({messageType:E.EVENT,message:_(e)}),(0,c.Z)((0,f.Z)(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(T),b=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.messageQueue,o=e.type,a=e.eventTarget,u=e.elementArgs,c=e.ignoreCreate,l=void 0!==c&&c,d=e.uuid;return(0,h.Z)(this,n),(r=t.call(this,{eventTarget:a||i.eventTarget,eventListener:function(e){r.messageQueue.queue.push({messageType:E.EVENT,message:_(e)})}})).type=o,r.messageQueue=i,r.eventTarget=a||i.eventTarget,r.uuid=d||w(),r.messageQueue.remoteDocumentObjects.set(r.uuid,(0,s.Z)(r)),l||r.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_CREATE,message:{type:o,uuid:r.uuid,elementArgs:u}}),r}return(0,p.Z)(n,[{key:"__callFunc",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_FUNCTION_CALL,message:{call:e,uuid:this.uuid,args:n}}),!0}},{key:"__callFuncAsync",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n,r,i,a=this,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=s[i];return e.prev=1,e.next=4,new Promise((function(e){var n=w();a.messageQueue.addEventListener(n,(function t(r){a.messageQueue.removeEventListener(n,t),e(r.detail.returnedData)})),a.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_FUNCTION_CALL,message:{call:t,uuid:a.uuid,requestID:n,args:r}})}));case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(1),console.warn(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"__setValue",value:function(e,t){this.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_PARAM_SET,message:{param:e,uuid:this.uuid,arg:t}})}},{key:"addEventListener",value:function(e,t){this.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_ADD_EVENT,message:{type:e,uuid:this.uuid}}),(0,c.Z)((0,f.Z)(n.prototype),"addEventListener",this).call(this,e,t)}},{key:"removeEventListener",value:function(e,t){this.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_REMOVE_EVENT,message:{type:e,uuid:this.uuid}}),(0,c.Z)((0,f.Z)(n.prototype),"removeEventListener",this).call(this,e,t)}},{key:"dispatchEvent",value:function(e,t){t||(e.uuid=this.uuid,this.messageQueue.queue.push({messageType:E.DOCUMENT_ELEMENT_EVENT,message:_(e)})),(0,c.Z)((0,f.Z)(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(T),S=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.messageQueue,o=e.type,a=void 0===o?"audio":o,s=e.elementArgs;return(0,h.Z)(this,n),(r=t.call(this,{messageQueue:i,type:a,elementArgs:s}))._isPlaying=!1,r}return(0,p.Z)(n,[{key:"play",value:function(){this.__callFunc("play")}},{key:"pause",value:function(){this.__callFunc("pause")}},{key:"dispatchEvent",value:function(e,t){switch(e.type){case"play":this._isPlaying=!0;break;case"pause":case"paused":case"ended":this._isPlaying=!1}(0,c.Z)((0,f.Z)(n.prototype),"dispatchEvent",this).call(this,e,t)}},{key:"src",get:function(){return this._src},set:function(e){this._src=e,this.__setValue("src",e)}},{key:"autoplay",get:function(){return this._autoplay},set:function(e){this._autoplay=e,this.__setValue("autoplay",e)}},{key:"isPlaying",get:function(){return this._isPlaying}}]),n}(b),D=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.messageQueue,o=e.elementArgs;return(0,h.Z)(this,n),(r=t.call(this,{messageQueue:i,type:"video",elementArgs:o})).video=new OffscreenCanvas(0,0),r.width=0,r.height=0,r.readyState=0,r.currentTime=0,r.messageTypeFunctions.set(E.VIDEO_ELEMENT_CREATE,(function(e){var t=e.width,n=e.height;r.width=t,r.height=n,r.video.width=t,r.video.height=n})),r.messageTypeFunctions.set(E.VIDEO_ELEMENT_FRAME,(function(e){var t=e.imageBitmap,n=e.readyState,i=e.currentTime,o=e.metaData,a=e.now;r.video.getContext("2d").drawImage(t,0,0),r.currentTime=i,r.readyState=n,r.frameCallback&&r.frameCallback(a,o),r._frameCallback&&r._frameCallback(a,o)})),r}return(0,p.Z)(n,[{key:"requestVideoFrameCallback",value:function(e){this.frameCallback=e}},{key:"_requestVideoFrameCallback",value:function(e){this._frameCallback=e}}]),n}(S),A=function(e){(0,l.Z)(n,e);var t=g(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,h.Z)(this,n),(e=t.call(this)).setQueue=new Map,e.type=r.type||"Object3D",e.proxyID=w(),e.messageQueue=globalThis.__messageQueue,e.messageQueue.object3dProxies.push((0,s.Z)(e)),e.messageQueue.queue.push({messageType:E.OBJECT3D_CREATE,message:{proxyID:e.proxyID,type:e.type}}),e.addEventListener("removed",(function(){e.messageQueue.object3dProxies.splice(e.messageQueue.object3dProxies.indexOf((0,s.Z)(e)),1),e.messageQueue.queue.push({messageType:E.OBJECT3D_DESTROY,message:{proxyID:e.proxyID}})})),e}return(0,p.Z)(n,[{key:"__callFunc",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.messageQueue.queue.push({messageType:E.OBJECT3D_FUNCTION_CALL,message:{call:e,proxyID:this.proxyID,args:n}})}}]),n}(m.Tme),C=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.messagePort,o=e.eventTarget,a=void 0===o?new EventTarget:o;return(0,h.Z)(this,n),(r=t.call(this,{messagePort:i,eventTarget:a,eventListener:function(e){r.queue.push({messageType:E.EVENT,message:_(e)})}})).canvas=null,r.width=0,r.height=0,r.devicePixelRatio=0,r.focus=r.focus.bind((0,s.Z)(r)),r}return(0,p.Z)(n,[{key:"focus",value:function(){}},{key:"sendQueue",value:function(){var e,t=v(this.object3dProxies);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.queue.push({messageType:E.OBJECT3D_MATRIX,message:{matrixWorld:r.matrixWorld,proxyID:r.proxyID}})}}catch(i){t.e(i)}finally{t.f()}(0,c.Z)((0,f.Z)(n.prototype),"sendQueue",this).call(this)}},{key:"ownerDocument",get:function(){return this}},{key:"clientWidth",get:function(){return this.width}},{key:"clientHeight",get:function(){return this.height}},{key:"innerWidth",get:function(){return this.width}},{key:"innerHeight",get:function(){return this.height}}]),n}(k);var O=function(e,t){return Object.entries(t).forEach((function(t){var n=(0,r.Z)(t,2),i=n[0],o=n[1];e[i]=o})),e},P=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r=e.messageQueue,i=e.type,o=void 0===i?"window":i;return(0,h.Z)(this,n),t.call(this,{messageQueue:r,type:o})}return(0,p.Z)(n,[{key:"open",value:function(e){this.__callFunc("open",e)}},{key:"focus",value:function(){}},{key:"ownerDocument",get:function(){return globalThis.document}},{key:"width",get:function(){return this.messageQueue.width}},{key:"height",get:function(){return this.messageQueue.height}},{key:"clientWidth",get:function(){return this.messageQueue.width}},{key:"clientHeight",get:function(){return this.messageQueue.height}},{key:"innerWidth",get:function(){return this.messageQueue.width}},{key:"innerHeight",get:function(){return this.messageQueue.height}},{key:"devicePixelRatio",get:function(){return this.messageQueue.devicePixelRatio}}]),n}(b),R=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r=e.messageQueue,i=e.type,o=void 0===i?"document":i;return(0,h.Z)(this,n),t.call(this,{messageQueue:r,type:o})}return(0,p.Z)(n,[{key:"createElement",value:function(e,t){switch(e){case"audio":return new S({messageQueue:this.messageQueue,elementArgs:t});case"video":return new D({messageQueue:this.messageQueue,elementArgs:t});case"media":return new b({messageQueue:this.messageQueue,type:"mediaElementSource",elementArgs:t});case"canvas":return new OffscreenCanvas(0,0);default:return null}}},{key:"createElementNS",value:function(e,t){switch(t){case"canvas":return new OffscreenCanvas(0,0);default:return null}}},{key:"ownerDocument",get:function(){return globalThis.document}}]),n}(b),x=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r=e.messageQueue,i=e.type,o=void 0===i?"canvas":i;return(0,h.Z)(this,n),t.call(this,{messageQueue:r,type:o})}return n}(b),N=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r=e.messageQueue;return(0,h.Z)(this,n),t.call(this,{messageQueue:r,type:"navigator.xr"})}return(0,p.Z)(n,[{key:"isSessionSupported",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__callFuncAsync("isSessionSupported",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestSession",value:function(){var e=(0,a.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.__callFuncAsync("requestSession",t);case 2:return n=e.sent,e.abrupt("return",new Z({uuid:n,messageQueue:this.messageQueue}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b),Z=function(e){(0,l.Z)(n,e);var t=g(n);function n(e){var r,i=e.uuid,o=e.messageQueue;return(0,h.Z)(this,n),(r=t.call(this,{uuid:i,messageQueue:o,type:"xr_session",ignoreCreate:!0})).inputSources=[],r.messageQueue=o,r}return(0,p.Z)(n,[{key:"requestReferenceSpace",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__callFuncAsync("requestReferenceSpace",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateRenderState",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.__callFunc("updateRenderState",t),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.__callFunc("end"),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestHitTestSource",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__callFuncAsync("requestHitTestSource",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestHitTestSourceForTransientInput",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__callFuncAsync("requestHitTestSourceForTransientInput",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestHitTest",value:function(){var e=(0,a.Z)(o().mark((function e(t,n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__callFuncAsync("requestHitTest",t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateWorldTrackingState",value:function(e){this.__callFunc("updateWorldTrackingState",e)}},{key:"createOffscreenSession",value:function(){var e=(0,a.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__callFuncAsync("createOffscreenSession",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b);function L(e){return I.apply(this,arguments)}function I(){return(I=(0,a.Z)(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new C({messagePort:globalThis}),r=new x({messageQueue:n}),n.messageTypeFunctions.set(E.OFFSCREEN_CANVAS,(function(e){var i=e.canvas,o=e.height,a=e.width,s=e.devicePixelRatio,u=e.isMobile;n.canvas=i,n.width=a,n.height=o,n.devicePixelRatio=s,n.isMobile=u,i.addEventListener=function(e,t){r.addEventListener(e,t)},i.removeEventListener=function(e,t){r.removeEventListener(e,t)},i.dispatchEvent=function(e){return delete e.target,r.dispatchEvent(e),!0},i.ownerDocument=globalThis.document,globalThis.window=new P({messageQueue:n}),globalThis.document=new R({messageQueue:n}),globalThis.navigator.xr=new N({messageQueue:n}),t(e,n),n.queue.push({messageType:E.CANVAS_CREATED,message:{}})})),n.addEventListener("resize",(function(e){e&&(n.width=e.detail.width,n.height=e.detail.height)})),globalThis.__messageQueue=n,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},32006:function(e,t,n){"use strict";var r=n(48533),i=n.n(r),o=n(58700),a=n(35231),s=n.n(a),u=n(36595),c=n(33236),l=n(60235),d=n(21769),f=n(99814),h=n(3780),p=n(483),m=n(15194),v=n(46365),y=(n(88203),n(16090),n(51462)),g=n(17356);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){p.D4.options=w(w({},p.D4.options),e),p.D4.lastTime=(0,v.z)()/1e3}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.V.Free;p.D4.tick++,e||(t=(0,v.z)()/1e3,e=t-p.D4.lastTime,p.D4.lastTime=t),p.D4.enabled&&(p.D4.systemsToExecute.forEach((function(r){return(0,y.Cr)(r,e,t,n)})),k())}function k(){if(p.D4.deferredRemovalEnabled){for(var e=p.D4.entitiesToRemove,t=p.D4.entitiesWithComponentsToRemove,n=0;n<e.length;n++){var r=e[n],i=p.D4.entities.indexOf(r);p.D4.entities.splice(i,1),p.D4.entityMap.delete(String(r.id)),r._pool.release(r)}e.length=0;for(var o=0;o<t.length;o++)for(var a=t[o];a.componentTypesToRemove.length>0;){var s=a.componentTypesToRemove.pop(),u=a.componentsToRemove[s._typeId];delete a.componentsToRemove[s._typeId],u.dispose(),p.D4.numComponents[u._typeId]--}p.D4.entitiesWithComponentsToRemove.length=0}}var b=n(50760),S=n(61467),D=n(41912),A=n(16254),C=n(94223),O=n(83697),P=n(74861),R=n(74745),x=n(50097),N=n(81537),Z=n(5969),L=n(98847),I=n(46428),M=n(44590),V=n(34452),F=n(52194),j=n(76207);u.Kj0.prototype.raycast=c.uL,u.u9r.prototype.computeBoundsTree=c.Xy;var U={input:{schema:N.M},networking:{schema:L.ZS},state:{schema:Z.s}},q=function(){var e=(0,o.Z)(i().mark((function e(t,n){var r,o,a,c,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.canvas,o=t.userArgs,a=o.initOptions,c=s().defaultsDeep({},a,U),V.NL.instance=new V.cD(n),(0,V.On)(),_(),p.D4.scene=new u.xsS,S.Z.instance.schema=c.networking.schema,S.Z.instance.transport={isServer:!1},(0,y.$6)(l.Z),(0,y.$6)(C.F),(0,y.$6)(M.V,{useWebXR:!1}),(0,y.$6)(x.z),(0,y.$6)(R.w,{priority:899}),(0,y.$6)(I.W,{priority:900}),p.D4.camera=new u.cPb(60,window.innerWidth/window.innerHeight,.3,750),p.D4.scene.add(p.D4.camera),(0,y.$6)(O.x),p.D4.audioListener=new p.SJ,p.D4.camera.add(p.D4.audioListener),(0,y.$6)(b.Pf),(0,y.$6)(A.p),(0,y.$6)(h.n),(0,y.$6)(d.D),(0,y.$6)(P.eq,{priority:1001,canvas:r}),(0,y.$6)(F.T,{offscreen:!0}),p.D4.viewportElement=p.D4.renderer.domElement,p.D4.engineTimer=(0,f.B7)({networkUpdate:function(e,t){return T(e,t,g.V.Network)},fixedUpdate:function(e,t){return T(e,t,g.V.Fixed)},update:function(e,t){return T(e,t,g.V.Free)}},p.D4.physicsFrameRate,p.D4.networkFramerate).start(),m=function e(t){S.Z.instance.isInitialized=!0,V.NL.instance.removeEventListener(D.T.EVENTS.CONNECT,e)},V.NL.instance.addEventListener(D.T.EVENTS.CONNECT,m),v=function e(t){S.Z.instance.userId=t.userId,V.NL.instance.removeEventListener(D.T.EVENTS.INITIALIZE,e)},V.NL.instance.addEventListener(D.T.EVENTS.INITIALIZE,v),setInterval((function(){V.NL.instance.dispatchEvent({type:V.NL.EVENTS.ENTITY_DEBUG_DATA})}),1e3);case 33:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();(0,j.$L)(q)}}]);